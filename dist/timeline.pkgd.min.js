/*
Copyright (c) 2019 Daybrush
name: @scenejs/timeline
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/scenejs-timeline.git
version: 0.1.7
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Timeline=t()}(this,function(){"use strict";var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},u=function(){},c={},l=[],p=[];function s(e,t){var n,r,i,o,a=p;for(o=arguments.length;2<o--;)l.push(arguments[o]);for(t&&null!=t.children&&(l.length||l.push(t.children),delete t.children);l.length;)if((r=l.pop())&&void 0!==r.pop)for(o=r.length;o--;)l.push(r[o]);else"boolean"==typeof r&&(r=null),(i="function"!=typeof e)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(i=!1)),i&&n?a[a.length-1]+=r:a===p?a=[r]:a.push(r),n=i;var s=new u;return s.nodeName=e,s.children=a,s.attributes=null==t?void 0:t,s.key=null==t?void 0:t.key,void 0!==c.vnode&&c.vnode(s),s}function E(e,t){for(var n in t)e[n]=t[n];return e}function h(e,t){null!=e&&("function"==typeof e?e(t):e.current=t)}var t="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,f=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,n=[];function o(e){!e._dirty&&(e._dirty=!0)&&1==n.push(e)&&t(i)}function i(){for(var e;e=n.pop();)e._dirty&&L(e)}function P(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function C(e){var t=E({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function A(e){var t=e.parentNode;t&&t.removeChild(e)}function d(e,t,n,r,i){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)h(n,null),h(r,e);else if("class"!==t||i)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var o in n)o in r||(e.style[o]="");for(var o in r)e.style[o]="number"==typeof r[o]&&!1===f.test(o)?r[o]+"px":r[o]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,m,a):e.removeEventListener(t,m,a),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!i&&t in e){try{e[t]=null==r?"":r}catch(e){}null!=r&&!1!==r||"spellcheck"==t||e.removeAttribute(t)}else{var s=i&&t!==(t=t.replace(/^xlink:?/,""));null==r||!1===r?s?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(s?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function m(e){return this._listeners[e.type](c.event&&c.event(e)||e)}var N=[],S=0,v=!1,g=!1;function O(){for(var e;e=N.shift();)e.componentDidMount&&e.componentDidMount()}function I(e,t,n,r,i,o){S++||(v=null!=i&&void 0!==i.ownerSVGElement,g=null!=e&&!("__preactattr_"in e));var a=D(e,t,n,r,o);return i&&a.parentNode!==i&&i.appendChild(a),--S||(g=!1,o||O()),a}function D(e,t,n,r,i){var o=e,a=v;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||i)?e.nodeValue!=t&&(e.nodeValue=t):(o=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(o,e),z(e,!0))),o.__preactattr_=!0,o;var s=t.nodeName;if("function"==typeof s)return function(e,t,n,r){var i=e&&e._component,o=i,a=e,s=i&&e._componentConstructor===t.nodeName,u=s,c=C(t);for(;i&&!u&&(i=i._parentComponent);)u=i.constructor===t.nodeName;i&&u&&(!r||i._component)?(j(i,c,3,n,r),e=i.base):(o&&!s&&(R(o),e=a=null),i=M(t.nodeName,c,n),e&&!i.nextBase&&(i.nextBase=e,a=null),j(i,c,1,n,r),e=i.base,a&&e!==a&&(a._component=null,z(a,!1)));return e}(e,t,n,r);if(v="svg"===s||"foreignObject"!==s&&v,s=String(s),(!e||!P(e,s))&&(o=function(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}(s,v),e)){for(;e.firstChild;)o.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(o,e),z(e,!0)}var u=o.firstChild,c=o.__preactattr_,l=t.children;if(null==c){c=o.__preactattr_={};for(var p=o.attributes,h=p.length;h--;)c[p[h].name]=p[h].value}return!g&&l&&1===l.length&&"string"==typeof l[0]&&null!=u&&void 0!==u.splitText&&null==u.nextSibling?u.nodeValue!=l[0]&&(u.nodeValue=l[0]):(l&&l.length||null!=u)&&function(e,t,n,r,i){var o,a,s,u,c,l=e.childNodes,p=[],h={},f=0,d=0,m=l.length,v=0,g=t?t.length:0;if(0!==m)for(var y=0;y<m;y++){var b=l[y],x=b.__preactattr_;null!=(k=g&&x?b._component?b._component.__key:x.key:null)?(f++,h[k]=b):(x||(void 0!==b.splitText?!i||b.nodeValue.trim():i))&&(p[v++]=b)}if(0!==g)for(y=0;y<g;y++){var k;if(u=t[y],(c=null)!=(k=u.key))f&&void 0!==h[k]&&(c=h[k],h[k]=void 0,f--);else if(d<v)for(o=d;o<v;o++)if(void 0!==p[o]&&(w=a=p[o],T=i,"string"==typeof(_=u)||"number"==typeof _?void 0!==w.splitText:"string"==typeof _.nodeName?!w._componentConstructor&&P(w,_.nodeName):T||w._componentConstructor===_.nodeName)){c=a,p[o]=void 0,o===v-1&&v--,o===d&&d++;break}c=D(c,u,n,r),s=l[y],c&&c!==e&&c!==s&&(null==s?e.appendChild(c):c===s.nextSibling?A(s):e.insertBefore(c,s))}var w,_,T;if(f)for(var y in h)void 0!==h[y]&&z(h[y],!1);for(;d<=v;)void 0!==(c=p[v--])&&z(c,!1)}(o,l,n,r,g||null!=c.dangerouslySetInnerHTML),function(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||d(e,r,n[r],n[r]=void 0,v);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||d(e,r,n[r],n[r]=t[r],v)}(o,t.attributes,c),v=a,o}function z(e,t){var n=e._component;n?R(n):(null!=e.__preactattr_&&h(e.__preactattr_.ref,null),!1!==t&&null!=e.__preactattr_||A(e),y(e))}function y(e){for(e=e.lastChild;e;){var t=e.previousSibling;z(e,!0),e=t}}var b=[];function M(e,t,n){var r,i=b.length;for(e.prototype&&e.prototype.render?(r=new e(t,n),k.call(r,t,n)):((r=new k(t,n)).constructor=e,r.render=x);i--;)if(b[i].constructor===e)return r.nextBase=b[i].nextBase,b.splice(i,1),r;return r}function x(e,t,n){return this.constructor(e,n)}function j(e,t,n,r,i){e._disable||(e._disable=!0,e.__ref=t.ref,e.__key=t.key,delete t.ref,delete t.key,void 0===e.constructor.getDerivedStateFromProps&&(!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r)),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===c.syncComponentUpdates&&e.base?o(e):L(e,1,i)),h(e.__ref,e))}function L(e,t,n,r){if(!e._disable){var i,o,a,s=e.props,u=e.state,c=e.context,l=e.prevProps||s,p=e.prevState||u,h=e.prevContext||c,f=e.base,d=e.nextBase,m=f||d,v=e._component,g=!1,y=h;if(e.constructor.getDerivedStateFromProps&&(u=E(E({},u),e.constructor.getDerivedStateFromProps(s,u)),e.state=u),f&&(e.props=l,e.state=p,e.context=h,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(s,u,c)?g=!0:e.componentWillUpdate&&e.componentWillUpdate(s,u,c),e.props=s,e.state=u,e.context=c),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!g){i=e.render(s,u,c),e.getChildContext&&(c=E(E({},c),e.getChildContext())),f&&e.getSnapshotBeforeUpdate&&(y=e.getSnapshotBeforeUpdate(l,p));var b,x,k=i&&i.nodeName;if("function"==typeof k){var w=C(i);(o=v)&&o.constructor===k&&w.key==o.__key?j(o,w,1,c,!1):(b=o,e._component=o=M(k,w,c),o.nextBase=o.nextBase||d,o._parentComponent=e,j(o,w,0,c,!1),L(o,1,n,!0)),x=o.base}else a=m,(b=v)&&(a=e._component=null),!m&&1!==t||(a&&(a._component=null),x=I(a,i,c,n||!f,m&&m.parentNode,!0));if(m&&x!==m&&o!==v){var _=m.parentNode;_&&x!==_&&(_.replaceChild(x,m),b||(m._component=null,z(m,!1)))}if(b&&R(b),(e.base=x)&&!r){for(var T=e,P=e;P=P._parentComponent;)(T=P).base=x;x._component=T,x._componentConstructor=T.constructor}}for(!f||n?N.push(e):g||e.componentDidUpdate&&e.componentDidUpdate(l,p,y);e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);S||r||O()}}function R(e){var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?R(n):t&&(null!=t.__preactattr_&&h(t.__preactattr_.ref,null),A(e.nextBase=t),b.push(e),y(t)),h(e.__ref,null)}function k(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{},this._renderCallbacks=[]}E(k.prototype,{setState:function(e,t){this.prevState||(this.prevState=this.state),this.state=E(E({},this.state),"function"==typeof e?e(this.state,this.props):e),t&&this._renderCallbacks.push(t),o(this)},forceUpdate:function(e){e&&this._renderCallbacks.push(e),L(this,2)},render:function(){}});var w="object",_="undefined";function T(e){return typeof e===_}function K(e){return e&&typeof e===w}function W(e,t,n){void 0===n&&(n=-1);for(var r=e.length,i=0;i<r;++i)if(t(e[i],i,e))return i;return n}function U(e,t,n,r){e.addEventListener(t,n,r)}function F(e){return void 0===e}var e=function(){var e=function(){function e(){this._eventHandler={},this.options={}}var t=e.prototype;return t.trigger=function(e,t){void 0===t&&(t={});var n=this._eventHandler[e]||[];if(!(0<n.length))return!0;n=n.concat(),t.eventType=e;var r=!1,i=[t],o=0;t.stop=function(){r=!0},t.currentTarget=this;for(var a=arguments.length,s=new Array(2<a?a-2:0),u=2;u<a;u++)s[u-2]=arguments[u];for(1<=s.length&&(i=i.concat(s)),o=0;n[o];o++)n[o].apply(this,i);return!r},t.once=function(i,o){if("object"==typeof i&&F(o)){var e,t=i;for(e in t)this.once(e,t[e]);return this}if("string"==typeof i&&"function"==typeof o){var a=this;this.on(i,function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];o.apply(a,n),a.off(i,e)})}return this},t.hasOn=function(e){return!!this._eventHandler[e]},t.on=function(e,t){if("object"==typeof e&&F(t)){var n,r=e;for(n in r)this.on(n,r[n]);return this}if("string"==typeof e&&"function"==typeof t){var i=this._eventHandler[e];F(i)&&(this._eventHandler[e]=[],i=this._eventHandler[e]),i.push(t)}return this},t.off=function(e,t){if(F(e))return this._eventHandler={},this;if(F(t)){if("string"==typeof e)return this._eventHandler[e]=void 0,this;var n,r=e;for(n in r)this.off(n,r[n]);return this}var i,o,a=this._eventHandler[e];if(a)for(i=0;void 0!==(o=a[i]);i++)if(o===t){a=a.splice(i,1);break}return this},e}();return e.VERSION="2.1.2",e}(),X=function(e,t){return(X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var Y,q=(function(e,t){function n(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return a[e];var n,r=String(e);return(n=i[r.toLowerCase()])?n:(n=o[r.toLowerCase()])||(1===r.length?r.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"==typeof e){var n=e.which||e.keyCode||e.charCode;if(null==n)return!1;if("string"==typeof t){var r;if(r=i[t.toLowerCase()])return r===n;if(r=o[t.toLowerCase()])return r===n}else if("number"==typeof t)return t===n;return!1}};var i=(t=e.exports=n).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},o=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(r=97;r<123;r++)i[String.fromCharCode(r)]=r-32;for(var r=48;r<58;r++)i[r-48]=r;for(r=1;r<13;r++)i["f"+r]=r+111;for(r=0;r<10;r++)i["numpad "+r]=r+96;var a=t.names=t.title={};for(r in i)a[i[r]]=r;for(var s in o)i[s]=o[s]}(Y={exports:{}},Y.exports),Y.exports),H=(q.code,q.codes,q.aliases,q.names);q.title;function B(e,t,n,r){e.addEventListener(t,n,r)}var V={"+":"plus","left command":"meta","right command":"meta"},$={shift:1,ctrl:2,alt:3,meta:4};var Z=function(n){function e(e){void 0===e&&(e=window);var t=n.call(this)||this;return t.ctrlKey=!1,t.altKey=!1,t.shiftKey=!1,t.metaKey=!1,t.clear=function(){t.ctrlKey=!1,t.altKey=!1,t.shiftKey=!1,t.metaKey=!1},t.keydownEvent=function(e){t.triggerEvent("keydown",e)},t.keyupEvent=function(e){t.triggerEvent("keyup",e)},B(e,"blur",t.clear),B(e,"keydown",t.keydownEvent),B(e,"keyup",t.keyupEvent),t}!function(e,t){function n(){this.constructor=e}X(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(e,n);var t=e.prototype;return t.keydown=function(e,t){return this.addEvent("keydown",e,t)},t.keyup=function(e,t){return this.addEvent("keyup",e,t)},t.addEvent=function(e,t,n){return!function(e){return Array.isArray(e)}(t)?!function(e){return"string"==typeof e}(t)?this.on(e,t):this.on(e+"."+t,n):this.on(e+"."+function(e){var t=e.slice();return t.sort(function(e,t){return($[e]||5)-($[t]||5)}),t}(t).join("."),n),this},t.triggerEvent=function(e,t){this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey;var n=function(e){var t=H[e]||"";for(var n in V)t=t.replace(n,V[n]);return t.replace(/\s/g,"")}(t.keyCode),r={key:n,isToggle:"ctrl"===n||"shift"===n||"meta"===n||"alt"===n,inputEvent:t,keyCode:t.keyCode,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey};this.trigger(e,r),this.trigger(e+"."+n,r);var i=function(e,t){var n=[e.shiftKey&&"shift",e.ctrlKey&&"ctrl",e.altKey&&"alt",e.metaKey&&"meta"];return-1===n.indexOf(t)&&n.push(t),n.filter(Boolean)}(t,n);1<i.length&&this.trigger(e+"."+i.join("."),r)},e}(e);function G(e,t){var a=!1,s=0,u=0,c=0,l=0,p={},h=!1,n=t.container,r=void 0===n?e:n,i=t.dragstart,f=t.drag,o=t.dragend,d=t.events,m=void 0===d?["touch","mouse"]:d,v=-1<m.indexOf("touch");function g(e){return e.touches&&e.touches.length?e.touches[0]:e}function y(e){h=!(a=!0);var t=g(e),n=t.clientX,r=t.clientY;c=s=n,l=u=r,!(p={})===(i&&i({datas:p,inputEvent:e,clientX:n,clientY:r}))&&(a=!1),a&&e.preventDefault()}function b(e){if(a){var t=g(e),n=t.clientX,r=t.clientY,i=n-c,o=r-l;(i||o)&&(h=!0,f&&f({datas:p,clientX:n,clientY:r,deltaX:i,deltaY:o,distX:n-s,distY:r-u,inputEvent:e}),c=n,l=r)}}function x(e){a&&(a=!1,o&&o({datas:p,isDrag:h,inputEvent:e,clientX:c,clientY:l,distX:c-s,distY:l-u}))}-1<m.indexOf("mouse")&&(e.addEventListener("mousedown",y),r.addEventListener("mousemove",b),r.addEventListener("mouseup",x)),v&&(e.addEventListener("touchstart",y),r.addEventListener("touchmove",b),r.addEventListener("touchend",x))}function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function J(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var te,ne="function"!=typeof Object.assign?function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i])}return t}:Object.assign,re=["","webkit","Moz","MS","ms","o"],ie="undefined"==typeof document?{style:{}}:document.createElement("div"),oe="function",ae=Math.round,se=Math.abs,ue=Date.now;function ce(e,t){for(var n,r,i=t[0].toUpperCase()+t.slice(1),o=0;o<re.length;){if((r=(n=re[o])?n+i:t)in e)return r;o++}}te="undefined"==typeof window?{}:window;var le=ce(ie.style,"touchAction"),pe=void 0!==le;var he="compute",fe="manipulation",de="none",me="pan-x",ve="pan-y",ge=function(){if(!pe)return!1;var t={},n=te.CSS&&te.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(e){return t[e]=!n||te.CSS.supports("touch-action",e)}),t}(),ye="ontouchstart"in te,be=void 0!==ce(te,"PointerEvent"),xe=ye&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),ke="touch",we="mouse",_e=25,Te=1,Pe=4,Ee=8,Ce=1,Ae=2,Ne=4,Se=8,Oe=16,Ie=Ae|Ne,De=Se|Oe,ze=Ie|De,Me=["x","y"],je=["clientX","clientY"];function Le(e,t,n){var r;if(e)if(e.forEach)e.forEach(t,n);else if(void 0!==e.length)for(r=0;r<e.length;)t.call(n,e[r],r,e),r++;else for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e)}function Re(e,t){return typeof e===oe?e.apply(t&&t[0]||void 0,t):e}function Ke(e,t){return-1<e.indexOf(t)}var We=function(){function e(e,t){this.manager=e,this.set(t)}var t=e.prototype;return t.set=function(e){e===he&&(e=this.compute()),pe&&this.manager.element.style&&ge[e]&&(this.manager.element.style[le]=e),this.actions=e.toLowerCase().trim()},t.update=function(){this.set(this.manager.options.touchAction)},t.compute=function(){var t=[];return Le(this.manager.recognizers,function(e){Re(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(e){if(Ke(e,de))return de;var t=Ke(e,me),n=Ke(e,ve);return t&&n?de:t||n?t?me:ve:Ke(e,fe)?fe:"auto"}(t.join(" "))},t.preventDefaults=function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var r=this.actions,i=Ke(r,de)&&!ge[de],o=Ke(r,ve)&&!ge[ve],a=Ke(r,me)&&!ge[me];if(i){var s=1===e.pointers.length,u=e.distance<2,c=e.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&n&Ie||a&&n&De?this.preventSrc(t):void 0}},t.preventSrc=function(e){this.manager.session.prevented=!0,e.preventDefault()},e}();function Ue(e,t){for(;e;){if(e===t)return!0;e=e.parentNode}return!1}function Fe(e){var t=e.length;if(1===t)return{x:ae(e[0].clientX),y:ae(e[0].clientY)};for(var n=0,r=0,i=0;i<t;)n+=e[i].clientX,r+=e[i].clientY,i++;return{x:ae(n/t),y:ae(r/t)}}function Xe(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:ae(e.pointers[n].clientX),clientY:ae(e.pointers[n].clientY)},n++;return{timeStamp:ue(),pointers:t,center:Fe(t),deltaX:e.deltaX,deltaY:e.deltaY}}function Ye(e,t,n){var r=t[(n=n||Me)[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(r*r+i*i)}function qe(e,t,n){var r=t[(n=n||Me)[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return 180*Math.atan2(i,r)/Math.PI}function He(e,t){return e===t?Ce:se(e)>=se(t)?e<0?Ae:Ne:t<0?Se:Oe}function Be(e,t,n){return{x:t/e||0,y:n/e||0}}function Ve(e,t){var n=e.session,r=t.pointers,i=r.length;n.firstInput||(n.firstInput=Xe(t)),1<i&&!n.firstMultiple?n.firstMultiple=Xe(t):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=t.center=Fe(r);t.timeStamp=ue(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=qe(s,u),t.distance=Ye(s,u),function(e,t){var n=t.center,r=e.offsetDelta||{},i=e.prevDelta||{},o=e.prevInput||{};t.eventType!==Te&&o.eventType!==Pe||(i=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=i.x+(n.x-r.x),t.deltaY=i.y+(n.y-r.y)}(n,t),t.offsetDirection=He(t.deltaX,t.deltaY);var c=Be(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=se(c.x)>se(c.y)?c.x:c.y,t.scale=a?function(e,t){return Ye(t[0],t[1],je)/Ye(e[0],e[1],je)}(a.pointers,r):1,t.rotation=a?function(e,t){return qe(t[1],t[0],je)+qe(e[1],e[0],je)}(a.pointers,r):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,r,i,o,a=e.lastInterval||t,s=t.timeStamp-a.timeStamp;if(t.eventType!==Ee&&(_e<s||void 0===a.velocity)){var u=t.deltaX-a.deltaX,c=t.deltaY-a.deltaY,l=Be(s,u,c);r=l.x,i=l.y,n=se(l.x)>se(l.y)?l.x:l.y,o=He(u,c),e.lastInterval=t}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;t.velocity=n,t.velocityX=r,t.velocityY=i,t.direction=o}(n,t);var l=e.element;Ue(t.srcEvent.target,l)&&(l=t.srcEvent.target),t.target=l}function $e(e,t,n){var r=n.pointers.length,i=n.changedPointers.length,o=t&Te&&r-i==0,a=t&(Pe|Ee)&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(e.session={}),n.eventType=t,Ve(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function Ze(e){return e.trim().split(/\s+/g)}function Ge(t,e,n){Le(Ze(e),function(e){t.addEventListener(e,n,!1)})}function Qe(t,e,n){Le(Ze(e),function(e){t.removeEventListener(e,n,!1)})}function Je(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||window}var et=function(){function e(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){Re(t.options.enable,[t])&&n.handler(e)},this.init()}var t=e.prototype;return t.handler=function(){},t.init=function(){this.evEl&&Ge(this.element,this.evEl,this.domHandler),this.evTarget&&Ge(this.target,this.evTarget,this.domHandler),this.evWin&&Ge(Je(this.element),this.evWin,this.domHandler)},t.destroy=function(){this.evEl&&Qe(this.element,this.evEl,this.domHandler),this.evTarget&&Qe(this.target,this.evTarget,this.domHandler),this.evWin&&Qe(Je(this.element),this.evWin,this.domHandler)},e}();function tt(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var r=0;r<e.length;){if(n&&e[r][n]==t||!n&&e[r]===t)return r;r++}return-1}var nt={pointerdown:Te,pointermove:2,pointerup:Pe,pointercancel:Ee,pointerout:Ee},rt={2:ke,3:"pen",4:we,5:"kinect"},it="pointerdown",ot="pointermove pointerup pointercancel";te.MSPointerEvent&&!te.PointerEvent&&(it="MSPointerDown",ot="MSPointerMove MSPointerUp MSPointerCancel");var at=function(n){function r(){var e,t=r.prototype;return t.evEl=it,t.evWin=ot,(e=n.apply(this,arguments)||this).store=e.manager.session.pointerEvents=[],e}return J(r,n),r.prototype.handler=function(e){var t=this.store,n=!1,r=e.type.toLowerCase().replace("ms",""),i=nt[r],o=rt[e.pointerType]||e.pointerType,a=o===ke,s=tt(t,e.pointerId,"pointerId");i&Te&&(0===e.button||a)?s<0&&(t.push(e),s=t.length-1):i&(Pe|Ee)&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(s,1))},r}(et);function st(e){return Array.prototype.slice.call(e,0)}var ut={touchstart:Te,touchmove:2,touchend:Pe,touchcancel:Ee},ct=function(t){function n(){var e;return n.prototype.evTarget="touchstart touchmove touchend touchcancel",(e=t.apply(this,arguments)||this).targetIds={},e}return J(n,t),n.prototype.handler=function(e){var t=ut[e.type],n=function(e,t){var n,r,i=st(e.touches),o=this.targetIds;if(t&(2|Te)&&1===i.length)return o[i[0].identifier]=!0,[i,i];var a=st(e.changedTouches),s=[],u=this.target;if(r=i.filter(function(e){return Ue(e.target,u)}),t===Te)for(n=0;n<r.length;)o[r[n].identifier]=!0,n++;n=0;for(;n<a.length;)o[a[n].identifier]&&s.push(a[n]),t&(Pe|Ee)&&delete o[a[n].identifier],n++;return s.length?[function(e,n,t){for(var r=[],i=[],o=0;o<e.length;){var a=n?e[o][n]:e[o];tt(i,a)<0&&r.push(e[o]),i[o]=a,o++}return t&&(r=n?r.sort(function(e,t){return e[n]>t[n]}):r.sort()),r}(r.concat(s),"identifier",!0),s]:void 0}.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:ke,srcEvent:e})},n}(et);var lt={mousedown:Te,mousemove:2,mouseup:Pe},pt=function(n){function r(){var e,t=r.prototype;return t.evEl="mousedown",t.evWin="mousemove mouseup",(e=n.apply(this,arguments)||this).pressed=!1,e}return J(r,n),r.prototype.handler=function(e){var t=lt[e.type];t&Te&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=Pe),this.pressed&&(t&Pe&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:we,srcEvent:e}))},r}(et),ht=2500,ft=25;function dt(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY},r=this.lastTouches;this.lastTouches.push(n);setTimeout(function(){var e=r.indexOf(n);-1<e&&r.splice(e,1)},ht)}}var mt=function(){return function(n){function e(e,t){var o;return(o=n.call(this,e,t)||this).handler=function(e,t,n){var r=n.pointerType===ke,i=n.pointerType===we;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)(function(e,t){e&Te?(this.primaryTouch=t.changedPointers[0].identifier,dt.call(this,t)):e&(Pe|Ee)&&dt.call(this,t)}).call(ee(ee(o)),t,n);else if(i&&function(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(t-i.x),a=Math.abs(n-i.y);if(o<=ft&&a<=ft)return!0}return!1}.call(ee(ee(o)),n))return;o.callback(e,t,n)}},o.touch=new ct(o.manager,o.handler),o.mouse=new pt(o.manager,o.handler),o.primaryTouch=null,o.lastTouches=[],o}return J(e,n),e.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},e}(et)}();function vt(e,t,n){return!!Array.isArray(e)&&(Le(e,n[t],n),!0)}var gt=1;function yt(e,t){var n=t.manager;return n?n.get(e):e}function bt(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}var xt=function(){function e(e){void 0===e&&(e={}),this.options=Q({enable:!0},e),this.id=gt++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var t=e.prototype;return t.set=function(e){return ne(this.options,e),this.manager&&this.manager.touchAction.update(),this},t.recognizeWith=function(e){if(vt(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=yt(e,this)).id]||(t[e.id]=e).recognizeWith(this),this},t.dropRecognizeWith=function(e){return vt(e,"dropRecognizeWith",this)||(e=yt(e,this),delete this.simultaneous[e.id]),this},t.requireFailure=function(e){if(vt(e,"requireFailure",this))return this;var t=this.requireFail;return-1===tt(t,e=yt(e,this))&&(t.push(e),e.requireFailure(this)),this},t.dropRequireFailure=function(e){if(vt(e,"dropRequireFailure",this))return this;e=yt(e,this);var t=tt(this.requireFail,e);return-1<t&&this.requireFail.splice(t,1),this},t.hasRequireFailures=function(){return 0<this.requireFail.length},t.canRecognizeWith=function(e){return!!this.simultaneous[e.id]},t.emit=function(t){var n=this,e=this.state;function r(e){n.manager.emit(e,t)}e<8&&r(n.options.event+bt(e)),r(n.options.event),t.additionalEvent&&r(t.additionalEvent),8<=e&&r(n.options.event+bt(e))},t.tryEmit=function(e){if(this.canEmit())return this.emit(e);this.state=32},t.canEmit=function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},t.recognize=function(e){var t=ne({},e);if(!Re(this.options.enable,[this,t]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},t.process=function(e){},t.getTouchAction=function(){},t.reset=function(){},e}(),kt={domEvents:!1,touchAction:he,enable:!0,inputTarget:null,inputClass:null,preset:[],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function wt(n,r){var i,o=n.element;o.style&&(Le(n.options.cssProps,function(e,t){i=ce(o.style,t),r?(n.oldCssProps[i]=o.style[i],o.style[i]=e):o.style[i]=n.oldCssProps[i]||""}),r||(n.oldCssProps={}))}var _t=function(){function e(e,t){var n=this;this.options=ne({},kt,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=function(e){var t=e.options.inputClass;return new(t||(be?at:xe?ct:ye?mt:pt))(e,$e)}(this),this.touchAction=new We(this,this.options.touchAction),wt(this,!0),Le(this.options.recognizers,function(e){var t=n.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}var t=e.prototype;return t.set=function(e){return ne(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},t.stop=function(e){this.session.stopped=e?2:1},t.recognize=function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var r=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===t.stopped||i&&n!==i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&14&n.state&&(i=t.curRecognizer=n),o++}},t.get=function(e){if(e instanceof xt)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event===e)return t[n];return null},t.add=function(e){if(vt(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),(e.manager=this).touchAction.update(),e},t.remove=function(e){if(vt(e,"remove",this))return this;var t=this.get(e);if(e){var n=this.recognizers,r=tt(n,t);-1!==r&&(n.splice(r,1),this.touchAction.update())}return this},t.on=function(e,t){if(void 0===e||void 0===t)return this;var n=this.handlers;return Le(Ze(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this},t.off=function(e,t){if(void 0===e)return this;var n=this.handlers;return Le(Ze(e),function(e){t?n[e]&&n[e].splice(tt(n[e],t),1):delete n[e]}),this},t.emit=function(e,t){this.options.domEvents&&function(e,t){var n=document.createEvent("Event");n.initEvent(e,!0,!0),(n.gesture=t).target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](t),r++}},t.destroy=function(){this.element&&wt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},e}(),Tt=function(n){function e(e){return void 0===e&&(e={}),n.call(this,Q({event:"pinch",threshold:0,pointers:2},e))||this}J(e,n);var t=e.prototype;return t.getTouchAction=function(){return[de]},t.attrTest=function(e){return n.prototype.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},t.emit=function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}n.prototype.emit.call(this,e)},e}(function(t){function e(e){return void 0===e&&(e={}),t.call(this,Q({pointers:1},e))||this}J(e,t);var n=e.prototype;return n.attrTest=function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},n.process=function(e){var t=this.state,n=e.eventType,r=6&t,i=this.attrTest(e);return r&&(n&Ee||!i)?16|t:r||i?n&Pe?8|t:2&t?4|t:2:32},e}(xt)),Pt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};var Et,Ct=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Et="undefined"==typeof window?{}:window;var At=1e5,Nt=function(){if("undefined"==typeof document)return"";for(var e=(document.head||document.getElementsByTagName("head")[0]).style,t=["transform","webkitTransform","msTransform","mozTransform"],n=0,r=t.length;n<r;n++)if(t[n]in e)return t[n];return""}();function St(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(e[n]);return t}var Ot=Et.requestAnimationFrame||Et.webkitRequestAnimationFrame,It=Et.cancelAnimationFrame||Et.webkitCancelAnimationFrame;if(Ot&&!It){var Dt={},zt=Ot;Ot=function(t){var n=zt(function(e){Dt[n]&&t(e)});return Dt[n]=!0,n},It=function(e){delete Dt[e]}}else Ot&&It||(Ot=function(e){return Et.setTimeout(function(){e(Et.performance&&Et.performance.now&&Et.performance.now()||(new Date).getTime())},16)},It=Et.clearTimeout);function Mt(e){return jt(e,function(e){return Wt(e)})}function jt(e,t){var n={};for(var r in e)r&&(n[r]=t(e[r],r));return n}function Lt(e,t){var n={};for(var r in e)r&&t(e[r],r)&&(n[r]=e[r]);return n}function Rt(e,t){for(var n in e)if(n&&!t(e[n],n))return!1;return!0}function Kt(e,n){return Rt(e,function(e,t){return e===n[t]})}function Wt(e){return Math.round(e*At)/At}function Ut(e,t,n,r){var i=e,o=[n[0]?t[0]:r?t[0]-r[0]:t[0],n[1]?t[1]:r?t[1]+r[1]:t[1]];return i=Math.max(o[0],i),+Wt(i=Math.min(o[1],i))}function Ft(e,t){return e<t[0]||e>t[1]}function Xt(e,t,n){return n[1]&&e>t[1]||n[0]&&e<t[0]}function Yt(e,t,n,r){var i=e,o=t[0],a=t[1],s=a-o;return n[1]&&a<e&&(i=(i-a)%s+o),n[0]&&e<o&&(i=(i-o)%s+a),r?i:+Wt(i)}function qt(e,t,n){return Math.max(Math.min(e,n),t)}var Ht=function(){function e(e){var t=e.options,n=e.itm,r=e.em,i=e.axm;this.options=t,this.itm=n,this.em=r,this.axm=i,this.animationEnd=this.animationEnd.bind(this)}var t=e.prototype;return t.getDuration=function(n,e,t){var r,i=this;if(void 0!==t)r=t;else{var o=jt(e,function(e,t){return function(e,t){var n=Math.sqrt(e/t*2);return n<100?0:n}(Math.abs(e-n[t]),i.options.deceleration)});r=Object.keys(o).reduce(function(e,t){return Math.max(e,o[t])},-1/0)}return qt(r,this.options.minimumDuration,this.options.maximumDuration)},t.createAnimationParam=function(e,t,n){var r=this.axm.get(),i=e,o=n&&n.event||null;return{depaPos:r,destPos:i,duration:qt(t,this.options.minimumDuration,this.options.maximumDuration),delta:this.axm.getDelta(r,i),inputEvent:o,input:n&&n.input||null,isTrusted:!!o,done:this.animationEnd}},t.grab=function(e,t){if(this._animateParam&&e.length){var n=this.axm.get(e),r=this.axm.map(n,function(e,t){return Yt(e,t.range,t.circular,!1)});Rt(r,function(e,t){return n[t]===e})||this.em.triggerChange(r,!1,n,t,!!t),this._animateParam=null,this._raf&&function(e){It(e)}(this._raf),this._raf=null,this.em.triggerAnimationEnd(!(!t||!t.event))}},t.getEventInfo=function(){return this._animateParam&&this._animateParam.input&&this._animateParam.inputEvent?{input:this._animateParam.input,event:this._animateParam.inputEvent}:null},t.restore=function(e){var t=this.axm.get(),n=this.axm.map(t,function(e,t){return Math.min(t.range[1],Math.max(t.range[0],e))});this.animateTo(n,this.getDuration(t,n),e)},t.animationEnd=function(){var e=this.getEventInfo();this._animateParam=null;var t=this.axm.filter(this.axm.get(),function(e,t){return Xt(e,t.range,t.circular)});0<Object.keys(t).length&&this.setTo(this.axm.map(t,function(e,t){return Yt(e,t.range,t.circular,!1)})),this.itm.setInterrupt(!1),this.em.triggerAnimationEnd(!!e),this.axm.isOutside()?this.restore(e):this.finish(!!e)},t.finish=function(e){this._animateParam=null,this.itm.setInterrupt(!1),this.em.triggerFinish(e)},t.animateLoop=function(a,s){if(a.duration){this._animateParam=Ct({},a);var u=this._animateParam,c=this,l=u.depaPos,p=0,h=jt(l,function(e,t){return e<=u.destPos[t]?1:-1}),f=(new Date).getTime();u.startTime=f,function e(){c._raf=null;var t=(new Date).getTime(),n=c.easing((t-u.startTime)/a.duration),r=jt(l,function(e,t){return e+u.delta[t]*(n-p)});r=c.axm.map(r,function(e,t,n){var r=Yt(e,t.range,t.circular,!0);return e!==r&&(a.destPos[n]+=-h[n]*(t.range[1]-t.range[0]),l[n]+=-h[n]*(t.range[1]-t.range[0])),r});var i=!c.em.triggerChange(r,!1,Mt(l));if(l=r,f=t,1<=(p=n)){var o=a.destPos;return Kt(o,c.axm.get(Object.keys(o)))||c.em.triggerChange(o,!0,Mt(l)),void s()}i?c.finish(!1):c._raf=function(e){return Ot(e)}(e)}()}else this.em.triggerChange(a.destPos,!0),s()},t.getUserControll=function(e){var t=e.setTo();return t.destPos=this.axm.get(t.destPos),t.duration=qt(t.duration,this.options.minimumDuration,this.options.maximumDuration),t},t.animateTo=function(e,t,n){var r=this,i=this.createAnimationParam(e,t,n),o=Ct({},i.depaPos),a=this.em.triggerAnimationStart(i),s=this.getUserControll(i);if(!a&&this.axm.every(s.destPos,function(e,t){return Xt(e,t.range,t.circular)})&&console.warn("You can't stop the 'animation' event when 'circular' is true."),a&&!Kt(s.destPos,o)){var u=n&&n.event||null;this.animateLoop({depaPos:o,destPos:s.destPos,duration:s.duration,delta:this.axm.getDelta(o,s.destPos),isTrusted:!!u,inputEvent:u,input:n&&n.input||null},function(){return r.animationEnd()})}},t.easing=function(e){return 1<e?1:this.options.easing(e)},t.setTo=function(e,t){void 0===t&&(t=0);var n=Object.keys(e);this.grab(n);var r=this.axm.get(n);if(Kt(e,r))return this;this.itm.setInterrupt(!0);var i=Lt(e,function(e,t){return r[t]!==e});return Object.keys(i).length&&(Kt(i=this.axm.map(i,function(e,t){var n=t.range,r=t.circular;return r&&(r[0]||r[1])?e:Ut(e,n,r)}),r)||(0<t?this.animateTo(i,t):(this.em.triggerChange(i),this.finish(!1)))),this},t.setBy=function(n,e){return void 0===e&&(e=0),this.setTo(jt(this.axm.get(Object.keys(n)),function(e,t){return e+n[t]}),e)},e}(),Bt=function(){function e(e){this.axes=e}var t=e.prototype;return t.triggerHold=function(e,t){this.axes.trigger("hold",{pos:e,input:t.input||null,inputEvent:t.event||null,isTrusted:!0})},t.triggerRelease=function(e){e.setTo=this.createUserControll(e.destPos,e.duration),this.axes.trigger("release",e)},t.triggerChange=function(e,t,n,r,i){void 0===i&&(i=!1);var o=this.am,a=o.axm,s=o.getEventInfo(),u=a.moveTo(e,t,n),c=r&&r.event||s&&s.event||null,l={pos:u.pos,delta:u.delta,holding:i,inputEvent:c,isTrusted:!!c,input:r&&r.input||s&&s.input||null,set:c?this.createUserControll(u.pos):function(){}},p=this.axes.trigger("change",l);return c&&a.set(l.set().destPos),p},t.triggerAnimationStart=function(e){return e.setTo=this.createUserControll(e.destPos,e.duration),this.axes.trigger("animationStart",e)},t.triggerAnimationEnd=function(e){void 0===e&&(e=!1),this.axes.trigger("animationEnd",{isTrusted:e})},t.triggerFinish=function(e){void 0===e&&(e=!1),this.axes.trigger("finish",{isTrusted:e})},t.createUserControll=function(e,t){void 0===t&&(t=0);var n={destPos:Ct({},e),duration:t};return function(e,t){return e&&(n.destPos=Ct({},e)),void 0!==t&&(n.duration=t),n}},t.setAnimationManager=function(e){this.am=e},t.destroy=function(){this.axes.off()},e}(),Vt=function(){function e(e){this.options=e,this._prevented=!1}var t=e.prototype;return t.isInterrupting=function(){return this.options.interruptable||this._prevented},t.isInterrupted=function(){return!this.options.interruptable&&this._prevented},t.setInterrupt=function(e){this.options.interruptable||(this._prevented=e)},e}(),$t=function(){function e(e,t){var n=this;this.axis=e,this.options=t,this._complementOptions(),this._pos=Object.keys(this.axis).reduce(function(e,t){return e[t]=n.axis[t].range[0],e},{})}var t=e.prototype;return t._complementOptions=function(){var i=this;Object.keys(this.axis).forEach(function(r){i.axis[r]=Ct({range:[0,100],bounce:[0,0],circular:[!1,!1]},i.axis[r]),["bounce","circular"].forEach(function(e){var t=i.axis,n=t[r][e];/string|number|boolean/.test(typeof n)&&(t[r][e]=[n,n])})})},t.getDelta=function(e,t){var n=this.get(e);return jt(this.get(t),function(e,t){return e-n[t]})},t.get=function(e){var n=this;return e&&Array.isArray(e)?e.reduce(function(e,t){return t&&t in n._pos&&(e[t]=n._pos[t]),e},{}):Ct({},this._pos,e||{})},t.moveTo=function(n,r,i){void 0===i&&(i=this._pos);var e=jt(this._pos,function(e,t){return t in n&&t in i?n[t]-i[t]:0});return this.set(this.map(n,function(e,t){return t?Yt(e,t.range,t.circular,r):0})),{pos:Ct({},this._pos),delta:e}},t.set=function(e){for(var t in e)t&&t in this._pos&&(this._pos[t]=e[t])},t.every=function(e,n){var r=this.axis;return Rt(e,function(e,t){return n(e,r[t],t)})},t.filter=function(e,n){var r=this.axis;return Lt(e,function(e,t){return n(e,r[t],t)})},t.map=function(e,n){var r=this.axis;return jt(e,function(e,t){return n(e,r[t],t)})},t.isOutside=function(e){return!this.every(e?this.get(e):this._pos,function(e,t){return!Ft(e,t.range)})},e}(),Zt=function(){function e(e){var t=e.options,n=e.itm,r=e.em,i=e.axm,o=e.am;this.isOutside=!1,this.moveDistance=null,this.isStopped=!1,this.options=t,this.itm=n,this.em=r,this.axm=i,this.am=o}var t=e.prototype;return t.atOutside=function(e){var a=this;if(this.isOutside)return this.axm.map(e,function(e,t){var n=t.range[0]-t.bounce[0],r=t.range[1]+t.bounce[1];return r<e?r:e<n?n:e});var s=this.am.easing(1e-5)/1e-5;return this.axm.map(e,function(e,t){var n=t.range[0],r=t.range[1],i=t.bounce,o=t.circular;return o&&(o[0]||o[1])?e:e<n?n-a.am.easing((n-e)/(i[0]*s))*i[0]:r<e?r+a.am.easing((e-r)/(i[1]*s))*i[1]:e})},t.get=function(e){return this.axm.get(e.axes)},t.hold=function(e,t){if(!this.itm.isInterrupted()&&e.axes.length){var n={input:e,event:t};this.isStopped=!1,this.itm.setInterrupt(!0),this.am.grab(e.axes,n),this.moveDistance||this.em.triggerHold(this.axm.get(),n),this.isOutside=this.axm.isOutside(e.axes),this.moveDistance=this.axm.get(e.axes)}},t.change=function(e,t,n){if(!this.isStopped&&this.itm.isInterrupting()&&!this.axm.every(n,function(e){return 0===e})){var r,i=this.moveDistance||this.axm.get(e.axes);r=jt(i,function(e,t){return e+(n[t]||0)}),this.moveDistance&&(this.moveDistance=r),this.isOutside&&this.axm.every(i,function(e,t){return!Ft(e,t.range)})&&(this.isOutside=!1),i=this.atOutside(i),r=this.atOutside(r),this.em.triggerChange(r,!1,i,{input:e,event:t},!0)||(this.isStopped=!0,this.moveDistance=null,this.am.finish(!1))}},t.release=function(e,t,n,r){if(!this.isStopped&&this.itm.isInterrupting()&&this.moveDistance){var i=this.axm.get(e.axes),o=this.axm.get(),a=this.axm.get(this.axm.map(n,function(e,t,n){return t.circular&&(t.circular[0]||t.circular[1])?i[n]+e:Ut(i[n]+e,t.range,t.circular,t.bounce)})),s=this.am.getDuration(a,i,r);0===s&&(a=Ct({},o));var u={depaPos:o,destPos:a,duration:s,delta:this.axm.getDelta(o,a),inputEvent:t,input:e,isTrusted:!0};this.em.triggerRelease(u),this.moveDistance=null;var c=this.am.getUserControll(u),l=Kt(c.destPos,o),p={input:e,event:t};l||0===c.duration?(l||this.em.triggerChange(c.destPos,!1,o,p,!0),this.itm.setInterrupt(!1),this.axm.isOutside()?this.am.restore(p):this.em.triggerFinish(!0)):this.am.animateTo(c.destPos,c.duration,p)}},e}(),Gt=function(i){function e(e,t,n){void 0===e&&(e={}),void 0===t&&(t={});var r=i.call(this)||this;return r.axis=e,r._inputs=[],r.options=Ct({easing:function(e){return 1-Math.pow(1-e,3)},interruptable:!0,maximumDuration:1/0,minimumDuration:0,deceleration:6e-4},t),r.itm=new Vt(r.options),r.axm=new $t(r.axis,r.options),r.em=new Bt(r),r.am=new Ht(r),r.io=new Zt(r),r.em.setAnimationManager(r.am),n&&r.em.triggerChange(n),r}!function(e,t){function n(){this.constructor=e}Pt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(e,i);var t=e.prototype;return t.connect=function(e,t){var n;if(n="string"==typeof e?e.split(" "):e.concat(),~this._inputs.indexOf(t)&&this.disconnect(t),"hammer"in t){var r=this._inputs.filter(function(e){return e.hammer&&e.element===t.element});r.length&&(t.hammer=r[0].hammer)}return t.mapAxes(n),t.connect(this.io),this._inputs.push(t),this},t.disconnect=function(e){if(e){var t=this._inputs.indexOf(e);0<=t&&(this._inputs[t].disconnect(),this._inputs.splice(t,1))}else this._inputs.forEach(function(e){return e.disconnect()}),this._inputs=[];return this},t.get=function(e){return this.axm.get(e)},t.setTo=function(e,t){return void 0===t&&(t=0),this.am.setTo(e,t),this},t.setBy=function(e,t){return void 0===t&&(t=0),this.am.setBy(e,t),this},t.isBounceArea=function(e){return this.axm.isOutside(e)},t.destroy=function(){this.disconnect(),this.em.destroy()},e.VERSION="2.5.13",e.TRANSFORM=Nt,e.DIRECTION_NONE=Ce,e.DIRECTION_LEFT=Ae,e.DIRECTION_RIGHT=Ne,e.DIRECTION_UP=Se,e.DIRECTION_DOWN=Oe,e.DIRECTION_HORIZONTAL=Ie,e.DIRECTION_VERTICAL=De,e.DIRECTION_ALL=ze,e}(e),Qt="PointerEvent"in Et||"MSPointerEvent"in Et,Jt="ontouchstart"in Et,en="_EGJS_AXES_INPUTTYPE_";function tn(r,e){return e.reduce(function(e,t,n){return r[n]&&(e[r[n]]=t),e},{})}var nn=function(){function e(e,t){if(this.axes=[],this.hammer=null,this.element=null,this._base=null,this._prev=null,this.pinchRecognizer=null,void 0===_t)throw new Error("The Hammerjs must be loaded before eg.Axes.PinchInput.\nhttp://hammerjs.github.io/");this.element=function t(e,n){var r;if(void 0===n&&(n=!1),"string"==typeof e){if(e.match(/^<([a-z]+)\s*([^>]*)>/)){var i=document.createElement("div");i.innerHTML=e,r=St(i.childNodes)}else r=St(document.querySelectorAll(e));n||(r=1<=r.length?r[0]:void 0)}else e===Et?r=e:!e.nodeName||1!==e.nodeType&&9!==e.nodeType?"jQuery"in Et&&e instanceof jQuery||e.constructor.prototype.jquery?r=n?e.toArray():e.get(0):Array.isArray(e)&&(r=e.map(function(e){return t(e)}),n||(r=1<=r.length?r[0]:void 0)):r=e;return r}(e),this.options=Ct({scale:1,threshold:0,inputType:["touch","pointer"],hammerManagerOptions:{cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",userDrag:"none"}}},t),this.onPinchStart=this.onPinchStart.bind(this),this.onPinchMove=this.onPinchMove.bind(this),this.onPinchEnd=this.onPinchEnd.bind(this)}var t=e.prototype;return t.mapAxes=function(e){this.axes=e},t.connect=function(e){var t={threshold:this.options.threshold};if(this.hammer)this.removeRecognizer(),this.dettachEvent();else{var n=this.element[en];n=n||String(Math.round(Math.random()*(new Date).getTime()));var r=function(e){void 0===e&&(e=[]);var t=!1,n=!1,r=!1;return e.forEach(function(e){switch(e){case"mouse":n=!0;break;case"touch":t=Jt;break;case"pointer":r=Qt}}),r?at:t&&n?mt:t?ct:n?pt:null}(this.options.inputType);if(!r)throw new Error("Wrong inputType parameter!");this.hammer=function(e,t){try{return new _t(e,Ct({},t))}catch(e){return null}}(this.element,Ct({inputClass:r},this.options.hammerManagerOptions)),this.element[en]=n}return this.pinchRecognizer=new Tt(t),this.hammer.add(this.pinchRecognizer),this.attachEvent(e),this},t.disconnect=function(){return this.removeRecognizer(),this.hammer&&(this.hammer.remove(this.pinchRecognizer),this.pinchRecognizer=null,this.dettachEvent()),this},t.destroy=function(){this.disconnect(),this.hammer&&0===this.hammer.recognizers.length&&this.hammer.destroy(),delete this.element[en],this.element=null,this.hammer=null},t.removeRecognizer=function(){this.hammer&&this.pinchRecognizer&&(this.hammer.remove(this.pinchRecognizer),this.pinchRecognizer=null)},t.onPinchStart=function(e){this._base=this.observer.get(this)[this.axes[0]];var t=this.getOffset(e.scale);this.observer.hold(this,e),this.observer.change(this,e,tn(this.axes,[t])),this._prev=e.scale},t.onPinchMove=function(e){var t=this.getOffset(e.scale,this._prev);this.observer.change(this,e,tn(this.axes,[t])),this._prev=e.scale},t.onPinchEnd=function(e){var t=this.getOffset(e.scale,this._prev);this.observer.change(this,e,tn(this.axes,[t])),this.observer.release(this,e,tn(this.axes,[0]),0),this._base=null,this._prev=null},t.getOffset=function(e,t){return void 0===t&&(t=1),this._base*(e-t)*this.options.scale},t.attachEvent=function(e){this.observer=e,this.hammer.on("pinchstart",this.onPinchStart).on("pinchmove",this.onPinchMove).on("pinchend",this.onPinchEnd)},t.dettachEvent=function(){this.hammer.off("pinchstart",this.onPinchStart).off("pinchmove",this.onPinchMove).off("pinchend",this.onPinchEnd),this.observer=null,this._prev=null},t.enable=function(){return this.hammer&&(this.hammer.get("pinch").options.enable=!0),this},t.disable=function(){return this.hammer&&(this.hammer.get("pinch").options.enable=!1),this},t.isEnable=function(){return!(!this.hammer||!this.hammer.get("pinch").options.enable)},e}(),rn=function(e,t){return(rn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var on=function(){return(on=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},an="a abbr address area article aside audio b base bdi bdo big blockquote body br button canvas caption cite code col colgroup data datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins kbd keygen label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td textarea tfoot th thead time title tr track u ul var video wbr circle clipPath defs ellipse g image line linearGradient mask path pattern polygon polyline radialGradient rect stop svg text tspan".split(" "),sn="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,un="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("__preactCompatWrapper"):"__preactCompatWrapper",cn={constructor:1,render:1,shouldComponentUpdate:1,componentWillReceiveProps:1,componentWillUpdate:1,componentDidUpdate:1,componentWillMount:1,componentDidMount:1,componentWillUnmount:1,componentDidUnmount:1},ln=/^(?:accent|alignment|arabic|baseline|cap|clip|color|fill|flood|font|glyph|horiz|marker|overline|paint|stop|strikethrough|stroke|text|underline|unicode|units|v|vector|vert|word|writing|x)[A-Z]/,pn={},hn=!1;try{hn="production"!==process.env.NODE_ENV}catch(e){}var fn=s("a",null).constructor;fn.prototype.$$typeof=sn,fn.prototype.preactCompatUpgraded=!1,fn.prototype.preactCompatNormalized=!1,Object.defineProperty(fn.prototype,"type",{get:function(){return this.nodeName},set:function(e){this.nodeName=e},configurable:!0}),Object.defineProperty(fn.prototype,"props",{get:function(){return this.attributes},set:function(e){this.attributes=e},configurable:!0});var dn=c.event;c.event=function(e){return dn&&(e=dn(e)),e.persist=Object,e.nativeEvent=e};var mn=c.vnode;c.vnode=function(e){if(!e.preactCompatUpgraded){e.preactCompatUpgraded=!0;var t=e.nodeName,n=e.attributes=null==e.attributes?{}:Pn({},e.attributes);"function"==typeof t?(!0===t[un]||t.prototype&&"isReactComponent"in t.prototype)&&(e.children&&""===String(e.children)&&(e.children=void 0),e.children&&(n.children=e.children),e.preactCompatNormalized||_n(e),function(e){var t=e.nodeName,n=e.attributes;e.attributes={},t.defaultProps&&Pn(e.attributes,t.defaultProps);n&&Pn(e.attributes,n)}(e)):(e.children&&""===String(e.children)&&(e.children=void 0),e.children&&(n.children=e.children),n.defaultValue&&(n.value||0===n.value||(n.value=n.defaultValue),delete n.defaultValue),function(e,t){var n,r,i;if(t){for(i in t)if(n=ln.test(i))break;if(n)for(i in r=e.attributes={},t)t.hasOwnProperty(i)&&(r[ln.test(i)?i.replace(/([A-Z0-9])/,"-$1").toLowerCase():i]=t[i])}}(e,n))}mn&&mn(e)};var vn,gn=[];for(var yn,bn={},xn=an.length;xn--;)bn[an[xn]]=(yn=an[xn],wn.bind(null,yn));function kn(e){return function(e){function t(e,t){!function(e){for(var t in e){var n=e[t];"function"!=typeof n||n.__bound||cn.hasOwnProperty(t)||((e[t]=n.bind(e)).__bound=!0)}}(this),zn.call(this,e,t,pn),Sn.call(this,e,t)}(e=Pn({constructor:t},e)).mixins&&function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=Nn(t[n].concat(e[n]||gn),"getDefaultProps"===n||"getInitialState"===n||"getChildContext"===n))}(e,function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];for(var i in r)r.hasOwnProperty(i)&&"function"==typeof r[i]&&(t[i]||(t[i]=[])).push(r[i])}return t}(e.mixins));e.statics&&Pn(t,e.statics);e.propTypes&&(t.propTypes=e.propTypes);e.defaultProps&&(t.defaultProps=e.defaultProps);e.getDefaultProps&&(t.defaultProps=e.getDefaultProps.call(t));return Cn.prototype=zn.prototype,t.prototype=Pn(new Cn,e),t.displayName=e.displayName||"Component",t}({displayName:e.displayName||e.name,render:function(){return e(this.props,this.context)}})}function wn(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function e(t,n){for(var r=n||0;r<t.length;r++){var i=t[r];Array.isArray(i)?e(i):!i||"object"!=typeof i||(o=i)&&(o instanceof fn||o.$$typeof===sn)||!(i.props&&i.type||i.attributes&&i.nodeName||i.children)||(t[r]=wn(i.type||i.nodeName,i.props||i.attributes,i.children))}var o}(e,2),_n(s.apply(void 0,e))}function _n(e){e.preactCompatNormalized=!0,function(e){var t=e.attributes||(e.attributes={});Tn.enumerable="className"in t,t.className&&(t.class=t.className);Object.defineProperty(t,"className",Tn)}(e),function(e){return"function"==typeof e&&!(e.prototype&&e.prototype.render)}(e.nodeName)&&(e.nodeName=function(e){var t=e[un];return t?!0===t?e:t:(t=kn(e),Object.defineProperty(t,un,{configurable:!0,value:!0}),t.displayName=e.displayName,t.propTypes=e.propTypes,t.defaultProps=e.defaultProps,Object.defineProperty(e,un,{configurable:!0,value:t}),t)}(e.nodeName));var t=e.attributes.ref,n=t&&typeof t;return!vn||"string"!==n&&"number"!==n||(e.attributes.ref=function(t,n){return n._refProxies[t]||(n._refProxies[t]=function(e){n&&n.refs&&null===(n.refs[t]=e)&&(delete n._refProxies[t],n=null)})}(t,vn)),function(e){var t=e.nodeName,n=e.attributes;if(!n||"string"!=typeof t)return;var r={};for(var i in n)r[i.toLowerCase()]=i;r.ondoubleclick&&(n.ondblclick=n[r.ondoubleclick],delete n[r.ondoubleclick]);if(r.onchange&&("textarea"===t||"input"===t.toLowerCase()&&!/^fil|che|rad/i.test(n.type))){var o=r.oninput||"oninput";n[o]||(n[o]=Nn([n[o],n[r.onchange]]),delete n[r.onchange])}}(e),e}var Tn={configurable:!0,get:function(){return this.class},set:function(e){this.class=e}};function Pn(e){for(var t=arguments,n=1,r=void 0;n<arguments.length;n++)if(r=t[n])for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i]);return e}function En(e,t){for(var n in e)if(!(n in t))return!0;for(var r in t)if(e[r]!==t[r])return!0;return!1}function Cn(){}function An(e,t,n){if("string"==typeof t&&(t=e.constructor.prototype[t]),"function"==typeof t)return t.apply(e,n)}function Nn(o,a){return function(){for(var e,t=arguments,n=0;n<o.length;n++){var r=An(this,o[n],t);if(a&&null!=r)for(var i in e=e||{},r)r.hasOwnProperty(i)&&(e[i]=r[i]);else void 0!==r&&(e=r)}return e}}function Sn(e,t){On.call(this,e,t),this.componentWillReceiveProps=Nn([On,this.componentWillReceiveProps||"componentWillReceiveProps"]),this.render=Nn([On,In,this.render||"render",Dn])}function On(e,t){if(e){var n=e.children;if(n&&Array.isArray(n)&&1===n.length&&("string"==typeof n[0]||"function"==typeof n[0]||n[0]instanceof fn)&&(e.children=n[0],e.children&&"object"==typeof e.children&&(e.children.length=1,e.children[0]=e.children)),hn){var r="function"==typeof this?this:this.constructor;this.propTypes||r.propTypes,this.displayName||r.name}}}function In(e){vn=this}function Dn(){vn===this&&(vn=null)}function zn(e,t,n){k.call(this,e,t),this.state=this.getInitialState?this.getInitialState():{},this.refs={},this._refProxies={},n!==pn&&Sn.call(this,e,t)}function Mn(e,t){zn.call(this,e,t)}Pn(zn.prototype=new k,{constructor:zn,isReactComponent:{},replaceState:function(e,t){for(var n in this.setState(e,t),this.state)n in e||delete this.state[n]},getDOMNode:function(){return this.base},isMounted:function(){return!!this.base}}),Cn.prototype=zn.prototype,(Mn.prototype=new Cn).isPureReactComponent=!0,Mn.prototype.shouldComponentUpdate=function(e,t){return En(this.props,e)||En(this.state,t)};var jn=function(e,t){return(jn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function Ln(e,t){function n(){this.constructor=e}jn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Rn=function(){return(Rn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};var Kn="scenejs-editor-",Wn="PointerEvent"in window||"MSPointerEvent"in window,Un="ontouchstart"in window,Fn=("\n.item-info {\n    position: fixed;\n    right: 0;\n    top: 0;\n    width: 200px;\n    background: #000;\n}\n.options-area {\n\n}\n.option-area {\n    position: relative;\n    border-bottom: 1px solid #777;\n    box-sizing: border-box;\n    white-space: nowrap;\n    background: rgba(90, 90, 90, 0.7);\n    font-size: 13px;\n    font-weight: bold;\n    color: #eee;\n    display: flex;\n}\n.option-name, .option-value {\n    width: 50%;\n    height: 30px;\n    line-height: 20px;\n    box-sizing: border-box;\n    padding: 5px;\n}\n.option-name {\n    border-right: 1px solid #999;\n}\n.option-value input {\n    appearance: none;\n    -webkit-appearance: none;\n    outline: none;\n    position: relative;\n    display: block;\n    width: 100%;\n    height: 100%;\n    background: transparent;\n    color: #4af;\n    font-weight: bold;\n    background: none;\n    border: 0;\n    box-sizing: border-box;\n}\n".replace(/\.([^{,\s\d.]+)/g,"."+Kn+"$1"),'\n.timeline * {\n    box-sizing: border-box;\n}\n.timeline {\n  position: relative;\n  width: 100%;\n  font-size: 0;\n  background: #000;\n  display: flex;\n  flex-direction: column;\n}\n.header-area, .scroll-area {\n   width: 100%;\n   position: relative;\n  display: flex;\n  -webkit-align-items: flex-start;\n  align-items: flex-start;\n}\n.header-area {\n  position: relative;\n  z-index: 10;\n  top: 0;\n  height: 30px;\n  min-height: 30px;\n}\n.header-area .keyframes {\n  padding: 0px;\n}\n.header-area .properties-area,\n.header-area .keyframes-area,\n.header-area .values-area,\n.header-area .keyframes-scroll-area {\n    height: 100%;\n}\n.header-area .keyframes-scroll-area {\n    overflow: hidden;\n}\n.header-area .property, .header-area .value, .header-area .keyframes {\n  height: 100%;\n}\n.header-area .property {\n    line-height: 30px;\n}\n.value .add {\n    text-align: center;\n    color: #fff;\n    line-height: 30px;\n    font-weight: bold;\n    font-size: 20px;\n    cursor: pointer;\n}\n.header-area .keyframes-area::-webkit-scrollbar {\n    display: none; // Safari and Chrome\n}\n.header-area .keyframe-cursor {\n    position: absolute;\n    border-top: 10px solid #4af;\n    border-left: 6px solid transparent;\n    border-right: 6px solid transparent;\n    width: 0;\n    height: 0;\n    bottom: 0;\n    top: auto;\n    background: none;\n    cursor: pointer;\n}\n.control-area .keyframes {\n    padding-left: 10px;\n}\n.play-control-area {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n.play-control-area .control {\n    position: relative;\n    display: inline-block;\n    vertical-align: middle;\n    color: white;\n    margin: 0px 15px;\n    cursor: pointer;\n}\n.play {\n    border-left: 14px solid white;\n    border-top: 8px solid transparent;\n    border-bottom: 8px solid transparent;\n}\n.pause {\n    border-left: 4px solid #fff;\n    border-right: 4px solid #fff;\n    width: 14px;\n    height: 16px;\n}\n.prev {\n    border-right: 10px solid white;\n    border-top: 6px solid transparent;\n    border-bottom: 6px solid transparent;\n}\n.prev:before {\n    position: absolute;\n    content: "";\n    width: 3px;\n    height: 10px;\n    top: 0;\n    right: 100%;\n    transform: translate(0, -50%);\n    background: white;\n}\n.next {\n    border-left: 10px solid white;\n    border-top: 6px solid transparent;\n    border-bottom: 6px solid transparent;\n}\n.next:before {\n    position: absolute;\n    content: "";\n    width: 3px;\n    height: 10px;\n    top: 0;\n    transform: translate(0, -50%);\n    background: white;\n}\n.keytime {\n  position: relative;\n  display: inline-block;\n  height: 100%;\n  font-size: 13px;\n  font-weight: bold;\n  color: #777;\n}\n.keytime:last-child {\n  max-width: 0px;\n}\n.keytime span {\n  position: absolute;\n  line-height: 1;\n  bottom: 12px;\n  display: inline-block;\n  transform: translate(-50%);\n  color: #eee;\n}\n.keytime .graduation {\n  position: absolute;\n  bottom: 0;\n  width: 1px;\n  height: 10px;\n  background: #777;\n  transform: translate(-50%);\n}\n.keytime .graduation.half {\n  left: 50%;\n  height: 7px;\n}\n.keytime .graduation.quarter {\n  left: 25%;\n  height: 5px;\n}\n.keytime .graduation.quarter3 {\n  left: 75%;\n  height: 5px;\n}\n.scroll-area {\n  position: relative;\n  width: 100%;\n  height: calc(100% - 60px);\n  overflow: auto;\n}\n.properties-area, .keyframes-area, .values-area {\n  display: inline-block;\n  position: relative;\n  font-size: 16px;\n  overflow: auto;\n}\n\n.properties-area::-webkit-scrollbar, .keyframes-area::-webkit-scrollbar {\n    display: none; // Safari and Chrome\n}\n.properties-area {\n  width: 30%;\n  max-width: 200px;\n  box-sizing: border-box;\n}\n.values-area {\n    width: 50px;\n    min-width: 50px;\n    display: inline-block;\n    border-right: 1px solid #999;\n    box-sizing: border-box;\n}\n.value input {\n    appearance: none;\n    -webkit-appearance: none;\n    outline: none;\n    position: relative;\n    display: block;\n    width: 100%;\n    height: 100%;\n    background: transparent;\n    color: #4af;\n    font-weight: bold;\n    background: none;\n    border: 0;\n    box-sizing: border-box;\n    text-align: center;\n}\n.value {\n\n}\n.alt .value input {\n    cursor: ew-resize;\n}\n.value[data-object="1"] input {\n    display: none;\n}\n.properties-scroll-area {\n  display: inline-block;\n  min-width: 100%;\n}\n.keyframes-area {\n  flex: 1;\n}\n.keyframes-scroll-area {\n  position: relative;\n  min-width: 300px;\n}\n.keyframes, .property, .value {\n  position: relative;\n  height: 30px;\n  line-height: 30px;\n  border-bottom: 1px solid #777;\n  box-sizing: border-box;\n  white-space: nowrap;\n  background: rgba(90, 90, 90, 0.7);\n  z-index: 1;\n}\n\n.property {\n  padding-left: 10px;\n  box-sizing: border-box;\n  font-size: 13px;\n  font-weight: bold;\n  color: #eee;\n}\n.property .remove {\n    position: absolute;\n    display: inline-block;\n    cursor: pointer;\n    width: 18px;\n    height: 18px;\n    top: 0;\n    bottom: 0;\n    right: 10px;\n    margin: auto;\n    border-radius: 50%;\n    border: 2px solid #fff;\n    vertical-align: middle;\n    display: none;\n    margin-left: 10px;\n    box-sizing: border-box;\n}\n.property .remove:before, .property .remove:after {\n    position: absolute;\n    content: "";\n    width: 8px;\n    height: 2px;\n    border-radius: 1px;\n    background: #fff;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    margin: auto;\n}\n.property .remove:before {\n    transform: rotate(45deg);\n}\n.property .remove:after {\n    transform: rotate(-45deg);\n}\n.property:hover .remove {\n    display: inline-block;\n}\n\n[data-item="1"], [data-item="1"] .add {\n    height: 30px;\n    line-height: 30px;\n}\n.time-area {\n    position: absolute;\n    top: 0;\n    left: 10px;\n    font-size: 13px;\n    color: #4af;\n    line-height: 30px;\n    font-weight: bold;\n    height: 100%;\n    line-height: 30px;\n    border: 0;\n    background: transparent;\n    outline: 0;\n}\n.time-area:after {\n    content: "s";\n}\n.property .arrow {\n    position: relative;\n    display: inline-block;\n    width: 20px;\n    height: 25px;\n    cursor: pointer;\n    vertical-align: middle;\n}\n.property .arrow:after {\n    content: "";\n    position: absolute;\n    top: 0;\n    right: 0;\n    left: 0;\n    bottom: 0;\n    margin: auto;\n    width: 0;\n    height: 0;\n    border-top: 6px solid #eee;\n    border-left: 4px solid transparent;\n    border-right: 4px solid transparent;\n}\n.property[data-fold="1"] .arrow:after {\n    border-top: 4px solid transparent;\n    border-bottom: 4px solid transparent;\n    border-right: 0;\n    border-left: 6px solid #eee;\n}\n.property[data-object="0"] .arrow {\n    display: none;\n}\n.property.fold, .keyframes.fold, .value.fold {\n    display: none;\n}\n.property.select, .value.select, .keyframes.select {\n    background: rgba(120, 120, 120, 0.7);\n}\n.keyframes {\n\n}\n.keyframe-delay {\n  position: absolute;\n  top: 3px;\n  bottom: 3px;\n  left: 0;\n  background: #4af;\n  opacity: 0.2;\n  z-index: 0;\n}\n.keyframe-group {\n    position: absolute;\n    top: 3px;\n    bottom: 3px;\n    left: 0;\n    background: #4af;\n    opacity: 0.6;\n    border: 1px solid rgba(0, 0, 0, 0.2);\n    border-left-color: rgba(255, 255, 255, 0.2);\n    border-top-color: rgba(255, 255, 255, 0.2);\n    z-index: 0;\n}\n.keyframe-line {\n  position: absolute;\n  height: 8px;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  background: #666;\n  z-index: 0;\n}\n.keyframe {\n  position: absolute;\n  font-size: 0px;\n  width: 12px;\n  height: 12px;\n  top: 0px;\n  bottom: 0px;\n  margin: auto;\n  background: #fff;\n  border: 2px solid #383838;\n  border-radius: 2px;\n  box-sizing: border-box;\n  transform: translate(-50%) rotate(45deg);\n  z-index: 1;\n  cursor: pointer;\n}\n.keyframe[data-no="1"] {\n    opacity: 0.2;\n}\n.select .keyframe {\n    border-color: #555;\n}\n.keyframe.select {\n    background: #4af;\n}\n.keyframes-container, .line-area {\n  position: relative;\n  width: calc(100% - 30px);\n  left: 15px;\n  height: 100%;\n}\n.line-area {\n  position: absolute;\n  top: 0;\n  z-index: 0;\n}\n.keyframe-cursor {\n  position: absolute;\n  top: 0;\n  z-index: 1;\n  background: #4af;\n  width: 1px;\n  height: 100%;\n  left: 15px;\n  transform: translate(-50%);\n}\n.scroll-aare .keyframe-cursor {\n  pointer-events: none;\n}\n.division-line {\n  position: absolute;\n  background: #333;\n  width: 1px;\n  height: 100%;\n  transform: translate(-50%);\n}\n'.replace(/\.([^{,\s\d.]+)/g,"."+Kn+"$1")),Xn="direction",Yn="iterationCount",qn="delay",Hn="playSpeed",Bn="alternate",Vn="reverse",$n="alternate-reverse";function Zn(e,t,n){var r=(""+e).length,i=[];n&&i.push(e);for(var o=r;o<t;++o)i.push(0);return n||i.push(e),i.join("")}function Gn(t){return K(t)?Array.isArray(t)?"["+t.join(", ")+"]":"{"+function(e){var t=[];for(var n in e)t.push(n);return t}(t).map(function(e){return e+": "+Gn(t[e])}).join(", ")+"}":t}function Qn(e,t){for(var n=e;n&&n!==document.body;){if(t(n))return n;n=n.parentNode}return null}function Jn(e,t){return function(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}(e,Kn+t)}function er(e){return!!e.constructor.prototype.getItem}function tr(e,i){return W(e,function(e){var t=e.getBoundingClientRect(),n=t.top,r=n+t.height;return n<=i&&i<r})}function nr(e){return e.split(" ").map(function(e){return Kn+e}).join(" ")}function rr(t,n){return function(e){e&&(t[n]=e)}}function ir(t,n,r){return function(e){e&&(t[n][r]=e)}}function or(n,r){var e=W(r,function(e,t){return n[r.slice(0,t+1).join("///")+"///"]});return-1<e?e===r.length-1?2:1:0}function ar(e,t,n){var r=t+"///",i=e.state.foldedInfo;i[r]=!i[r],n||e.setState({foldedInfo:Rn({},i)})}function sr(e){for(var t=e.maxTime,n=[],r=0;r<=t;++r)n.push(wn("div",{className:nr("division-line"),key:r,style:{left:100/t*r+"%"}}));return wn("div",{className:nr("line-area")},n)}var ur=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ln(t,e),t.prototype.getElement=function(){return this.element||(this.element=function(e){return e&&(e.base||1===e.nodeType&&e)||null}(this))},t}(Mn),cr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Ln(t,e);var n=t.prototype;return n.render=function(){return wn("input",{className:nr("time-area")})},n.componentDidMount=function(){var i=this;new Z(this.getElement()).keydown(function(e){e.isToggle||e.inputEvent.stopPropagation()}).keyup(function(e){e.isToggle||e.inputEvent.stopPropagation()}).keyup("enter",function(e){var t=i.getElement().value,n=/(\d+):(\d+):(\d+)/g.exec(t);if(n){var r=60*parseFloat(n[1])+parseFloat(n[2])+parseFloat("0."+n[3]);i.props.setTime(r)}})},t}(ur),lr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={isPlay:!1},e.play=function(){e.setState({isPlay:!0})},e.pause=function(){e.setState({isPlay:!1})},e.unselect=function(){e.props.select("",-1)},e}Ln(e,t);var n=e.prototype;return n.render=function(){return wn("div",{className:nr("control-area header-area")},wn("div",{className:nr("properties-area"),onClick:this.unselect},wn("div",{className:nr("property")})),wn("div",{className:nr("values-area")},wn("div",{className:nr("value")})),wn("div",{className:nr("keyframes-area")},wn("div",{className:nr("keyframes")},wn(cr,{ref:rr(this,"timeArea"),setTime:this.props.setTime}),wn("div",{className:nr("play-control-area")},wn("div",{className:nr("control prev"),onClick:this.props.prev}),wn("div",{className:nr("control "+(this.state.isPlay?"pause":"play")),onClick:this.props.togglePlay}),wn("div",{className:nr("control next"),onClick:this.props.next})))))},n.componentDidMount=function(){this.initScene(this.props.scene)},n.componentDidUpdate=function(e){e.scene!==this.props.scene&&(this.initScene(this.props.scene),this.releaseScene(e.scene))},n.componentWillUnmount=function(){this.releaseScene(this.props.scene)},n.initScene=function(e){e&&e.on({play:this.play,paused:this.pause})},n.releaseScene=function(e){e&&(e.off("play",this.play),e.off("paused",this.pause))},e}(ur),pr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ln(t,e),t.prototype.render=function(){return wn("div",{className:nr("keyframe-cursor"),ref:rr(this,"cursor")})},t}(ur),hr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Ln(t,e);var n=t.prototype;return n.renderKeytimes=function(){for(var e=this.props.maxTime,t=[],n=0;n<=e;++n)t.push(wn("div",{key:n,"data-time":n,className:nr("keytime"),style:{width:100/e+"%"}},wn("span",null,n),wn("div",{className:nr("graduation start")}),wn("div",{className:nr("graduation quarter")}),wn("div",{className:nr("graduation half")}),wn("div",{className:nr("graduation quarter3")})));return t},n.render=function(){var e=this.props,t=e.maxTime,n=e.maxDuration,r=e.zoom;return wn("div",{className:nr("keytimes-area keyframes-area")},wn("div",{className:nr("keyframes-scroll-area"),ref:rr(this,"scrollAreaElement"),style:{minWidth:50*t+"px",width:Math.min(n?t/n:1,2)*r*100+"%"}},wn("div",{className:nr("keytimes keyframes")},wn("div",{className:nr("keyframes-container")},this.renderKeytimes()),wn(pr,{ref:rr(this,"cursor")}))))},n.componentDidMount=function(){var n=this;U(this.getElement(),"wheel",function(e){var t=e.deltaY;n.props.axes.setBy({zoom:t/5e3}),e.deltaX||e.preventDefault()}),G(this.cursor.getElement(),{dragstart:function(e){e.inputEvent.stopPropagation()},drag:function(e){var t=e.clientX;n.props.move(t)},container:window})},t}(ur),fr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.add=function(){e.props.scene||e.props.add()},e}return Ln(e,t),e.prototype.render=function(){var e=this.props,t=e.axes,n=e.timelineInfo,r=e.maxTime,i=e.maxDuration,o=e.zoom,a=e.move;return wn("div",{className:nr("header-area")},wn("div",{className:nr("properties-area")},wn("div",{className:nr("property")},"Name")),wn("div",{className:nr("values-area")},wn("div",{className:nr("value")},wn("div",{className:nr("add"),onClick:this.add},"+"))),wn(hr,{ref:rr(this,"keytimesArea"),move:a,axes:t,timelineInfo:n,maxDuration:i,maxTime:r,zoom:o}))},e}(ur),dr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ln(t,e),t.prototype.render=function(){var e=this.props,t=e.time,n=e.value,r=e.maxTime;return wn("div",{className:nr("keyframe"+(e.selected?" select":"")),"data-time":t,style:{left:t/r*100+"%"}},t," ",n)},t}(ur),mr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ln(t,e),t.prototype.render=function(){var e=this.props,t=e.time,n=e.nextTime,r=e.maxTime;return wn("div",{className:nr("keyframe-group"+(e.selected?" select":"")),"data-time":t,style:{left:t/r*100+"%",width:(n-t)/r*100+"%"}})},t}(zn),vr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ln(t,e),t.prototype.render=function(){var e=this.props,t=e.time,n=e.nextTime,r=e.maxTime;return wn("div",{className:nr("keyframe-delay"),style:{left:t/r*100+"%",width:(n-t)/r*100+"%"}})},t}(zn),gr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ln(t,e),t.prototype.render=function(){var e=this.props,t=e.time,n=e.nextTime,r=e.maxTime;return wn("div",{className:nr("keyframe-line"),style:{left:t/r*100+"%",width:(n-t)/r*100+"%"}})},t}(zn),yr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Ln(t,e);var n=t.prototype;return n.render=function(){var e=this.props,t=e.id,n=e.propertiesInfo,r=e.selected;return wn("div",{className:nr("keyframes"+(1===e.folded?" fold":"")+(r?" select":"")),"data-item":n.isItem?"1":"0","data-id":t},wn("div",{className:nr("keyframes-container")},this.renderList()))},n.renderList=function(){var e=this.props,t=e.propertiesInfo,h=e.maxTime,f=e.selected,d=e.selectedTime,n=t.item,m=t.frames,r=t.properties,v=er(n),g=n.getDuration(),y=[],i=[],b=[],x=[],o=m.length,k=r.length,w=0;if(2<=o&&!k){var a=W(m,function(e){return!T(e[2])});w=Math.min(o-2,Math.max(0===m[0][1]&&0===m[1][1]?1:0,a));var s=m[w],u=m[o-1],c=s[0],l=u[0];i.push(wn(mr,{key:"group",id:c+","+l,selected:f&&c<=d&&d<=l,time:c,nextTime:l,maxTime:h}))}return m.forEach(function(e,t){var n=e[0],r=e[1],i=e[2],o=Gn(i);if(m[t+1]){var a=m[t+1],s=a[0],u=a[1];(0===r&&0===u||r===g&&u===g)&&b.push(wn(vr,{key:"delay"+n+","+s,id:"-1",time:n,nextTime:s,maxTime:h}))}if(0!==t||0!==n||0!==r||!T(i)||k){if(m[t+1]){var c=m[t+1],l=(s=c[0],c[2]),p=Gn(l);v||T(i)||T(l)||o===p||!k||x.push(wn(gr,{key:"line"+x.length,time:n,id:n+","+s,nextTime:s,maxTime:h}))}v||t<w||y.push(wn(dr,{key:"keyframe"+t,id:""+n,selected:f&&n===d,time:n,iterationTime:r,value:o,maxTime:h}))}}),i.concat(y,b,x)},t}(ur),br=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.keyframesList=[],e.state={foldedInfo:{}},e}Ln(e,t);var n=e.prototype;return n.render=function(){var e=this.props,t=e.timelineInfo,n=e.maxTime,r=e.maxDuration,i=e.zoom,o=e.selectedProperty,a=e.selectedTime,s=this.state.foldedInfo,u=Math.min(r?n/r:1,2),c=[];for(var l in this.keyframesList=[],t){var p=t[l],h=l===o,f=or(s,p.keys);c.push(wn(yr,{ref:ir(this,"keyframesList",c.length),selected:h,folded:f,selectedTime:a,key:l,id:l,propertiesInfo:p,maxTime:n}))}return wn("div",{className:nr("keyframes-area")},wn("div",{className:nr("keyframes-scroll-area"),ref:rr(this,"scrollAreaElement"),style:{minWidth:50*n+"px",width:u*i*100+"%"}},c.concat([wn(pr,{key:"cursor",ref:rr(this,"cursor")}),wn(sr,{maxTime:n,key:"lines"})])))},n.componentDidMount=function(){var n=this;U(this.getElement(),"wheel",function(e){if(n.props.keycon.altKey){e.preventDefault();var t=e.deltaY;n.props.axes.setBy({zoom:t/5e3})}})},e}(ur),xr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ln(t,e),t.prototype.render=function(){var e=this.props,t=e.id,n=e.selected,r=e.folded,i=e.propertiesInfo,o=i.keys,a=i.isItem,s=i.isParent,u=o.length,c=o[u-1];return wn("div",{className:nr("property"+(1===r?" fold":"")+(n?" select":"")),"data-id":t,"data-name":c,"data-object":s?1:0,"data-item":a?1:0,"data-fold":2===r?1:0,style:{paddingLeft:10+20*(u-1)+"px"}},wn("div",{className:nr("arrow")}),wn("span",null,c),wn("div",{className:nr("remove")}))},t}(ur),kr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.properties=[],e.state={foldedInfo:{}},e}return Ln(e,t),e.prototype.render=function(){var e=this.props,t=e.timelineInfo,n=e.selectedProperty,r=this.state.foldedInfo,i=[];for(var o in this.properties=[],t){var a=t[o],s=n===o,u=or(r,a.keys);i.push(wn(xr,{ref:ir(this,"properties",i.length),selected:s,folded:u,key:o,id:o,propertiesInfo:a}))}return wn("div",{className:nr("properties-area")},wn("div",{className:nr("properties-scroll-area")},i))},e}(ur),wr=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.add=function(){var e=r.props,t=e.add,n=e.propertiesInfo;t(n.item,n.properties)},r}Ln(t,e);var n=t.prototype;return n.render=function(){var e=this.props,t=e.id,n=e.selected,r=e.folded,i=e.propertiesInfo,o=i.isItem,a=i.isParent;return wn("div",{className:nr("value"+(1===r?" fold":"")+(n?" select":"")),"data-id":t,"data-object":a?1:0,"data-item":o?1:0},this.renderValue())},n.renderValue=function(){return this.props.propertiesInfo.isParent?wn("div",{className:nr("add"),onClick:this.add},"+"):wn("input",{ref:rr(this,"inputElement")})},t}(ur),_r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.values=[],e.state={foldedInfo:{}},e}Ln(e,t);var n=e.prototype;return n.render=function(){var e=this.props,t=e.timelineInfo,n=e.selectedProperty,r=e.add,i=this.state.foldedInfo,o=[];for(var a in this.values=[],t){var s=t[a],u=n===a,c=or(i,s.keys);o.push(wn(wr,{ref:ir(this,"values",o.length),add:r,key:a,folded:c,selected:u,id:a,propertiesInfo:s}))}return wn("div",{className:nr("values-area")},o)},n.componentDidMount=function(){var n,r,i=this,e=this.getElement();e.addEventListener("focusout",function(e){i.props.setTime()}),G(e,{container:window,dragstart:function(e){if(n=e.inputEvent.target,r=n.value,!i.props.keycon.altKey||!Qn(n,function(e){return"INPUT"===e.nodeName}))return!1},drag:function(t){var e=r.replace(/-?\d+/g,function(e){return""+(parseFloat(e)+Math.round(t.distX/2))});n.value=e},dragend:function(e){i.edit(n,n.value)}}),new Z(e).keydown(function(e){e.isToggle||e.inputEvent.stopPropagation()}).keyup(function(e){e.isToggle||e.inputEvent.stopPropagation()}).keyup("enter",function(e){var t=e.inputEvent.target;i.edit(t,t.value)}).keyup("esc",function(e){e.inputEvent.target.blur()})},n.edit=function(e,t){var n=Qn(e,function(e){return Jn(e,"value")});if(n){console.log(e,t);var r=W(this.values,function(e){return e.getElement()===n});-1!==r&&this.props.editKeyframe(r,t)}},e}(ur),Tr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Ln(t,e);var n=t.prototype;return n.render=function(){var e=this.props,t=e.axes,n=e.keycon,r=e.zoom,i=e.maxDuration,o=e.maxTime,a=e.timelineInfo,s=e.selectedProperty,u=e.selectedTime,c=e.add,l=e.setTime,p=e.editKeyframe;return wn("div",{className:nr("scroll-area")},wn(kr,{ref:rr(this,"propertiesArea"),timelineInfo:a,selectedProperty:s}),wn(_r,{ref:rr(this,"valuesArea"),add:c,keycon:n,setTime:l,editKeyframe:p,timelineInfo:a,selectedProperty:s}),wn(br,{ref:rr(this,"keyframesArea"),axes:t,keycon:n,zoom:r,maxDuration:i,timelineInfo:a,maxTime:o,selectedProperty:s,selectedTime:u}))},n.componentDidMount=function(){this.initClickProperty(),this.foldAll()},n.foldAll=function(){var o=this;this.propertiesArea.properties.forEach(function(e,t){var n=e.props.propertiesInfo,r=n.keys,i=n.isParent;1===r.length&&i&&o.fold(t)})},n.fold=function(e,t){var n=this.propertiesArea.properties[e].props.id;ar(this.propertiesArea,n,t),ar(this.valuesArea,n,t),ar(this.keyframesArea,n,t)},n.removeProperty=function(e){var t=e.key,n=e.isItem,r=e.parentItem,i=e.item,o=e.properties;if(n){var a=null;r.forEach(function(e,t){e!==i||(a=t)}),null!=a&&r.removeItem(a)}else{i.times.forEach(function(e){var t;(t=i).remove.apply(t,[e].concat(o))})}this.props.selectedProperty===t&&this.props.select("",-1,!0),this.props.update()},n.initClickProperty=function(){var s=this;this.propertiesArea.getElement().addEventListener("click",function(e){var t=Qn(e.target,function(e){return Jn(e,"arrow")}),n=Qn(e.target,function(e){return Jn(e,"remove")}),r=Qn(e.target,function(e){return Jn(e,"property")});if(r){var i=s.propertiesArea.properties,o=s.propertiesArea.properties.map(function(e){return e.getElement()}).indexOf(r);if(-1!==o){var a=i[o];n?s.removeProperty(a.props.propertiesInfo):(s.props.select(a.props.id),t&&s.fold(o))}}})},t}(ur),Pr=0,Er=-1,Cr=-1;function Ar(e,t,n,r,i){var o=Date.now?Date.now():(new Date).getTime();e||(Er===n&&Cr===r&&o-Pr<=500&&i(t,n,r),Er=n,Cr=r,Pr=o)}var Nr=1e6;function Sr(e){return Math.round(e*Nr)/Nr}function Or(e,t,n){var r=e[e.length-1];r&&r[0]===t&&r[1]===n||e.push([Sr(t),Sr(n)])}function Ir(e,t){if(!e.length)return[];var x=e.map(function(e){return[e,e]}),k=[];return 0!==x[0][0]&&t[t.length-1][qn]&&x.unshift([0,0]),t.forEach(function(e){for(var t,n,r=e[Yn],i=e[qn],o=e[Hn],a=e[Xn],s=Math.ceil(r),u=x[x.length-1][0],c=x.length,l=u*r,p=0;p<s;++p)for(var h=a===Vn||a===Bn&&p%2||a===$n&&!(p%2),f=0;f<c;++f){var d=x[h?c-f-1:f],m=d[1],v=u*p+(h?u-d[0]:d[0]),g=x[h?c-f:f-1];if(l<v){if(0!==f){var y=u*p+(h?u-g[0]:g[0]),b=(g[1]*(n=v-l)+m*(t=l-y))/(t+n);Or(k,(i+u*r)/o,b)}break}if(v===l&&k.length&&k[k.length-1][0]===l+i)break;Or(k,(i+v)/o,m)}i&&k.unshift([0,k[0][1]]),x=k,k=[]}),x}function Dr(e){var c={};return function t(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=n.length,i=n[r-1],o=n.slice(1).map(function(e){return e.getId()});if(er(i)){if(o.length){var a=o.join("///"),s=Ir([0,i.getDuration()],n.slice(1).map(function(e){return e.state}).reverse()),u=[];s.forEach(function(e){var t=e[0],n=e[1];u.push([t,n,n])}),c[a]={key:a,keys:o,isItem:!0,isParent:!0,parentItem:n[r-2],item:i,names:[],properties:[],frames:u}}i.forEach(function(e){t.apply(void 0,n.concat([e]))})}else!function(l,e,p,h){h.update();var t=h.times.slice(),n=h.getDuration();h.getFrame(0)||t.unshift(0),h.getFrame(n)||t.push(n);var f=Ir(t,e.slice(1).map(function(e){return e.state}).reverse()),d=e[e.length-2];!function e(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=[],r=K(t),a=0===i.length;f.forEach(function(e){var t=e[0],n=e[1],r=h.get.apply(h,[n].concat(i));T(r)&&i.length||o.push([t,n,r])});var s=p.concat(i),u=s.join("///");if(u&&(l[u]={key:u,keys:s,parentItem:d,isParent:r,isItem:a,item:h,names:p,properties:i,frames:o}),r)for(var c in t)e.apply(void 0,[t[c]].concat(i,[c]))}(h.names)}(c,n,o,i)}(e),c}var zr=!1,Mr=function(t){function e(e){var u=t.call(this,e)||this;return u.state={alt:!1,zoom:1,maxDuration:0,maxTime:0,timelineInfo:{},selectedProperty:"",selectedTime:-1,init:!1},u.isExportCSS=!1,u.update=function(e){void 0===e&&(e=!1);var t=u.props.scene;if(t){var n=Math.ceil(t.getDuration()),r=Math.max(u.state.maxTime,n),i=u.state.maxTime,o=u.axes.get(["zoom"]).zoom,a=1<i?r/i:1,s=Math.max(1,o*a);u.setState({timelineInfo:Dr(t),maxTime:r,maxDuration:n,init:e}),u.axes.axm.set({zoom:s})}},u.prev=function(){var e=u.props.scene;e&&u.setTime(e.getTime()-.05)},u.next=function(){var e=u.props.scene;e&&u.setTime(e.getTime()+.05)},u.finish=function(){var e=u.props.scene;e&&e.finish()},u.togglePlay=function(){var e=u.props.scene;e&&("running"===e.getPlayState()?e.pause():e.play())},u.add=function(e,t){void 0===e&&(e=u.props.scene),void 0===t&&(t=[]),er(e)?u.newItem(e):u.newProperty(e,t)},u.getDistTime=function(e,t){void 0===t&&(t=u.scrollArea.keyframesArea.scrollAreaElement.getBoundingClientRect());var n=t.width-30,r=Math.min(n,e)/n,i=u.state.maxTime*r;return Math.round(20*i)/20},u.setTime=function(e){var t=u.props.scene;if(t){var n=t.getDirection();t.pause(),T(e)&&(e=t.getTime()),"normal"===n||"alternate"===n?t.setTime(e):t.setTime(t.getDuration()-e)}},u.getTime=function(e){var t=u.scrollArea.keyframesArea.scrollAreaElement.getBoundingClientRect(),n=t.left+15,r=Math.max(e-n,0);return u.getDistTime(r,t)},u.move=function(e){u.setTime(u.getTime(e))},u.select=function(e,t,n){void 0===t&&(t=-1);var r=u.props.scene;r&&(r.pause(),n?(u.state.selectedProperty=e,u.state.selectedTime=-1):u.setState({selectedProperty:e,selectedTime:t}))},u.editKeyframe=function(e,t){var n=u.scrollArea.propertiesArea.properties[e].props.propertiesInfo;if(!n.isParent){var r=n.item,i=n.properties;r.set.apply(r,[r.getIterationTime()].concat(i,[t])),u.update()}},u.animate=function(e){var t=e.time,n=Zn(Math.floor(t/60),2),r=Zn(Math.floor(t%60),2),i=Zn(Math.floor(t%1*100),3,!0);u.moveCursor(t),u.setInputs(function e(t,n){for(var r in void 0===n&&(n={}),t){var i=t[r];if(K(i)){var o=e(i.constructor.prototype.toCSS?i.get():i);for(var a in o)n[r+"///"+a]=o[a]}else n[r]=i}return n}(e.frames||e.frame.get())),u.controlArea.timeArea.getElement().value=n+":"+r+":"+i},zr&&(zr=!0,u.isExportCSS=!0),u.state=Rn({},u.state,u.initScene(u.props.scene,!1)),u.keycon=(new Z).keydown("alt",function(){u.setState({alt:!0})}).keyup("alt",function(){u.setState({alt:!1})}),u.axes=new Gt({zoom:{range:[1,1/0]}},{},{zoom:1}),u}Ln(e,t);var n=e.prototype;return n.render=function(){var e=this.props,t=e.scene,n=e.className,r=(e.keyboard,e.onSelect,function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n}(e,["scene","className","keyboard","onSelect"])),i=this.state,o=i.zoom,a=i.alt,s=i.maxDuration,u=i.maxTime,c=i.timelineInfo,l=i.selectedProperty,p=i.selectedTime;return wn("div",Rn({className:nr("timeline"+(a?" alt":""))+(n?" "+n:"")},r),this.renderStyle(),wn(lr,{ref:rr(this,"controlArea"),scene:t,select:this.select,prev:this.prev,next:this.next,setTime:this.setTime,togglePlay:this.togglePlay}),wn(fr,{ref:rr(this,"headerArea"),scene:t,add:this.add,axes:this.axes,move:this.move,maxDuration:s,zoom:o,maxTime:u,timelineInfo:c}),wn(Tr,{ref:rr(this,"scrollArea"),add:this.add,setTime:this.setTime,editKeyframe:this.editKeyframe,keycon:this.keycon,axes:this.axes,maxDuration:s,zoom:o,maxTime:u,update:this.update,select:this.select,selectedProperty:l,selectedTime:p,timelineInfo:c}))},n.componentDidMount=function(){this.initWheelZoom(),this.initScroll(),this.initDragKeyframes(),this.initKeyController()},n.componentDidUpdate=function(e,t){if(this.props.onSelect&&t.selectedProperty!==this.state.selectedProperty){var n=t.selectedProperty,r=t.selectedTime,i=this.state,o=i.selectedProperty,a=i.selectedTime,s=this.state.timelineInfo[o];this.props.onSelect({selectedItem:o?s.item:this.props.scene,selectedProperty:o,selectedTime:a,prevSelectedProperty:n,prevSelectedTime:r})}this.state.init&&(this.state.init=!1,this.scrollArea.foldAll()),e.scene!==this.props.scene?(this.releaseScene(e.scene),this.setState(this.initScene(this.props.scene,!0))):this.setTime()},n.renderStyle=function(){if(!this.isExportCSS)return wn("style",null,Fn)},n.newItem=function(e){var t=prompt("Add Item");t&&(e.newItem(t),this.update())},n.newProperty=function(e,t){var n=prompt("Add Property");n&&(e.set.apply(e,[e.getIterationTime()].concat(t,[n,""])),this.update())},n.moveCursor=function(e){var t=this.state.maxTime,n="calc("+100*e/t+"% + "+(15-30*e/t)+"px)";this.scrollArea.keyframesArea.cursor.getElement().style.left=n,this.headerArea.keytimesArea.cursor.getElement().style.left=n},n.setInputs=function(e){var t=this.scrollArea.valuesArea.getElement();for(var n in e)t.querySelector('[data-id="'+n+'"] input').value=e[n]},n.removeKeyframe=function(e){var t=this.state.timelineInfo[e];if(e&&t&&!er(t.item)){var n=t.properties,r=t.item;r.remove.apply(r,[r.getIterationTime()].concat(n)),this.update()}},n.addKeyframe=function(e,t){var n=this.scrollArea.keyframesArea.keyframesList[e].props.id;this.select(n,t);var r=this.scrollArea.valuesArea.values[e].inputElement;r&&this.editKeyframe(e,r.value)},n.initScene=function(e,t){if(!e)return{timelineInfo:{},maxTime:0,maxDuration:0,zoom:1,init:!1};e.finish(),e.on("animate",this.animate);var n=Math.ceil(e.getDuration());return{timelineInfo:Dr(e),maxTime:n,maxDuration:n,zoom:1,init:t||!1}},n.releaseScene=function(e){e&&e.off("animate",this.animate)},n.initWheelZoom=function(){var t=this,e=this.scrollArea.getElement(),n=this.axes;(Un||Wn)&&n.connect("zoom",new nn(e,{scale:.1,hammerManagerOptions:{touchAction:"auto"}})),n.on("hold",function(e){e.inputEvent&&e.inputEvent.preventDefault()}),n.on("change",function(e){e.pos.zoom!==t.state.zoom&&(t.setState({zoom:e.pos.zoom}),e.inputEvent&&e.inputEvent.preventDefault())}),this.axes=n},n.initScroll=function(){var e=!1,t=this.headerArea.keytimesArea.getElement(),n=this.scrollArea.keyframesArea.getElement();t.addEventListener("scroll",function(){e?e=!1:(e=!0,n.scrollLeft=t.scrollLeft)}),n.addEventListener("scroll",function(){e?e=!1:(e=!0,t.scrollLeft=n.scrollLeft)})},n.initDragKeyframes=function(){function o(e,t,n){var r=tr(u.scrollArea.keyframesArea.keyframesList.map(function(e){return e.getElement()}),n);-1!==r&&u.addKeyframe(r,u.getTime(t))}var a,s,u=this,e=this.headerArea.keytimesArea.scrollAreaElement,t=this.scrollArea.keyframesArea.scrollAreaElement,c=0;[e,t].forEach(function(e){G(e,{container:window,dragstart:function(e){var t=e.inputEvent;if(s=Qn(t.target,function(e){return Jn(e,"keyframe-group")})){var n=u.scrollArea.propertiesArea.properties,r=Qn(s,function(e){return Jn(e,"keyframes")}).getAttribute("data-id"),i=function(e,t,n){var r=W(e,t);return-1<r?e[r]:n}(n,function(e){return e.props.id===r}).props.propertiesInfo;a=i.item,c=a.getDelay()}},drag:function(e){var t=e.distX,n=e.deltaX,r=e.deltaY,i=e.inputEvent;s?(a.setDelay(Math.max(c+u.getDistTime(t),0)),u.update()):(u.scrollArea.keyframesArea.getElement().scrollLeft-=n,u.scrollArea.getElement().scrollTop-=r,i.preventDefault())},dragend:function(e){var t=e.isDrag,n=e.clientX,r=e.clientY,i=e.inputEvent;a=s=null,c=0,t||function(e,t,n){var r=Qn(e.target,function(e){return Jn(e,"keyframe")}),i=r?parseFloat(r.getAttribute("data-time")||""):u.getTime(t);u.setTime(i);var o=u.scrollArea.keyframesArea.keyframesList,a=tr(o.map(function(e){return e.getElement()}),n);-1<a&&u.select(o[a].props.id,i),e.preventDefault()}(i,n,r),Ar(t,i,n,r,o)}})})},n.initKeyController=function(){var t=this;window.addEventListener("blur",function(){t.setState({alt:!1})}),this.props.keyboard&&this.keycon.keydown("space",function(e){e.inputEvent.preventDefault()}).keydown("left",function(e){t.prev()}).keydown("right",function(e){t.next()}).keyup("backspace",function(){t.removeKeyframe(t.state.selectedProperty)}).keyup("esc",function(){t.finish()}).keyup("space",function(){t.togglePlay()})},e.defaultProps={keyboard:!0},e}(zn),jr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}!function(e,t){function n(){this.constructor=e}rn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e);var n=t.prototype;return n.render=function(){var t=this;return s(Mr,on({},this.props,{ref:function(e){t.timeline=e}}))},n.update=function(e){this.timeline.update(e)},n.prev=function(){this.timeline.prev()},n.next=function(){this.timeline.next()},n.finish=function(){this.timeline.finish()},n.togglePlay=function(){this.timeline.togglePlay()},t}(k);return function(o){function e(e,t,n){void 0===n&&(n={});var r=o.call(this)||this;r.onSelect=function(e){r.trigger("select",e)};var i=document.createElement("div");return function(e,t,n){I(n,e,{},!1,t,!1)}(s(jr,a({ref:function(e){e&&(r.timelineArea=e)},keyboard:!0},n,{scene:e,onSelect:r.onSelect})),i),t.appendChild(i.children[0]),r}return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(e,o),e.prototype.update=function(e){this.timelineArea.update(e)},e}(e)});
//# sourceMappingURL=timeline.pkgd.min.js.map
