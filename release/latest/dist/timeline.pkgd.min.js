/*
Copyright (c) 2019 Daybrush
name: @scenejs/timeline
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/scenejs-timeline.git
version: 0.1.3
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Timeline=e()}(this,function(){"use strict";var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},u=function(){},c={},l=[],p=[];function s(t,e){var n,r,i,o,a=p;for(o=arguments.length;2<o--;)l.push(arguments[o]);for(e&&null!=e.children&&(l.length||l.push(e.children),delete e.children);l.length;)if((r=l.pop())&&void 0!==r.pop)for(o=r.length;o--;)l.push(r[o]);else"boolean"==typeof r&&(r=null),(i="function"!=typeof t)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(i=!1)),i&&n?a[a.length-1]+=r:a===p?a=[r]:a.push(r),n=i;var s=new u;return s.nodeName=t,s.children=a,s.attributes=null==e?void 0:e,s.key=null==e?void 0:e.key,void 0!==c.vnode&&c.vnode(s),s}function E(t,e){for(var n in e)t[n]=e[n];return t}function h(t,e){null!=t&&("function"==typeof t?t(e):t.current=e)}var e="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,f=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,n=[];function o(t){!t._dirty&&(t._dirty=!0)&&1==n.push(t)&&e(i)}function i(){for(var t;t=n.pop();)t._dirty&&L(t)}function P(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function C(t){var e=E({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function A(t){var e=t.parentNode;e&&e.removeChild(t)}function d(t,e,n,r,i){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)h(n,null),h(r,t);else if("class"!==e||i)if("style"===e){if(r&&"string"!=typeof r&&"string"!=typeof n||(t.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var o in n)o in r||(t.style[o]="");for(var o in r)t.style[o]="number"==typeof r[o]&&!1===f.test(o)?r[o]+"px":r[o]}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var a=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),r?n||t.addEventListener(e,m,a):t.removeEventListener(e,m,a),(t._listeners||(t._listeners={}))[e]=r}else if("list"!==e&&"type"!==e&&!i&&e in t){try{t[e]=null==r?"":r}catch(t){}null!=r&&!1!==r||"spellcheck"==e||t.removeAttribute(e)}else{var s=i&&e!==(e=e.replace(/^xlink:?/,""));null==r||!1===r?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof r&&(s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),r):t.setAttribute(e,r))}else t.className=r||""}function m(t){return this._listeners[t.type](c.event&&c.event(t)||t)}var N=[],S=0,v=!1,g=!1;function O(){for(var t;t=N.shift();)t.componentDidMount&&t.componentDidMount()}function I(t,e,n,r,i,o){S++||(v=null!=i&&void 0!==i.ownerSVGElement,g=null!=t&&!("__preactattr_"in t));var a=D(t,e,n,r,o);return i&&a.parentNode!==i&&i.appendChild(a),--S||(g=!1,o||O()),a}function D(t,e,n,r,i){var o=t,a=v;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||i)?t.nodeValue!=e&&(t.nodeValue=e):(o=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(o,t),z(t,!0))),o.__preactattr_=!0,o;var s=e.nodeName;if("function"==typeof s)return function(t,e,n,r){var i=t&&t._component,o=i,a=t,s=i&&t._componentConstructor===e.nodeName,u=s,c=C(e);for(;i&&!u&&(i=i._parentComponent);)u=i.constructor===e.nodeName;i&&u&&(!r||i._component)?(j(i,c,3,n,r),t=i.base):(o&&!s&&(R(o),t=a=null),i=M(e.nodeName,c,n),t&&!i.nextBase&&(i.nextBase=t,a=null),j(i,c,1,n,r),t=i.base,a&&t!==a&&(a._component=null,z(a,!1)));return t}(t,e,n,r);if(v="svg"===s||"foreignObject"!==s&&v,s=String(s),(!t||!P(t,s))&&(o=function(t,e){var n=e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);return n.normalizedNodeName=t,n}(s,v),t)){for(;t.firstChild;)o.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(o,t),z(t,!0)}var u=o.firstChild,c=o.__preactattr_,l=e.children;if(null==c){c=o.__preactattr_={};for(var p=o.attributes,h=p.length;h--;)c[p[h].name]=p[h].value}return!g&&l&&1===l.length&&"string"==typeof l[0]&&null!=u&&void 0!==u.splitText&&null==u.nextSibling?u.nodeValue!=l[0]&&(u.nodeValue=l[0]):(l&&l.length||null!=u)&&function(t,e,n,r,i){var o,a,s,u,c,l=t.childNodes,p=[],h={},f=0,d=0,m=l.length,v=0,g=e?e.length:0;if(0!==m)for(var y=0;y<m;y++){var b=l[y],x=b.__preactattr_;null!=(k=g&&x?b._component?b._component.__key:x.key:null)?(f++,h[k]=b):(x||(void 0!==b.splitText?!i||b.nodeValue.trim():i))&&(p[v++]=b)}if(0!==g)for(y=0;y<g;y++){var k;if(u=e[y],(c=null)!=(k=u.key))f&&void 0!==h[k]&&(c=h[k],h[k]=void 0,f--);else if(d<v)for(o=d;o<v;o++)if(void 0!==p[o]&&(w=a=p[o],T=i,"string"==typeof(_=u)||"number"==typeof _?void 0!==w.splitText:"string"==typeof _.nodeName?!w._componentConstructor&&P(w,_.nodeName):T||w._componentConstructor===_.nodeName)){c=a,p[o]=void 0,o===v-1&&v--,o===d&&d++;break}c=D(c,u,n,r),s=l[y],c&&c!==t&&c!==s&&(null==s?t.appendChild(c):c===s.nextSibling?A(s):t.insertBefore(c,s))}var w,_,T;if(f)for(var y in h)void 0!==h[y]&&z(h[y],!1);for(;d<=v;)void 0!==(c=p[v--])&&z(c,!1)}(o,l,n,r,g||null!=c.dangerouslySetInnerHTML),function(t,e,n){var r;for(r in n)e&&null!=e[r]||null==n[r]||d(t,r,n[r],n[r]=void 0,v);for(r in e)"children"===r||"innerHTML"===r||r in n&&e[r]===("value"===r||"checked"===r?t[r]:n[r])||d(t,r,n[r],n[r]=e[r],v)}(o,e.attributes,c),v=a,o}function z(t,e){var n=t._component;n?R(n):(null!=t.__preactattr_&&h(t.__preactattr_.ref,null),!1!==e&&null!=t.__preactattr_||A(t),y(t))}function y(t){for(t=t.lastChild;t;){var e=t.previousSibling;z(t,!0),t=e}}var b=[];function M(t,e,n){var r,i=b.length;for(t.prototype&&t.prototype.render?(r=new t(e,n),k.call(r,e,n)):((r=new k(e,n)).constructor=t,r.render=x);i--;)if(b[i].constructor===t)return r.nextBase=b[i].nextBase,b.splice(i,1),r;return r}function x(t,e,n){return this.constructor(t,n)}function j(t,e,n,r,i){t._disable||(t._disable=!0,t.__ref=e.ref,t.__key=e.key,delete e.ref,delete e.key,void 0===t.constructor.getDerivedStateFromProps&&(!t.base||i?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r)),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===c.syncComponentUpdates&&t.base?o(t):L(t,1,i)),h(t.__ref,t))}function L(t,e,n,r){if(!t._disable){var i,o,a,s=t.props,u=t.state,c=t.context,l=t.prevProps||s,p=t.prevState||u,h=t.prevContext||c,f=t.base,d=t.nextBase,m=f||d,v=t._component,g=!1,y=h;if(t.constructor.getDerivedStateFromProps&&(u=E(E({},u),t.constructor.getDerivedStateFromProps(s,u)),t.state=u),f&&(t.props=l,t.state=p,t.context=h,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(s,u,c)?g=!0:t.componentWillUpdate&&t.componentWillUpdate(s,u,c),t.props=s,t.state=u,t.context=c),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!g){i=t.render(s,u,c),t.getChildContext&&(c=E(E({},c),t.getChildContext())),f&&t.getSnapshotBeforeUpdate&&(y=t.getSnapshotBeforeUpdate(l,p));var b,x,k=i&&i.nodeName;if("function"==typeof k){var w=C(i);(o=v)&&o.constructor===k&&w.key==o.__key?j(o,w,1,c,!1):(b=o,t._component=o=M(k,w,c),o.nextBase=o.nextBase||d,o._parentComponent=t,j(o,w,0,c,!1),L(o,1,n,!0)),x=o.base}else a=m,(b=v)&&(a=t._component=null),!m&&1!==e||(a&&(a._component=null),x=I(a,i,c,n||!f,m&&m.parentNode,!0));if(m&&x!==m&&o!==v){var _=m.parentNode;_&&x!==_&&(_.replaceChild(x,m),b||(m._component=null,z(m,!1)))}if(b&&R(b),(t.base=x)&&!r){for(var T=t,P=t;P=P._parentComponent;)(T=P).base=x;x._component=T,x._componentConstructor=T.constructor}}for(!f||n?N.push(t):g||t.componentDidUpdate&&t.componentDidUpdate(l,p,y);t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);S||r||O()}}function R(t){var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?R(n):e&&(null!=e.__preactattr_&&h(e.__preactattr_.ref,null),A(t.nextBase=e),b.push(t),y(e)),h(t.__ref,null)}function k(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{},this._renderCallbacks=[]}E(k.prototype,{setState:function(t,e){this.prevState||(this.prevState=this.state),this.state=E(E({},this.state),"function"==typeof t?t(this.state,this.props):t),e&&this._renderCallbacks.push(e),o(this)},forceUpdate:function(t){t&&this._renderCallbacks.push(t),L(this,2)},render:function(){}});var w="object",_="undefined";function T(t){return typeof t===_}function K(t){return t&&typeof t===w}function W(t,e,n){void 0===n&&(n=-1);for(var r=t.length,i=0;i<r;++i)if(e(t[i],i,t))return i;return n}function U(t,e,n,r){t.addEventListener(e,n,r)}function F(t){return void 0===t}var t=function(){var t=function(){function t(){this._eventHandler={},this.options={}}var e=t.prototype;return e.trigger=function(t,e){void 0===e&&(e={});var n=this._eventHandler[t]||[];if(!(0<n.length))return!0;n=n.concat(),e.eventType=t;var r=!1,i=[e],o=0;e.stop=function(){r=!0},e.currentTarget=this;for(var a=arguments.length,s=new Array(2<a?a-2:0),u=2;u<a;u++)s[u-2]=arguments[u];for(1<=s.length&&(i=i.concat(s)),o=0;n[o];o++)n[o].apply(this,i);return!r},e.once=function(i,o){if("object"==typeof i&&F(o)){var t,e=i;for(t in e)this.once(t,e[t]);return this}if("string"==typeof i&&"function"==typeof o){var a=this;this.on(i,function t(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];o.apply(a,n),a.off(i,t)})}return this},e.hasOn=function(t){return!!this._eventHandler[t]},e.on=function(t,e){if("object"==typeof t&&F(e)){var n,r=t;for(n in r)this.on(n,r[n]);return this}if("string"==typeof t&&"function"==typeof e){var i=this._eventHandler[t];F(i)&&(this._eventHandler[t]=[],i=this._eventHandler[t]),i.push(e)}return this},e.off=function(t,e){if(F(t))return this._eventHandler={},this;if(F(e)){if("string"==typeof t)return this._eventHandler[t]=void 0,this;var n,r=t;for(n in r)this.off(n,r[n]);return this}var i,o,a=this._eventHandler[t];if(a)for(i=0;void 0!==(o=a[i]);i++)if(o===e){a=a.splice(i,1);break}return this},t}();return t.VERSION="2.1.2",t}(),X=function(t,e){return(X=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Y,q=(function(t,e){function n(t){if(t&&"object"==typeof t){var e=t.which||t.keyCode||t.charCode;e&&(t=e)}if("number"==typeof t)return a[t];var n,r=String(t);return(n=i[r.toLowerCase()])?n:(n=o[r.toLowerCase()])||(1===r.length?r.charCodeAt(0):void 0)}n.isEventKey=function(t,e){if(t&&"object"==typeof t){var n=t.which||t.keyCode||t.charCode;if(null==n)return!1;if("string"==typeof e){var r;if(r=i[e.toLowerCase()])return r===n;if(r=o[e.toLowerCase()])return r===n}else if("number"==typeof e)return e===n;return!1}};var i=(e=t.exports=n).code=e.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},o=e.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(r=97;r<123;r++)i[String.fromCharCode(r)]=r-32;for(var r=48;r<58;r++)i[r-48]=r;for(r=1;r<13;r++)i["f"+r]=r+111;for(r=0;r<10;r++)i["numpad "+r]=r+96;var a=e.names=e.title={};for(r in i)a[i[r]]=r;for(var s in o)i[s]=o[s]}(Y={exports:{}},Y.exports),Y.exports),H=(q.code,q.codes,q.aliases,q.names);q.title;function B(t,e,n,r){t.addEventListener(e,n,r)}var V={"+":"plus","left command":"meta","right command":"meta"},$={shift:1,ctrl:2,alt:3,meta:4};var Z=function(n){function t(t){void 0===t&&(t=window);var e=n.call(this)||this;return e.ctrlKey=!1,e.altKey=!1,e.shiftKey=!1,e.metaKey=!1,e.clear=function(){e.ctrlKey=!1,e.altKey=!1,e.shiftKey=!1,e.metaKey=!1},e.keydownEvent=function(t){e.triggerEvent("keydown",t)},e.keyupEvent=function(t){e.triggerEvent("keyup",t)},B(t,"blur",e.clear),B(t,"keydown",e.keydownEvent),B(t,"keyup",e.keyupEvent),e}!function(t,e){function n(){this.constructor=t}X(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,n);var e=t.prototype;return e.keydown=function(t,e){return this.addEvent("keydown",t,e)},e.keyup=function(t,e){return this.addEvent("keyup",t,e)},e.addEvent=function(t,e,n){return!function(t){return Array.isArray(t)}(e)?!function(t){return"string"==typeof t}(e)?this.on(t,e):this.on(t+"."+e,n):this.on(t+"."+function(t){var e=t.slice();return e.sort(function(t,e){return($[t]||5)-($[e]||5)}),e}(e).join("."),n),this},e.triggerEvent=function(t,e){this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.altKey=e.altKey,this.metaKey=e.metaKey;var n=function(t){var e=H[t]||"";for(var n in V)e=e.replace(n,V[n]);return e.replace(/\s/g,"")}(e.keyCode),r={key:n,isToggle:"ctrl"===n||"shift"===n||"meta"===n||"alt"===n,inputEvent:e,keyCode:e.keyCode,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey};this.trigger(t,r),this.trigger(t+"."+n,r);var i=function(t,e){var n=[t.shiftKey&&"shift",t.ctrlKey&&"ctrl",t.altKey&&"alt",t.metaKey&&"meta"];return-1===n.indexOf(e)&&n.push(e),n.filter(Boolean)}(e,n);1<i.length&&this.trigger(t+"."+i.join("."),r)},t}(t);function G(t,e){var a=!1,s=0,u=0,c=0,l=0,p={},h=!1,n=e.container,r=void 0===n?t:n,i=e.dragstart,f=e.drag,o=e.dragend,d=e.events,m=void 0===d?["touch","mouse"]:d,v=-1<m.indexOf("touch");function g(t){return t.touches&&t.touches.length?t.touches[0]:t}function y(t){h=!(a=!0);var e=g(t),n=e.clientX,r=e.clientY;c=s=n,l=u=r,!(p={})===(i&&i({datas:p,inputEvent:t,clientX:n,clientY:r}))&&(a=!1),a&&t.preventDefault()}function b(t){if(a){var e=g(t),n=e.clientX,r=e.clientY,i=n-c,o=r-l;(i||o)&&(h=!0,f&&f({datas:p,clientX:n,clientY:r,deltaX:i,deltaY:o,distX:n-s,distY:r-u,inputEvent:t}),c=n,l=r)}}function x(t){a&&(a=!1,o&&o({datas:p,isDrag:h,inputEvent:t,clientX:c,clientY:l,distX:c-s,distY:l-u}))}-1<m.indexOf("mouse")&&(t.addEventListener("mousedown",y),r.addEventListener("mousemove",b),r.addEventListener("mouseup",x)),v&&(t.addEventListener("touchstart",y),r.addEventListener("touchmove",b),r.addEventListener("touchend",x))}function Q(){return(Q=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function J(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function tt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var et,nt="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign,rt=["","webkit","Moz","MS","ms","o"],it="undefined"==typeof document?{style:{}}:document.createElement("div"),ot="function",at=Math.round,st=Math.abs,ut=Date.now;function ct(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<rt.length;){if((r=(n=rt[o])?n+i:e)in t)return r;o++}}et="undefined"==typeof window?{}:window;var lt=ct(it.style,"touchAction"),pt=void 0!==lt;var ht="compute",ft="manipulation",dt="none",mt="pan-x",vt="pan-y",gt=function(){if(!pt)return!1;var e={},n=et.CSS&&et.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(t){return e[t]=!n||et.CSS.supports("touch-action",t)}),e}(),yt="ontouchstart"in et,bt=void 0!==ct(et,"PointerEvent"),xt=yt&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),kt="touch",wt="mouse",_t=25,Tt=1,Pt=4,Et=8,Ct=1,At=2,Nt=4,St=8,Ot=16,It=At|Nt,Dt=St|Ot,zt=It|Dt,Mt=["x","y"],jt=["clientX","clientY"];function Lt(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(void 0!==t.length)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function Rt(t,e){return typeof t===ot?t.apply(e&&e[0]||void 0,e):t}function Kt(t,e){return-1<t.indexOf(e)}var Wt=function(){function t(t,e){this.manager=t,this.set(e)}var e=t.prototype;return e.set=function(t){t===ht&&(t=this.compute()),pt&&this.manager.element.style&&gt[t]&&(this.manager.element.style[lt]=t),this.actions=t.toLowerCase().trim()},e.update=function(){this.set(this.manager.options.touchAction)},e.compute=function(){var e=[];return Lt(this.manager.recognizers,function(t){Rt(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(t){if(Kt(t,dt))return dt;var e=Kt(t,mt),n=Kt(t,vt);return e&&n?dt:e||n?e?mt:vt:Kt(t,ft)?ft:"auto"}(e.join(" "))},e.preventDefaults=function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=Kt(r,dt)&&!gt[dt],o=Kt(r,vt)&&!gt[vt],a=Kt(r,mt)&&!gt[mt];if(i){var s=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(s&&u&&c)return}if(!a||!o)return i||o&&n&It||a&&n&Dt?this.preventSrc(e):void 0}},e.preventSrc=function(t){this.manager.session.prevented=!0,t.preventDefault()},t}();function Ut(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function Ft(t){var e=t.length;if(1===e)return{x:at(t[0].clientX),y:at(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:at(n/e),y:at(r/e)}}function Xt(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:at(t.pointers[n].clientX),clientY:at(t.pointers[n].clientY)},n++;return{timeStamp:ut(),pointers:e,center:Ft(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Yt(t,e,n){n||(n=Mt);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function qt(t,e,n){n||(n=Mt);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}function Ht(t,e){return t===e?Ct:st(t)>=st(e)?t<0?At:Nt:e<0?St:Ot}function Bt(t,e,n){return{x:e/t||0,y:n/t||0}}function Vt(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=Xt(e)),1<i&&!n.firstMultiple?n.firstMultiple=Xt(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=e.center=Ft(r);e.timeStamp=ut(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=qt(s,u),e.distance=Yt(s,u),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};e.eventType!==Tt&&o.eventType!==Pt||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=Ht(e.deltaX,e.deltaY);var c=Bt(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=st(c.x)>st(c.y)?c.x:c.y,e.scale=a?function(t,e){return Yt(e[0],e[1],jt)/Yt(t[0],t[1],jt)}(a.pointers,r):1,e.rotation=a?function(t,e){return qt(e[1],e[0],jt)+qt(t[1],t[0],jt)}(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,a=t.lastInterval||e,s=e.timeStamp-a.timeStamp;if(e.eventType!==Et&&(_t<s||void 0===a.velocity)){var u=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,l=Bt(s,u,c);r=l.x,i=l.y,n=st(l.x)>st(l.y)?l.x:l.y,o=Ht(u,c),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var l=t.element;Ut(e.srcEvent.target,l)&&(l=e.srcEvent.target),e.target=l}function $t(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=e&Tt&&r-i==0,a=e&(Pt|Et)&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,Vt(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function Zt(t){return t.trim().split(/\s+/g)}function Gt(e,t,n){Lt(Zt(t),function(t){e.addEventListener(t,n,!1)})}function Qt(e,t,n){Lt(Zt(t),function(t){e.removeEventListener(t,n,!1)})}function Jt(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||window}var te=function(){function t(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){Rt(e.options.enable,[e])&&n.handler(t)},this.init()}var e=t.prototype;return e.handler=function(){},e.init=function(){this.evEl&&Gt(this.element,this.evEl,this.domHandler),this.evTarget&&Gt(this.target,this.evTarget,this.domHandler),this.evWin&&Gt(Jt(this.element),this.evWin,this.domHandler)},e.destroy=function(){this.evEl&&Qt(this.element,this.evEl,this.domHandler),this.evTarget&&Qt(this.target,this.evTarget,this.domHandler),this.evWin&&Qt(Jt(this.element),this.evWin,this.domHandler)},t}();function ee(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}var ne={pointerdown:Tt,pointermove:2,pointerup:Pt,pointercancel:Et,pointerout:Et},re={2:kt,3:"pen",4:wt,5:"kinect"},ie="pointerdown",oe="pointermove pointerup pointercancel";et.MSPointerEvent&&!et.PointerEvent&&(ie="MSPointerDown",oe="MSPointerMove MSPointerUp MSPointerCancel");var ae=function(n){function r(){var t,e=r.prototype;return e.evEl=ie,e.evWin=oe,(t=n.apply(this,arguments)||this).store=t.manager.session.pointerEvents=[],t}return J(r,n),r.prototype.handler=function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=ne[r],o=re[t.pointerType]||t.pointerType,a=o===kt,s=ee(e,t.pointerId,"pointerId");i&Tt&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):i&(Pt|Et)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))},r}(te);function se(t){return Array.prototype.slice.call(t,0)}var ue={touchstart:Tt,touchmove:2,touchend:Pt,touchcancel:Et},ce=function(e){function n(){var t;return n.prototype.evTarget="touchstart touchmove touchend touchcancel",(t=e.apply(this,arguments)||this).targetIds={},t}return J(n,e),n.prototype.handler=function(t){var e=ue[t.type],n=function(t,e){var n,r,i=se(t.touches),o=this.targetIds;if(e&(2|Tt)&&1===i.length)return o[i[0].identifier]=!0,[i,i];var a=se(t.changedTouches),s=[],u=this.target;if(r=i.filter(function(t){return Ut(t.target,u)}),e===Tt)for(n=0;n<r.length;)o[r[n].identifier]=!0,n++;n=0;for(;n<a.length;)o[a[n].identifier]&&s.push(a[n]),e&(Pt|Et)&&delete o[a[n].identifier],n++;return s.length?[function(t,n,e){for(var r=[],i=[],o=0;o<t.length;){var a=n?t[o][n]:t[o];ee(i,a)<0&&r.push(t[o]),i[o]=a,o++}return e&&(r=n?r.sort(function(t,e){return t[n]>e[n]}):r.sort()),r}(r.concat(s),"identifier",!0),s]:void 0}.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:kt,srcEvent:t})},n}(te);var le={mousedown:Tt,mousemove:2,mouseup:Pt},pe=function(n){function r(){var t,e=r.prototype;return e.evEl="mousedown",e.evWin="mousemove mouseup",(t=n.apply(this,arguments)||this).pressed=!1,t}return J(r,n),r.prototype.handler=function(t){var e=le[t.type];e&Tt&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=Pt),this.pressed&&(e&Pt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:wt,srcEvent:t}))},r}(te),he=2500,fe=25;function de(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY},r=this.lastTouches;this.lastTouches.push(n);setTimeout(function(){var t=r.indexOf(n);-1<t&&r.splice(t,1)},he)}}var me=function(){return function(n){function t(t,e){var o;return(o=n.call(this,t,e)||this).handler=function(t,e,n){var r=n.pointerType===kt,i=n.pointerType===wt;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)(function(t,e){t&Tt?(this.primaryTouch=e.changedPointers[0].identifier,de.call(this,e)):t&(Pt|Et)&&de.call(this,e)}).call(tt(tt(o)),e,n);else if(i&&function(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=fe&&a<=fe)return!0}return!1}.call(tt(tt(o)),n))return;o.callback(t,e,n)}},o.touch=new ce(o.manager,o.handler),o.mouse=new pe(o.manager,o.handler),o.primaryTouch=null,o.lastTouches=[],o}return J(t,n),t.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},t}(te)}();function ve(t,e,n){return!!Array.isArray(t)&&(Lt(t,n[e],n),!0)}var ge=1;function ye(t,e){var n=e.manager;return n?n.get(t):t}function be(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}var xe=function(){function t(t){void 0===t&&(t={}),this.options=Q({enable:!0},t),this.id=ge++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var e=t.prototype;return e.set=function(t){return nt(this.options,t),this.manager&&this.manager.touchAction.update(),this},e.recognizeWith=function(t){if(ve(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=ye(t,this)).id]||(e[t.id]=t).recognizeWith(this),this},e.dropRecognizeWith=function(t){return ve(t,"dropRecognizeWith",this)||(t=ye(t,this),delete this.simultaneous[t.id]),this},e.requireFailure=function(t){if(ve(t,"requireFailure",this))return this;var e=this.requireFail;return-1===ee(e,t=ye(t,this))&&(e.push(t),t.requireFailure(this)),this},e.dropRequireFailure=function(t){if(ve(t,"dropRequireFailure",this))return this;t=ye(t,this);var e=ee(this.requireFail,t);return-1<e&&this.requireFail.splice(e,1),this},e.hasRequireFailures=function(){return 0<this.requireFail.length},e.canRecognizeWith=function(t){return!!this.simultaneous[t.id]},e.emit=function(e){var n=this,t=this.state;function r(t){n.manager.emit(t,e)}t<8&&r(n.options.event+be(t)),r(n.options.event),e.additionalEvent&&r(e.additionalEvent),8<=t&&r(n.options.event+be(t))},e.tryEmit=function(t){if(this.canEmit())return this.emit(t);this.state=32},e.canEmit=function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},e.recognize=function(t){var e=nt({},t);if(!Rt(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},e.process=function(t){},e.getTouchAction=function(){},e.reset=function(){},t}(),ke={domEvents:!1,touchAction:ht,enable:!0,inputTarget:null,inputClass:null,preset:[],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function we(n,r){var i,o=n.element;o.style&&(Lt(n.options.cssProps,function(t,e){i=ct(o.style,e),r?(n.oldCssProps[i]=o.style[i],o.style[i]=t):o.style[i]=n.oldCssProps[i]||""}),r||(n.oldCssProps={}))}var _e=function(){function t(t,e){var n=this;this.options=nt({},ke,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=function(t){var e=t.options.inputClass;return new(e||(bt?ae:xt?ce:yt?me:pe))(t,$t)}(this),this.touchAction=new Wt(this,this.options.touchAction),we(this,!0),Lt(this.options.recognizers,function(t){var e=n.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}var e=t.prototype;return e.set=function(t){return nt(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},e.stop=function(t){this.session.stopped=t?2:1},e.recognize=function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!==i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},e.get=function(t){if(t instanceof xe)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event===t)return e[n];return null},e.add=function(t){if(ve(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),(t.manager=this).touchAction.update(),t},e.remove=function(t){if(ve(t,"remove",this))return this;var e=this.get(t);if(t){var n=this.recognizers,r=ee(n,e);-1!==r&&(n.splice(r,1),this.touchAction.update())}return this},e.on=function(t,e){if(void 0===t||void 0===e)return this;var n=this.handlers;return Lt(Zt(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this},e.off=function(t,e){if(void 0===t)return this;var n=this.handlers;return Lt(Zt(t),function(t){e?n[t]&&n[t].splice(ee(n[t],e),1):delete n[t]}),this},e.emit=function(t,e){this.options.domEvents&&function(t,e){var n=document.createEvent("Event");n.initEvent(t,!0,!0),(n.gesture=e).target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},e.destroy=function(){this.element&&we(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},t}(),Te=function(n){function t(t){return void 0===t&&(t={}),n.call(this,Q({event:"pinch",threshold:0,pointers:2},t))||this}J(t,n);var e=t.prototype;return e.getTouchAction=function(){return[dt]},e.attrTest=function(t){return n.prototype.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},e.emit=function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}n.prototype.emit.call(this,t)},t}(function(e){function t(t){return void 0===t&&(t={}),e.call(this,Q({pointers:1},t))||this}J(t,e);var n=t.prototype;return n.attrTest=function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},n.process=function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(n&Et||!i)?16|e:r||i?n&Pt?8|e:2&e?4|e:2:32},t}(xe)),Pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};var Ee,Ce=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Ee="undefined"==typeof window?{}:window;var Ae=1e5,Ne=function(){if("undefined"==typeof document)return"";for(var t=(document.head||document.getElementsByTagName("head")[0]).style,e=["transform","webkitTransform","msTransform","mozTransform"],n=0,r=e.length;n<r;n++)if(e[n]in t)return e[n];return""}();function Se(t){for(var e=[],n=0,r=t.length;n<r;n++)e.push(t[n]);return e}var Oe=Ee.requestAnimationFrame||Ee.webkitRequestAnimationFrame,Ie=Ee.cancelAnimationFrame||Ee.webkitCancelAnimationFrame;if(Oe&&!Ie){var De={},ze=Oe;Oe=function(e){var n=ze(function(t){De[n]&&e(t)});return De[n]=!0,n},Ie=function(t){delete De[t]}}else Oe&&Ie||(Oe=function(t){return Ee.setTimeout(function(){t(Ee.performance&&Ee.performance.now&&Ee.performance.now()||(new Date).getTime())},16)},Ie=Ee.clearTimeout);function Me(t){return je(t,function(t){return We(t)})}function je(t,e){var n={};for(var r in t)r&&(n[r]=e(t[r],r));return n}function Le(t,e){var n={};for(var r in t)r&&e(t[r],r)&&(n[r]=t[r]);return n}function Re(t,e){for(var n in t)if(n&&!e(t[n],n))return!1;return!0}function Ke(t,n){return Re(t,function(t,e){return t===n[e]})}function We(t){return Math.round(t*Ae)/Ae}function Ue(t,e,n,r){var i=t,o=[n[0]?e[0]:r?e[0]-r[0]:e[0],n[1]?e[1]:r?e[1]+r[1]:e[1]];return i=Math.max(o[0],i),+We(i=Math.min(o[1],i))}function Fe(t,e){return t<e[0]||t>e[1]}function Xe(t,e,n){return n[1]&&t>e[1]||n[0]&&t<e[0]}function Ye(t,e,n,r){var i=t,o=e[0],a=e[1],s=a-o;return n[1]&&a<t&&(i=(i-a)%s+o),n[0]&&t<o&&(i=(i-o)%s+a),r?i:+We(i)}function qe(t,e,n){return Math.max(Math.min(t,n),e)}var He=function(){function t(t){var e=t.options,n=t.itm,r=t.em,i=t.axm;this.options=e,this.itm=n,this.em=r,this.axm=i,this.animationEnd=this.animationEnd.bind(this)}var e=t.prototype;return e.getDuration=function(n,t,e){var r,i=this;if(void 0!==e)r=e;else{var o=je(t,function(t,e){return function(t,e){var n=Math.sqrt(t/e*2);return n<100?0:n}(Math.abs(t-n[e]),i.options.deceleration)});r=Object.keys(o).reduce(function(t,e){return Math.max(t,o[e])},-1/0)}return qe(r,this.options.minimumDuration,this.options.maximumDuration)},e.createAnimationParam=function(t,e,n){var r=this.axm.get(),i=t,o=n&&n.event||null;return{depaPos:r,destPos:i,duration:qe(e,this.options.minimumDuration,this.options.maximumDuration),delta:this.axm.getDelta(r,i),inputEvent:o,input:n&&n.input||null,isTrusted:!!o,done:this.animationEnd}},e.grab=function(t,e){if(this._animateParam&&t.length){var n=this.axm.get(t),r=this.axm.map(n,function(t,e){return Ye(t,e.range,e.circular,!1)});Re(r,function(t,e){return n[e]===t})||this.em.triggerChange(r,!1,n,e,!!e),this._animateParam=null,this._raf&&function(t){Ie(t)}(this._raf),this._raf=null,this.em.triggerAnimationEnd(!(!e||!e.event))}},e.getEventInfo=function(){return this._animateParam&&this._animateParam.input&&this._animateParam.inputEvent?{input:this._animateParam.input,event:this._animateParam.inputEvent}:null},e.restore=function(t){var e=this.axm.get(),n=this.axm.map(e,function(t,e){return Math.min(e.range[1],Math.max(e.range[0],t))});this.animateTo(n,this.getDuration(e,n),t)},e.animationEnd=function(){var t=this.getEventInfo();this._animateParam=null;var e=this.axm.filter(this.axm.get(),function(t,e){return Xe(t,e.range,e.circular)});0<Object.keys(e).length&&this.setTo(this.axm.map(e,function(t,e){return Ye(t,e.range,e.circular,!1)})),this.itm.setInterrupt(!1),this.em.triggerAnimationEnd(!!t),this.axm.isOutside()?this.restore(t):this.finish(!!t)},e.finish=function(t){this._animateParam=null,this.itm.setInterrupt(!1),this.em.triggerFinish(t)},e.animateLoop=function(a,s){if(a.duration){this._animateParam=Ce({},a);var u=this._animateParam,c=this,l=u.depaPos,p=0,h=je(l,function(t,e){return t<=u.destPos[e]?1:-1}),f=(new Date).getTime();u.startTime=f,function t(){c._raf=null;var e=(new Date).getTime(),n=c.easing((e-u.startTime)/a.duration),r=je(l,function(t,e){return t+u.delta[e]*(n-p)});r=c.axm.map(r,function(t,e,n){var r=Ye(t,e.range,e.circular,!0);return t!==r&&(a.destPos[n]+=-h[n]*(e.range[1]-e.range[0]),l[n]+=-h[n]*(e.range[1]-e.range[0])),r});var i=!c.em.triggerChange(r,!1,Me(l));if(l=r,f=e,1<=(p=n)){var o=a.destPos;return Ke(o,c.axm.get(Object.keys(o)))||c.em.triggerChange(o,!0,Me(l)),void s()}i?c.finish(!1):c._raf=function(t){return Oe(t)}(t)}()}else this.em.triggerChange(a.destPos,!0),s()},e.getUserControll=function(t){var e=t.setTo();return e.destPos=this.axm.get(e.destPos),e.duration=qe(e.duration,this.options.minimumDuration,this.options.maximumDuration),e},e.animateTo=function(t,e,n){var r=this,i=this.createAnimationParam(t,e,n),o=Ce({},i.depaPos),a=this.em.triggerAnimationStart(i),s=this.getUserControll(i);if(!a&&this.axm.every(s.destPos,function(t,e){return Xe(t,e.range,e.circular)})&&console.warn("You can't stop the 'animation' event when 'circular' is true."),a&&!Ke(s.destPos,o)){var u=n&&n.event||null;this.animateLoop({depaPos:o,destPos:s.destPos,duration:s.duration,delta:this.axm.getDelta(o,s.destPos),isTrusted:!!u,inputEvent:u,input:n&&n.input||null},function(){return r.animationEnd()})}},e.easing=function(t){return 1<t?1:this.options.easing(t)},e.setTo=function(t,e){void 0===e&&(e=0);var n=Object.keys(t);this.grab(n);var r=this.axm.get(n);if(Ke(t,r))return this;this.itm.setInterrupt(!0);var i=Le(t,function(t,e){return r[e]!==t});return Object.keys(i).length&&(Ke(i=this.axm.map(i,function(t,e){var n=e.range,r=e.circular;return r&&(r[0]||r[1])?t:Ue(t,n,r)}),r)||(0<e?this.animateTo(i,e):(this.em.triggerChange(i),this.finish(!1)))),this},e.setBy=function(n,t){return void 0===t&&(t=0),this.setTo(je(this.axm.get(Object.keys(n)),function(t,e){return t+n[e]}),t)},t}(),Be=function(){function t(t){this.axes=t}var e=t.prototype;return e.triggerHold=function(t,e){this.axes.trigger("hold",{pos:t,input:e.input||null,inputEvent:e.event||null,isTrusted:!0})},e.triggerRelease=function(t){t.setTo=this.createUserControll(t.destPos,t.duration),this.axes.trigger("release",t)},e.triggerChange=function(t,e,n,r,i){void 0===i&&(i=!1);var o=this.am,a=o.axm,s=o.getEventInfo(),u=a.moveTo(t,e,n),c=r&&r.event||s&&s.event||null,l={pos:u.pos,delta:u.delta,holding:i,inputEvent:c,isTrusted:!!c,input:r&&r.input||s&&s.input||null,set:c?this.createUserControll(u.pos):function(){}},p=this.axes.trigger("change",l);return c&&a.set(l.set().destPos),p},e.triggerAnimationStart=function(t){return t.setTo=this.createUserControll(t.destPos,t.duration),this.axes.trigger("animationStart",t)},e.triggerAnimationEnd=function(t){void 0===t&&(t=!1),this.axes.trigger("animationEnd",{isTrusted:t})},e.triggerFinish=function(t){void 0===t&&(t=!1),this.axes.trigger("finish",{isTrusted:t})},e.createUserControll=function(t,e){void 0===e&&(e=0);var n={destPos:Ce({},t),duration:e};return function(t,e){return t&&(n.destPos=Ce({},t)),void 0!==e&&(n.duration=e),n}},e.setAnimationManager=function(t){this.am=t},e.destroy=function(){this.axes.off()},t}(),Ve=function(){function t(t){this.options=t,this._prevented=!1}var e=t.prototype;return e.isInterrupting=function(){return this.options.interruptable||this._prevented},e.isInterrupted=function(){return!this.options.interruptable&&this._prevented},e.setInterrupt=function(t){this.options.interruptable||(this._prevented=t)},t}(),$e=function(){function t(t,e){var n=this;this.axis=t,this.options=e,this._complementOptions(),this._pos=Object.keys(this.axis).reduce(function(t,e){return t[e]=n.axis[e].range[0],t},{})}var e=t.prototype;return e._complementOptions=function(){var i=this;Object.keys(this.axis).forEach(function(r){i.axis[r]=Ce({range:[0,100],bounce:[0,0],circular:[!1,!1]},i.axis[r]),["bounce","circular"].forEach(function(t){var e=i.axis,n=e[r][t];/string|number|boolean/.test(typeof n)&&(e[r][t]=[n,n])})})},e.getDelta=function(t,e){var n=this.get(t);return je(this.get(e),function(t,e){return t-n[e]})},e.get=function(t){var n=this;return t&&Array.isArray(t)?t.reduce(function(t,e){return e&&e in n._pos&&(t[e]=n._pos[e]),t},{}):Ce({},this._pos,t||{})},e.moveTo=function(n,r,i){void 0===i&&(i=this._pos);var t=je(this._pos,function(t,e){return e in n&&e in i?n[e]-i[e]:0});return this.set(this.map(n,function(t,e){return e?Ye(t,e.range,e.circular,r):0})),{pos:Ce({},this._pos),delta:t}},e.set=function(t){for(var e in t)e&&e in this._pos&&(this._pos[e]=t[e])},e.every=function(t,n){var r=this.axis;return Re(t,function(t,e){return n(t,r[e],e)})},e.filter=function(t,n){var r=this.axis;return Le(t,function(t,e){return n(t,r[e],e)})},e.map=function(t,n){var r=this.axis;return je(t,function(t,e){return n(t,r[e],e)})},e.isOutside=function(t){return!this.every(t?this.get(t):this._pos,function(t,e){return!Fe(t,e.range)})},t}(),Ze=function(){function t(t){var e=t.options,n=t.itm,r=t.em,i=t.axm,o=t.am;this.isOutside=!1,this.moveDistance=null,this.isStopped=!1,this.options=e,this.itm=n,this.em=r,this.axm=i,this.am=o}var e=t.prototype;return e.atOutside=function(t){var a=this;if(this.isOutside)return this.axm.map(t,function(t,e){var n=e.range[0]-e.bounce[0],r=e.range[1]+e.bounce[1];return r<t?r:t<n?n:t});var s=this.am.easing(1e-5)/1e-5;return this.axm.map(t,function(t,e){var n=e.range[0],r=e.range[1],i=e.bounce,o=e.circular;return o&&(o[0]||o[1])?t:t<n?n-a.am.easing((n-t)/(i[0]*s))*i[0]:r<t?r+a.am.easing((t-r)/(i[1]*s))*i[1]:t})},e.get=function(t){return this.axm.get(t.axes)},e.hold=function(t,e){if(!this.itm.isInterrupted()&&t.axes.length){var n={input:t,event:e};this.isStopped=!1,this.itm.setInterrupt(!0),this.am.grab(t.axes,n),this.moveDistance||this.em.triggerHold(this.axm.get(),n),this.isOutside=this.axm.isOutside(t.axes),this.moveDistance=this.axm.get(t.axes)}},e.change=function(t,e,n){if(!this.isStopped&&this.itm.isInterrupting()&&!this.axm.every(n,function(t){return 0===t})){var r,i=this.moveDistance||this.axm.get(t.axes);r=je(i,function(t,e){return t+(n[e]||0)}),this.moveDistance&&(this.moveDistance=r),this.isOutside&&this.axm.every(i,function(t,e){return!Fe(t,e.range)})&&(this.isOutside=!1),i=this.atOutside(i),r=this.atOutside(r),this.em.triggerChange(r,!1,i,{input:t,event:e},!0)||(this.isStopped=!0,this.moveDistance=null,this.am.finish(!1))}},e.release=function(t,e,n,r){if(!this.isStopped&&this.itm.isInterrupting()&&this.moveDistance){var i=this.axm.get(t.axes),o=this.axm.get(),a=this.axm.get(this.axm.map(n,function(t,e,n){return e.circular&&(e.circular[0]||e.circular[1])?i[n]+t:Ue(i[n]+t,e.range,e.circular,e.bounce)})),s=this.am.getDuration(a,i,r);0===s&&(a=Ce({},o));var u={depaPos:o,destPos:a,duration:s,delta:this.axm.getDelta(o,a),inputEvent:e,input:t,isTrusted:!0};this.em.triggerRelease(u),this.moveDistance=null;var c=this.am.getUserControll(u),l=Ke(c.destPos,o),p={input:t,event:e};l||0===c.duration?(l||this.em.triggerChange(c.destPos,!1,o,p,!0),this.itm.setInterrupt(!1),this.axm.isOutside()?this.am.restore(p):this.em.triggerFinish(!0)):this.am.animateTo(c.destPos,c.duration,p)}},t}(),Ge=function(i){function t(t,e,n){void 0===t&&(t={}),void 0===e&&(e={});var r=i.call(this)||this;return r.axis=t,r._inputs=[],r.options=Ce({easing:function(t){return 1-Math.pow(1-t,3)},interruptable:!0,maximumDuration:1/0,minimumDuration:0,deceleration:6e-4},e),r.itm=new Ve(r.options),r.axm=new $e(r.axis,r.options),r.em=new Be(r),r.am=new He(r),r.io=new Ze(r),r.em.setAnimationManager(r.am),n&&r.em.triggerChange(n),r}!function(t,e){function n(){this.constructor=t}Pe(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,i);var e=t.prototype;return e.connect=function(t,e){var n;if(n="string"==typeof t?t.split(" "):t.concat(),~this._inputs.indexOf(e)&&this.disconnect(e),"hammer"in e){var r=this._inputs.filter(function(t){return t.hammer&&t.element===e.element});r.length&&(e.hammer=r[0].hammer)}return e.mapAxes(n),e.connect(this.io),this._inputs.push(e),this},e.disconnect=function(t){if(t){var e=this._inputs.indexOf(t);0<=e&&(this._inputs[e].disconnect(),this._inputs.splice(e,1))}else this._inputs.forEach(function(t){return t.disconnect()}),this._inputs=[];return this},e.get=function(t){return this.axm.get(t)},e.setTo=function(t,e){return void 0===e&&(e=0),this.am.setTo(t,e),this},e.setBy=function(t,e){return void 0===e&&(e=0),this.am.setBy(t,e),this},e.isBounceArea=function(t){return this.axm.isOutside(t)},e.destroy=function(){this.disconnect(),this.em.destroy()},t.VERSION="2.5.13",t.TRANSFORM=Ne,t.DIRECTION_NONE=Ct,t.DIRECTION_LEFT=At,t.DIRECTION_RIGHT=Nt,t.DIRECTION_UP=St,t.DIRECTION_DOWN=Ot,t.DIRECTION_HORIZONTAL=It,t.DIRECTION_VERTICAL=Dt,t.DIRECTION_ALL=zt,t}(t),Qe="PointerEvent"in Ee||"MSPointerEvent"in Ee,Je="ontouchstart"in Ee,tn="_EGJS_AXES_INPUTTYPE_";function en(r,t){return t.reduce(function(t,e,n){return r[n]&&(t[r[n]]=e),t},{})}var nn=function(){function t(t,e){if(this.axes=[],this.hammer=null,this.element=null,this._base=null,this._prev=null,this.pinchRecognizer=null,void 0===_e)throw new Error("The Hammerjs must be loaded before eg.Axes.PinchInput.\nhttp://hammerjs.github.io/");this.element=function e(t,n){var r;if(void 0===n&&(n=!1),"string"==typeof t){if(t.match(/^<([a-z]+)\s*([^>]*)>/)){var i=document.createElement("div");i.innerHTML=t,r=Se(i.childNodes)}else r=Se(document.querySelectorAll(t));n||(r=1<=r.length?r[0]:void 0)}else t===Ee?r=t:!t.nodeName||1!==t.nodeType&&9!==t.nodeType?"jQuery"in Ee&&t instanceof jQuery||t.constructor.prototype.jquery?r=n?t.toArray():t.get(0):Array.isArray(t)&&(r=t.map(function(t){return e(t)}),n||(r=1<=r.length?r[0]:void 0)):r=t;return r}(t),this.options=Ce({scale:1,threshold:0,inputType:["touch","pointer"],hammerManagerOptions:{cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",userDrag:"none"}}},e),this.onPinchStart=this.onPinchStart.bind(this),this.onPinchMove=this.onPinchMove.bind(this),this.onPinchEnd=this.onPinchEnd.bind(this)}var e=t.prototype;return e.mapAxes=function(t){this.axes=t},e.connect=function(t){var e={threshold:this.options.threshold};if(this.hammer)this.removeRecognizer(),this.dettachEvent();else{var n=this.element[tn];n||(n=String(Math.round(Math.random()*(new Date).getTime())));var r=function(t){void 0===t&&(t=[]);var e=!1,n=!1,r=!1;return t.forEach(function(t){switch(t){case"mouse":n=!0;break;case"touch":e=Je;break;case"pointer":r=Qe}}),r?ae:e&&n?me:e?ce:n?pe:null}(this.options.inputType);if(!r)throw new Error("Wrong inputType parameter!");this.hammer=function(t,e){try{return new _e(t,Ce({},e))}catch(t){return null}}(this.element,Ce({inputClass:r},this.options.hammerManagerOptions)),this.element[tn]=n}return this.pinchRecognizer=new Te(e),this.hammer.add(this.pinchRecognizer),this.attachEvent(t),this},e.disconnect=function(){return this.removeRecognizer(),this.hammer&&(this.hammer.remove(this.pinchRecognizer),this.pinchRecognizer=null,this.dettachEvent()),this},e.destroy=function(){this.disconnect(),this.hammer&&0===this.hammer.recognizers.length&&this.hammer.destroy(),delete this.element[tn],this.element=null,this.hammer=null},e.removeRecognizer=function(){this.hammer&&this.pinchRecognizer&&(this.hammer.remove(this.pinchRecognizer),this.pinchRecognizer=null)},e.onPinchStart=function(t){this._base=this.observer.get(this)[this.axes[0]];var e=this.getOffset(t.scale);this.observer.hold(this,t),this.observer.change(this,t,en(this.axes,[e])),this._prev=t.scale},e.onPinchMove=function(t){var e=this.getOffset(t.scale,this._prev);this.observer.change(this,t,en(this.axes,[e])),this._prev=t.scale},e.onPinchEnd=function(t){var e=this.getOffset(t.scale,this._prev);this.observer.change(this,t,en(this.axes,[e])),this.observer.release(this,t,en(this.axes,[0]),0),this._base=null,this._prev=null},e.getOffset=function(t,e){return void 0===e&&(e=1),this._base*(t-e)*this.options.scale},e.attachEvent=function(t){this.observer=t,this.hammer.on("pinchstart",this.onPinchStart).on("pinchmove",this.onPinchMove).on("pinchend",this.onPinchEnd)},e.dettachEvent=function(){this.hammer.off("pinchstart",this.onPinchStart).off("pinchmove",this.onPinchMove).off("pinchend",this.onPinchEnd),this.observer=null,this._prev=null},e.enable=function(){return this.hammer&&(this.hammer.get("pinch").options.enable=!0),this},e.disable=function(){return this.hammer&&(this.hammer.get("pinch").options.enable=!1),this},e.isEnable=function(){return!(!this.hammer||!this.hammer.get("pinch").options.enable)},t}(),rn=function(t,e){return(rn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var on=function(){return(on=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},an="a abbr address area article aside audio b base bdi bdo big blockquote body br button canvas caption cite code col colgroup data datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins kbd keygen label legend li link main map mark menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rp rt ruby s samp script section select small source span strong style sub summary sup table tbody td textarea tfoot th thead time title tr track u ul var video wbr circle clipPath defs ellipse g image line linearGradient mask path pattern polygon polyline radialGradient rect stop svg text tspan".split(" "),sn="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,un="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("__preactCompatWrapper"):"__preactCompatWrapper",cn={constructor:1,render:1,shouldComponentUpdate:1,componentWillReceiveProps:1,componentWillUpdate:1,componentDidUpdate:1,componentWillMount:1,componentDidMount:1,componentWillUnmount:1,componentDidUnmount:1},ln=/^(?:accent|alignment|arabic|baseline|cap|clip|color|fill|flood|font|glyph|horiz|marker|overline|paint|stop|strikethrough|stroke|text|underline|unicode|units|v|vector|vert|word|writing|x)[A-Z]/,pn={},hn=!1;try{hn="production"!==process.env.NODE_ENV}catch(t){}var fn=s("a",null).constructor;fn.prototype.$$typeof=sn,fn.prototype.preactCompatUpgraded=!1,fn.prototype.preactCompatNormalized=!1,Object.defineProperty(fn.prototype,"type",{get:function(){return this.nodeName},set:function(t){this.nodeName=t},configurable:!0}),Object.defineProperty(fn.prototype,"props",{get:function(){return this.attributes},set:function(t){this.attributes=t},configurable:!0});var dn=c.event;c.event=function(t){return dn&&(t=dn(t)),t.persist=Object,t.nativeEvent=t};var mn=c.vnode;c.vnode=function(t){if(!t.preactCompatUpgraded){t.preactCompatUpgraded=!0;var e=t.nodeName,n=t.attributes=null==t.attributes?{}:Pn({},t.attributes);"function"==typeof e?(!0===e[un]||e.prototype&&"isReactComponent"in e.prototype)&&(t.children&&""===String(t.children)&&(t.children=void 0),t.children&&(n.children=t.children),t.preactCompatNormalized||_n(t),function(t){var e=t.nodeName,n=t.attributes;t.attributes={},e.defaultProps&&Pn(t.attributes,e.defaultProps);n&&Pn(t.attributes,n)}(t)):(t.children&&""===String(t.children)&&(t.children=void 0),t.children&&(n.children=t.children),n.defaultValue&&(n.value||0===n.value||(n.value=n.defaultValue),delete n.defaultValue),function(t,e){var n,r,i;if(e){for(i in e)if(n=ln.test(i))break;if(n)for(i in r=t.attributes={},e)e.hasOwnProperty(i)&&(r[ln.test(i)?i.replace(/([A-Z0-9])/,"-$1").toLowerCase():i]=e[i])}}(t,n))}mn&&mn(t)};var vn,gn=[];for(var yn,bn={},xn=an.length;xn--;)bn[an[xn]]=(yn=an[xn],wn.bind(null,yn));function kn(t){return function(t){function e(t,e){!function(t){for(var e in t){var n=t[e];"function"!=typeof n||n.__bound||cn.hasOwnProperty(e)||((t[e]=n.bind(t)).__bound=!0)}}(this),zn.call(this,t,e,pn),Sn.call(this,t,e)}(t=Pn({constructor:e},t)).mixins&&function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=Nn(e[n].concat(t[n]||gn),"getDefaultProps"===n||"getInitialState"===n||"getChildContext"===n))}(t,function(t){for(var e={},n=0;n<t.length;n++){var r=t[n];for(var i in r)r.hasOwnProperty(i)&&"function"==typeof r[i]&&(e[i]||(e[i]=[])).push(r[i])}return e}(t.mixins));t.statics&&Pn(e,t.statics);t.propTypes&&(e.propTypes=t.propTypes);t.defaultProps&&(e.defaultProps=t.defaultProps);t.getDefaultProps&&(e.defaultProps=t.getDefaultProps.call(e));return Cn.prototype=zn.prototype,e.prototype=Pn(new Cn,t),e.displayName=t.displayName||"Component",e}({displayName:t.displayName||t.name,render:function(){return t(this.props,this.context)}})}function wn(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return function t(e,n){for(var r=n||0;r<e.length;r++){var i=e[r];Array.isArray(i)?t(i):!i||"object"!=typeof i||(o=i)&&(o instanceof fn||o.$$typeof===sn)||!(i.props&&i.type||i.attributes&&i.nodeName||i.children)||(e[r]=wn(i.type||i.nodeName,i.props||i.attributes,i.children))}var o}(t,2),_n(s.apply(void 0,t))}function _n(t){t.preactCompatNormalized=!0,function(t){var e=t.attributes||(t.attributes={});Tn.enumerable="className"in e,e.className&&(e.class=e.className);Object.defineProperty(e,"className",Tn)}(t),function(t){return"function"==typeof t&&!(t.prototype&&t.prototype.render)}(t.nodeName)&&(t.nodeName=function(t){var e=t[un];return e?!0===e?t:e:(e=kn(t),Object.defineProperty(e,un,{configurable:!0,value:!0}),e.displayName=t.displayName,e.propTypes=t.propTypes,e.defaultProps=t.defaultProps,Object.defineProperty(t,un,{configurable:!0,value:e}),e)}(t.nodeName));var e=t.attributes.ref,n=e&&typeof e;return!vn||"string"!==n&&"number"!==n||(t.attributes.ref=function(e,n){return n._refProxies[e]||(n._refProxies[e]=function(t){n&&n.refs&&null===(n.refs[e]=t)&&(delete n._refProxies[e],n=null)})}(e,vn)),function(t){var e=t.nodeName,n=t.attributes;if(!n||"string"!=typeof e)return;var r={};for(var i in n)r[i.toLowerCase()]=i;r.ondoubleclick&&(n.ondblclick=n[r.ondoubleclick],delete n[r.ondoubleclick]);if(r.onchange&&("textarea"===e||"input"===e.toLowerCase()&&!/^fil|che|rad/i.test(n.type))){var o=r.oninput||"oninput";n[o]||(n[o]=Nn([n[o],n[r.onchange]]),delete n[r.onchange])}}(t),t}var Tn={configurable:!0,get:function(){return this.class},set:function(t){this.class=t}};function Pn(t){for(var e=arguments,n=1,r=void 0;n<arguments.length;n++)if(r=e[n])for(var i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);return t}function En(t,e){for(var n in t)if(!(n in e))return!0;for(var r in e)if(t[r]!==e[r])return!0;return!1}function Cn(){}function An(t,e,n){if("string"==typeof e&&(e=t.constructor.prototype[e]),"function"==typeof e)return e.apply(t,n)}function Nn(o,a){return function(){for(var t,e=arguments,n=0;n<o.length;n++){var r=An(this,o[n],e);if(a&&null!=r)for(var i in t||(t={}),r)r.hasOwnProperty(i)&&(t[i]=r[i]);else void 0!==r&&(t=r)}return t}}function Sn(t,e){On.call(this,t,e),this.componentWillReceiveProps=Nn([On,this.componentWillReceiveProps||"componentWillReceiveProps"]),this.render=Nn([On,In,this.render||"render",Dn])}function On(t,e){if(t){var n=t.children;if(n&&Array.isArray(n)&&1===n.length&&("string"==typeof n[0]||"function"==typeof n[0]||n[0]instanceof fn)&&(t.children=n[0],t.children&&"object"==typeof t.children&&(t.children.length=1,t.children[0]=t.children)),hn){var r="function"==typeof this?this:this.constructor;this.propTypes||r.propTypes,this.displayName||r.name}}}function In(t){vn=this}function Dn(){vn===this&&(vn=null)}function zn(t,e,n){k.call(this,t,e),this.state=this.getInitialState?this.getInitialState():{},this.refs={},this._refProxies={},n!==pn&&Sn.call(this,t,e)}function Mn(t,e){zn.call(this,t,e)}Pn(zn.prototype=new k,{constructor:zn,isReactComponent:{},replaceState:function(t,e){for(var n in this.setState(t,e),this.state)n in t||delete this.state[n]},getDOMNode:function(){return this.base},isMounted:function(){return!!this.base}}),Cn.prototype=zn.prototype,(Mn.prototype=new Cn).isPureReactComponent=!0,Mn.prototype.shouldComponentUpdate=function(t,e){return En(this.props,t)||En(this.state,e)};var jn=function(t,e){return(jn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Ln(t,e){function n(){this.constructor=t}jn(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Rn=function(){return(Rn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};var Kn="scenejs-editor-",Wn="PointerEvent"in window||"MSPointerEvent"in window,Un="ontouchstart"in window,Fn=("\n.item-info {\n    position: fixed;\n    right: 0;\n    top: 0;\n    width: 200px;\n    background: #000;\n}\n.options-area {\n\n}\n.option-area {\n    position: relative;\n    border-bottom: 1px solid #777;\n    box-sizing: border-box;\n    white-space: nowrap;\n    background: rgba(90, 90, 90, 0.7);\n    font-size: 13px;\n    font-weight: bold;\n    color: #eee;\n    display: flex;\n}\n.option-name, .option-value {\n    width: 50%;\n    height: 30px;\n    line-height: 20px;\n    box-sizing: border-box;\n    padding: 5px;\n}\n.option-name {\n    border-right: 1px solid #999;\n}\n.option-value input {\n    appearance: none;\n    -webkit-appearance: none;\n    outline: none;\n    position: relative;\n    display: block;\n    width: 100%;\n    height: 100%;\n    background: transparent;\n    color: #4af;\n    font-weight: bold;\n    background: none;\n    border: 0;\n    box-sizing: border-box;\n}\n".replace(/\.([^{,\s\d.]+)/g,"."+Kn+"$1"),'\n.timeline * {\n    box-sizing: border-box;\n}\n.timeline {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  font-size: 0;\n  background: #000;\n  display: flex;\n  flex-direction: column;\n}\n.header-area, .scroll-area {\n   width: 100%;\n   position: relative;\n  display: flex;\n  -webkit-align-items: flex-start;\n  align-items: flex-start;\n}\n.header-area {\n  position: relative;\n  z-index: 10;\n  top: 0;\n  height: 30px;\n  min-height: 30px;\n}\n.header-area .keyframes {\n  padding: 0px;\n}\n.header-area .properties-area,\n.header-area .keyframes-area,\n.header-area .values-area,\n.header-area .keyframes-scroll-area {\n    height: 100%;\n}\n.header-area .keyframes-scroll-area {\n    overflow: hidden;\n}\n.header-area .property, .header-area .value, .header-area .keyframes {\n  height: 100%;\n}\n.header-area .property {\n    line-height: 30px;\n}\n.value .add {\n    text-align: center;\n    color: #fff;\n    line-height: 30px;\n    font-weight: bold;\n    font-size: 20px;\n    cursor: pointer;\n}\n.header-area .keyframes-area::-webkit-scrollbar {\n    display: none; // Safari and Chrome\n}\n.header-area .keyframe-cursor {\n    position: absolute;\n    border-top: 10px solid #4af;\n    border-left: 6px solid transparent;\n    border-right: 6px solid transparent;\n    width: 0;\n    height: 0;\n    bottom: 0;\n    top: auto;\n    background: none;\n    cursor: pointer;\n}\n.control-area .keyframes {\n    padding-left: 10px;\n}\n.play-control-area {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n.play-control-area .control {\n    position: relative;\n    display: inline-block;\n    vertical-align: middle;\n    color: white;\n    margin: 0px 15px;\n    cursor: pointer;\n}\n.play {\n    border-left: 14px solid white;\n    border-top: 8px solid transparent;\n    border-bottom: 8px solid transparent;\n}\n.pause {\n    border-left: 4px solid #fff;\n    border-right: 4px solid #fff;\n    width: 14px;\n    height: 16px;\n}\n.prev {\n    border-right: 10px solid white;\n    border-top: 6px solid transparent;\n    border-bottom: 6px solid transparent;\n}\n.prev:before {\n    position: absolute;\n    content: "";\n    width: 3px;\n    height: 10px;\n    top: 0;\n    right: 100%;\n    transform: translate(0, -50%);\n    background: white;\n}\n.next {\n    border-left: 10px solid white;\n    border-top: 6px solid transparent;\n    border-bottom: 6px solid transparent;\n}\n.next:before {\n    position: absolute;\n    content: "";\n    width: 3px;\n    height: 10px;\n    top: 0;\n    transform: translate(0, -50%);\n    background: white;\n}\n.keytime {\n  position: relative;\n  display: inline-block;\n  height: 100%;\n  font-size: 13px;\n  font-weight: bold;\n  color: #777;\n}\n.keytime:last-child {\n  max-width: 0px;\n}\n.keytime span {\n  position: absolute;\n  line-height: 1;\n  bottom: 12px;\n  display: inline-block;\n  transform: translate(-50%);\n  color: #eee;\n}\n.keytime .graduation {\n  position: absolute;\n  bottom: 0;\n  width: 1px;\n  height: 10px;\n  background: #777;\n  transform: translate(-50%);\n}\n.keytime .graduation.half {\n  left: 50%;\n  height: 7px;\n}\n.keytime .graduation.quarter {\n  left: 25%;\n  height: 5px;\n}\n.keytime .graduation.quarter3 {\n  left: 75%;\n  height: 5px;\n}\n.scroll-area {\n  position: relative;\n  width: 100%;\n  height: calc(100% - 60px);\n  overflow: auto;\n}\n.properties-area, .keyframes-area, .values-area {\n  display: inline-block;\n  position: relative;\n  font-size: 16px;\n  overflow: auto;\n}\n\n.properties-area::-webkit-scrollbar, .keyframes-area::-webkit-scrollbar {\n    display: none; // Safari and Chrome\n}\n.properties-area {\n  width: 30%;\n  max-width: 200px;\n  box-sizing: border-box;\n}\n.values-area {\n    width: 50px;\n    min-width: 50px;\n    display: inline-block;\n    border-right: 1px solid #999;\n    box-sizing: border-box;\n}\n.value input {\n    appearance: none;\n    -webkit-appearance: none;\n    outline: none;\n    position: relative;\n    display: block;\n    width: 100%;\n    height: 100%;\n    background: transparent;\n    color: #4af;\n    font-weight: bold;\n    background: none;\n    border: 0;\n    box-sizing: border-box;\n    text-align: center;\n}\n.value {\n\n}\n.alt .value input {\n    cursor: ew-resize;\n}\n.value[data-object="1"] input {\n    display: none;\n}\n.properties-scroll-area {\n  display: inline-block;\n  min-width: 100%;\n}\n.keyframes-area {\n  flex: 1;\n}\n.keyframes-scroll-area {\n  position: relative;\n  min-width: 300px;\n}\n.keyframes, .property, .value {\n  position: relative;\n  height: 30px;\n  line-height: 30px;\n  border-bottom: 1px solid #777;\n  box-sizing: border-box;\n  white-space: nowrap;\n  background: rgba(90, 90, 90, 0.7);\n  z-index: 1;\n}\n\n.property {\n  padding-left: 10px;\n  box-sizing: border-box;\n  font-size: 13px;\n  font-weight: bold;\n  color: #eee;\n}\n.property .remove {\n    position: absolute;\n    display: inline-block;\n    cursor: pointer;\n    width: 18px;\n    height: 18px;\n    top: 0;\n    bottom: 0;\n    right: 10px;\n    margin: auto;\n    border-radius: 50%;\n    border: 2px solid #fff;\n    vertical-align: middle;\n    display: none;\n    margin-left: 10px;\n    box-sizing: border-box;\n}\n.property .remove:before, .property .remove:after {\n    position: absolute;\n    content: "";\n    width: 8px;\n    height: 2px;\n    border-radius: 1px;\n    background: #fff;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    margin: auto;\n}\n.property .remove:before {\n    transform: rotate(45deg);\n}\n.property .remove:after {\n    transform: rotate(-45deg);\n}\n.property:hover .remove {\n    display: inline-block;\n}\n\n[data-item="1"], [data-item="1"] .add {\n    height: 30px;\n    line-height: 30px;\n}\n.time-area {\n    position: absolute;\n    top: 0;\n    left: 10px;\n    font-size: 13px;\n    color: #4af;\n    line-height: 30px;\n    font-weight: bold;\n    height: 100%;\n    line-height: 30px;\n    border: 0;\n    background: transparent;\n    outline: 0;\n}\n.time-area:after {\n    content: "s";\n}\n.property .arrow {\n    position: relative;\n    display: inline-block;\n    width: 20px;\n    height: 25px;\n    cursor: pointer;\n    vertical-align: middle;\n}\n.property .arrow:after {\n    content: "";\n    position: absolute;\n    top: 0;\n    right: 0;\n    left: 0;\n    bottom: 0;\n    margin: auto;\n    width: 0;\n    height: 0;\n    border-top: 6px solid #eee;\n    border-left: 4px solid transparent;\n    border-right: 4px solid transparent;\n}\n.property[data-fold="1"] .arrow:after {\n    border-top: 4px solid transparent;\n    border-bottom: 4px solid transparent;\n    border-right: 0;\n    border-left: 6px solid #eee;\n}\n.property[data-object="0"] .arrow {\n    display: none;\n}\n.property.fold, .keyframes.fold, .value.fold {\n    display: none;\n}\n.property.select, .value.select, .keyframes.select {\n    background: rgba(120, 120, 120, 0.7);\n}\n.keyframes {\n\n}\n.keyframe-delay {\n  position: absolute;\n  top: 3px;\n  bottom: 3px;\n  left: 0;\n  background: #4af;\n  opacity: 0.2;\n  z-index: 0;\n}\n.keyframe-group {\n    position: absolute;\n    top: 3px;\n    bottom: 3px;\n    left: 0;\n    background: #4af;\n    opacity: 0.6;\n    border: 1px solid rgba(0, 0, 0, 0.2);\n    border-left-color: rgba(255, 255, 255, 0.2);\n    border-top-color: rgba(255, 255, 255, 0.2);\n    z-index: 0;\n}\n.keyframe-line {\n  position: absolute;\n  height: 8px;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  background: #666;\n  z-index: 0;\n}\n.keyframe {\n  position: absolute;\n  font-size: 0px;\n  width: 12px;\n  height: 12px;\n  top: 0px;\n  bottom: 0px;\n  margin: auto;\n  background: #fff;\n  border: 2px solid #383838;\n  border-radius: 2px;\n  box-sizing: border-box;\n  transform: translate(-50%) rotate(45deg);\n  z-index: 1;\n  cursor: pointer;\n}\n.keyframe[data-no="1"] {\n    opacity: 0.2;\n}\n.select .keyframe {\n    border-color: #555;\n}\n.keyframe.select {\n    background: #4af;\n}\n.keyframes-container, .line-area {\n  position: relative;\n  width: calc(100% - 30px);\n  left: 15px;\n  height: 100%;\n}\n.line-area {\n  position: absolute;\n  top: 0;\n  z-index: 0;\n}\n.keyframe-cursor {\n  position: absolute;\n  top: 0;\n  z-index: 1;\n  background: #4af;\n  width: 1px;\n  height: 100%;\n  left: 15px;\n  transform: translate(-50%);\n}\n.scroll-aare .keyframe-cursor {\n  pointer-events: none;\n}\n.division-line {\n  position: absolute;\n  background: #333;\n  width: 1px;\n  height: 100%;\n  transform: translate(-50%);\n}\n'.replace(/\.([^{,\s\d.]+)/g,"."+Kn+"$1")),Xn="direction",Yn="iterationCount",qn="delay",Hn="playSpeed",Bn="alternate",Vn="reverse",$n="alternate-reverse";function Zn(t,e,n){var r=(""+t).length,i=[];n&&i.push(t);for(var o=r;o<e;++o)i.push(0);return n||i.push(t),i.join("")}function Gn(e){return K(e)?Array.isArray(e)?"["+e.join(", ")+"]":"{"+function(t){var e=[];for(var n in t)e.push(n);return e}(e).map(function(t){return t+": "+Gn(e[t])}).join(", ")+"}":e}function Qn(t,e){for(var n=t;n&&n!==document.body;){if(e(n))return n;n=n.parentNode}return null}function Jn(t,e){return function(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}(t,Kn+e)}function tr(t){return!!t.constructor.prototype.getItem}function er(t,i){return W(t,function(t){var e=t.getBoundingClientRect(),n=e.top,r=n+e.height;return n<=i&&i<r})}function nr(t){return t.split(" ").map(function(t){return Kn+t}).join(" ")}function rr(e,n){return function(t){t&&(e[n]=t)}}function ir(e,n,r){return function(t){t&&(e[n][r]=t)}}function or(n,r){var t=W(r,function(t,e){return n[r.slice(0,e+1).join("///")+"///"]});return-1<t?t===r.length-1?2:1:0}function ar(t,e,n){var r=e+"///",i=t.state.foldedInfo;i[r]=!i[r],n||t.setState({foldedInfo:Rn({},i)})}function sr(t){for(var e=t.maxTime,n=[],r=0;r<=e;++r)n.push(wn("div",{className:nr("division-line"),key:r,style:{left:100/e*r+"%"}}));return wn("div",{className:nr("line-area")},n)}var ur=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ln(e,t),e.prototype.getElement=function(){return this.element||(this.element=function(t){return t&&(t.base||1===t.nodeType&&t)||null}(this))},e}(Mn),cr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Ln(e,t);var n=e.prototype;return n.render=function(){return wn("input",{className:nr("time-area")})},n.componentDidMount=function(){var i=this;new Z(this.getElement()).keydown(function(t){t.isToggle||t.inputEvent.stopPropagation()}).keyup(function(t){t.isToggle||t.inputEvent.stopPropagation()}).keyup("enter",function(t){var e=i.getElement().value,n=/(\d+):(\d+):(\d+)/g.exec(e);if(n){var r=60*parseFloat(n[1])+parseFloat(n[2])+parseFloat("0."+n[3]);i.props.setTime(r)}})},e}(ur),lr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isPlay:!1},t.play=function(){t.setState({isPlay:!0})},t.pause=function(){t.setState({isPlay:!1})},t.unselect=function(){t.props.select("",-1)},t}Ln(t,e);var n=t.prototype;return n.render=function(){return wn("div",{className:nr("control-area header-area")},wn("div",{className:nr("properties-area"),onClick:this.unselect},wn("div",{className:nr("property")})),wn("div",{className:nr("values-area")},wn("div",{className:nr("value")})),wn("div",{className:nr("keyframes-area")},wn("div",{className:nr("keyframes")},wn(cr,{ref:rr(this,"timeArea"),setTime:this.props.setTime}),wn("div",{className:nr("play-control-area")},wn("div",{className:nr("control prev"),onClick:this.props.prev}),wn("div",{className:nr("control "+(this.state.isPlay?"pause":"play")),onClick:this.props.togglePlay}),wn("div",{className:nr("control next"),onClick:this.props.next})))))},n.componentDidMount=function(){this.initScene(this.props.scene)},n.componentDidUpdate=function(t){t.scene!==this.props.scene&&(this.initScene(this.props.scene),this.releaseScene(t.scene))},n.componentWillUnmount=function(){this.releaseScene(this.props.scene)},n.initScene=function(t){t&&t.on({play:this.play,paused:this.pause})},n.releaseScene=function(t){t&&(t.off("play",this.play),t.off("paused",this.pause))},t}(ur),pr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ln(e,t),e.prototype.render=function(){return wn("div",{className:nr("keyframe-cursor"),ref:rr(this,"cursor")})},e}(ur),hr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Ln(e,t);var n=e.prototype;return n.renderKeytimes=function(){for(var t=this.props.maxTime,e=[],n=0;n<=t;++n)e.push(wn("div",{key:n,"data-time":n,className:nr("keytime"),style:{width:100/t+"%"}},wn("span",null,n),wn("div",{className:nr("graduation start")}),wn("div",{className:nr("graduation quarter")}),wn("div",{className:nr("graduation half")}),wn("div",{className:nr("graduation quarter3")})));return e},n.render=function(){var t=this.props,e=t.maxTime,n=t.maxDuration,r=t.zoom;return wn("div",{className:nr("keytimes-area keyframes-area")},wn("div",{className:nr("keyframes-scroll-area"),ref:rr(this,"scrollAreaElement"),style:{minWidth:50*e+"px",width:Math.min(n?e/n:1,2)*r*100+"%"}},wn("div",{className:nr("keytimes keyframes")},wn("div",{className:nr("keyframes-container")},this.renderKeytimes()),wn(pr,{ref:rr(this,"cursor")}))))},n.componentDidMount=function(){var n=this;U(this.getElement(),"wheel",function(t){var e=t.deltaY;n.props.axes.setBy({zoom:e/5e3}),t.deltaX||t.preventDefault()}),G(this.cursor.getElement(),{dragstart:function(t){t.inputEvent.stopPropagation()},drag:function(t){var e=t.clientX;n.props.move(e)},container:window})},e}(ur),fr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.add=function(){t.props.scene||t.props.add()},t}return Ln(t,e),t.prototype.render=function(){var t=this.props,e=t.axes,n=t.timelineInfo,r=t.maxTime,i=t.maxDuration,o=t.zoom,a=t.move;return wn("div",{className:nr("header-area")},wn("div",{className:nr("properties-area")},wn("div",{className:nr("property")},"Name")),wn("div",{className:nr("values-area")},wn("div",{className:nr("value")},wn("div",{className:nr("add"),onClick:this.add},"+"))),wn(hr,{ref:rr(this,"keytimesArea"),move:a,axes:e,timelineInfo:n,maxDuration:i,maxTime:r,zoom:o}))},t}(ur),dr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ln(e,t),e.prototype.render=function(){var t=this.props,e=t.time,n=t.value,r=t.maxTime;return wn("div",{className:nr("keyframe"+(t.selected?" select":"")),"data-time":e,style:{left:e/r*100+"%"}},e," ",n)},e}(ur),mr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ln(e,t),e.prototype.render=function(){var t=this.props,e=t.time,n=t.nextTime,r=t.maxTime;return wn("div",{className:nr("keyframe-group"+(t.selected?" select":"")),"data-time":e,style:{left:e/r*100+"%",width:(n-e)/r*100+"%"}})},e}(zn),vr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ln(e,t),e.prototype.render=function(){var t=this.props,e=t.time,n=t.nextTime,r=t.maxTime;return wn("div",{className:nr("keyframe-delay"),style:{left:e/r*100+"%",width:(n-e)/r*100+"%"}})},e}(zn),gr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ln(e,t),e.prototype.render=function(){var t=this.props,e=t.time,n=t.nextTime,r=t.maxTime;return wn("div",{className:nr("keyframe-line"),style:{left:e/r*100+"%",width:(n-e)/r*100+"%"}})},e}(zn),yr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Ln(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=t.id,n=t.propertiesInfo,r=t.selected;return wn("div",{className:nr("keyframes"+(1===t.folded?" fold":"")+(r?" select":"")),"data-item":n.isItem?"1":"0","data-id":e},wn("div",{className:nr("keyframes-container")},this.renderList()))},n.renderList=function(){var t=this.props,e=t.propertiesInfo,h=t.maxTime,f=t.selected,d=t.selectedTime,n=e.item,m=e.frames,r=e.properties,v=tr(n),g=n.getDuration(),y=[],i=[],b=[],x=[],o=m.length,k=r.length,w=0;if(2<=o&&!k){var a=W(m,function(t){return!T(t[2])});w=Math.min(o-2,Math.max(0===m[0][1]&&0===m[1][1]?1:0,a));var s=m[w],u=m[o-1],c=s[0],l=u[0];i.push(wn(mr,{key:"group",id:c+","+l,selected:f&&c<=d&&d<=l,time:c,nextTime:l,maxTime:h}))}return m.forEach(function(t,e){var n=t[0],r=t[1],i=t[2],o=Gn(i);if(m[e+1]){var a=m[e+1],s=a[0],u=a[1];(0===r&&0===u||r===g&&u===g)&&b.push(wn(vr,{key:"delay"+n+","+s,id:"-1",time:n,nextTime:s,maxTime:h}))}if(0!==e||0!==n||0!==r||!T(i)||k){if(m[e+1]){var c=m[e+1],l=(s=c[0],c[2]),p=Gn(l);v||T(i)||T(l)||o===p||!k||x.push(wn(gr,{key:"line"+x.length,time:n,id:n+","+s,nextTime:s,maxTime:h}))}v||e<w||y.push(wn(dr,{key:"keyframe"+e,id:""+n,selected:f&&n===d,time:n,iterationTime:r,value:o,maxTime:h}))}}),i.concat(y,b,x)},e}(ur),br=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.keyframesList=[],t.state={foldedInfo:{}},t}Ln(t,e);var n=t.prototype;return n.render=function(){var t=this.props,e=t.timelineInfo,n=t.maxTime,r=t.maxDuration,i=t.zoom,o=t.selectedProperty,a=t.selectedTime,s=this.state.foldedInfo,u=Math.min(r?n/r:1,2),c=[];for(var l in this.keyframesList=[],e){var p=e[l],h=l===o,f=or(s,p.keys);c.push(wn(yr,{ref:ir(this,"keyframesList",c.length),selected:h,folded:f,selectedTime:a,key:l,id:l,propertiesInfo:p,maxTime:n}))}return wn("div",{className:nr("keyframes-area")},wn("div",{className:nr("keyframes-scroll-area"),ref:rr(this,"scrollAreaElement"),style:{minWidth:50*n+"px",width:u*i*100+"%"}},c.concat([wn(pr,{key:"cursor",ref:rr(this,"cursor")}),wn(sr,{maxTime:n,key:"lines"})])))},n.componentDidMount=function(){var n=this;U(this.getElement(),"wheel",function(t){if(n.props.keycon.altKey){t.preventDefault();var e=t.deltaY;n.props.axes.setBy({zoom:e/5e3})}})},t}(ur),xr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ln(e,t),e.prototype.render=function(){var t=this.props,e=t.id,n=t.selected,r=t.folded,i=t.propertiesInfo,o=i.keys,a=i.isItem,s=i.isParent,u=o.length,c=o[u-1];return wn("div",{className:nr("property"+(1===r?" fold":"")+(n?" select":"")),"data-id":e,"data-name":c,"data-object":s?1:0,"data-item":a?1:0,"data-fold":2===r?1:0,style:{paddingLeft:10+20*(u-1)+"px"}},wn("div",{className:nr("arrow")}),wn("span",null,c),wn("div",{className:nr("remove")}))},e}(ur),kr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.properties=[],t.state={foldedInfo:{}},t}return Ln(t,e),t.prototype.render=function(){var t=this.props,e=t.timelineInfo,n=t.selectedProperty,r=this.state.foldedInfo,i=[];for(var o in this.properties=[],e){var a=e[o],s=n===o,u=or(r,a.keys);i.push(wn(xr,{ref:ir(this,"properties",i.length),selected:s,folded:u,key:o,id:o,propertiesInfo:a}))}return wn("div",{className:nr("properties-area")},wn("div",{className:nr("properties-scroll-area")},i))},t}(ur),wr=function(t){function e(){var r=null!==t&&t.apply(this,arguments)||this;return r.add=function(){var t=r.props,e=t.add,n=t.propertiesInfo;e(n.item,n.properties)},r}Ln(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=t.id,n=t.selected,r=t.folded,i=t.propertiesInfo,o=i.isItem,a=i.isParent;return wn("div",{className:nr("value"+(1===r?" fold":"")+(n?" select":"")),"data-id":e,"data-object":a?1:0,"data-item":o?1:0},this.renderValue())},n.renderValue=function(){return this.props.propertiesInfo.isParent?wn("div",{className:nr("add"),onClick:this.add},"+"):wn("input",{ref:rr(this,"inputElement")})},e}(ur),_r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.values=[],t.state={foldedInfo:{}},t}Ln(t,e);var n=t.prototype;return n.render=function(){var t=this.props,e=t.timelineInfo,n=t.selectedProperty,r=t.add,i=this.state.foldedInfo,o=[];for(var a in this.values=[],e){var s=e[a],u=n===a,c=or(i,s.keys);o.push(wn(wr,{ref:ir(this,"values",o.length),add:r,key:a,folded:c,selected:u,id:a,propertiesInfo:s}))}return wn("div",{className:nr("values-area")},o)},n.componentDidMount=function(){var n,r,i=this,t=this.getElement();t.addEventListener("focusout",function(t){i.props.setTime()}),G(t,{container:window,dragstart:function(t){if(n=t.inputEvent.target,r=n.value,!i.props.keycon.altKey||!Qn(n,function(t){return"INPUT"===t.nodeName}))return!1},drag:function(e){var t=r.replace(/-?\d+/g,function(t){return""+(parseFloat(t)+Math.round(e.distX/2))});n.value=t},dragend:function(t){i.edit(n,n.value)}}),new Z(t).keydown(function(t){t.isToggle||t.inputEvent.stopPropagation()}).keyup(function(t){t.isToggle||t.inputEvent.stopPropagation()}).keyup("enter",function(t){var e=t.inputEvent.target;i.edit(e,e.value)}).keyup("esc",function(t){t.inputEvent.target.blur()})},n.edit=function(t,e){var n=Qn(t,function(t){return Jn(t,"value")});if(n){console.log(t,e);var r=W(this.values,function(t){return t.getElement()===n});-1!==r&&this.props.editKeyframe(r,e)}},t}(ur),Tr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Ln(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=t.axes,n=t.keycon,r=t.zoom,i=t.maxDuration,o=t.maxTime,a=t.timelineInfo,s=t.selectedProperty,u=t.selectedTime,c=t.add,l=t.setTime,p=t.editKeyframe;return wn("div",{className:nr("scroll-area")},wn(kr,{ref:rr(this,"propertiesArea"),timelineInfo:a,selectedProperty:s}),wn(_r,{ref:rr(this,"valuesArea"),add:c,keycon:n,setTime:l,editKeyframe:p,timelineInfo:a,selectedProperty:s}),wn(br,{ref:rr(this,"keyframesArea"),axes:e,keycon:n,zoom:r,maxDuration:i,timelineInfo:a,maxTime:o,selectedProperty:s,selectedTime:u}))},n.componentDidMount=function(){this.initClickProperty(),this.foldAll()},n.foldAll=function(){var o=this;this.propertiesArea.properties.forEach(function(t,e){var n=t.props.propertiesInfo,r=n.keys,i=n.isParent;1===r.length&&i&&o.fold(e)})},n.fold=function(t,e){var n=this.propertiesArea.properties[t].props.id;ar(this.propertiesArea,n,e),ar(this.valuesArea,n,e),ar(this.keyframesArea,n,e)},n.removeProperty=function(t){var e=t.key,n=t.isItem,r=t.parentItem,i=t.item,o=t.properties;if(n){var a=null;r.forEach(function(t,e){t!==i||(a=e)}),null!=a&&r.removeItem(a)}else{i.times.forEach(function(t){var e;(e=i).remove.apply(e,[t].concat(o))})}this.props.selectedProperty===e&&this.props.select("",-1,!0),this.props.update()},n.initClickProperty=function(){var s=this;this.propertiesArea.getElement().addEventListener("click",function(t){var e=Qn(t.target,function(t){return Jn(t,"arrow")}),n=Qn(t.target,function(t){return Jn(t,"remove")}),r=Qn(t.target,function(t){return Jn(t,"property")});if(r){var i=s.propertiesArea.properties,o=s.propertiesArea.properties.map(function(t){return t.getElement()}).indexOf(r);if(-1!==o){var a=i[o];n?s.removeProperty(a.props.propertiesInfo):(s.props.select(a.props.id),e&&s.fold(o))}}})},e}(ur),Pr=0,Er=-1,Cr=-1;function Ar(t,e,n,r,i){var o=Date.now?Date.now():(new Date).getTime();t||(Er===n&&Cr===r&&o-Pr<=500&&i(e,n,r),Er=n,Cr=r,Pr=o)}var Nr=1e6;function Sr(t){return Math.round(t*Nr)/Nr}function Or(t,e,n){var r=t[t.length-1];r&&r[0]===e&&r[1]===n||t.push([Sr(e),Sr(n)])}function Ir(t,e){if(!t.length)return[];var x=t.map(function(t){return[t,t]}),k=[];return 0!==x[0][0]&&e[e.length-1][qn]&&x.unshift([0,0]),e.forEach(function(t){for(var e,n,r=t[Yn],i=t[qn],o=t[Hn],a=t[Xn],s=Math.ceil(r),u=x[x.length-1][0],c=x.length,l=u*r,p=0;p<s;++p)for(var h=a===Vn||a===Bn&&p%2||a===$n&&!(p%2),f=0;f<c;++f){var d=x[h?c-f-1:f],m=d[1],v=u*p+(h?u-d[0]:d[0]),g=x[h?c-f:f-1];if(l<v){if(0!==f){var y=u*p+(h?u-g[0]:g[0]),b=(g[1]*(n=v-l)+m*(e=l-y))/(e+n);Or(k,(i+u*r)/o,b)}break}if(v===l&&k.length&&k[k.length-1][0]===l+i)break;Or(k,(i+v)/o,m)}i&&k.unshift([0,k[0][1]]),x=k,k=[]}),x}function Dr(t){var c={};return function e(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r=n.length,i=n[r-1],o=n.slice(1).map(function(t){return t.getId()});if(tr(i)){if(o.length){var a=o.join("///"),s=Ir([0,i.getDuration()],n.slice(1).map(function(t){return t.state}).reverse()),u=[];s.forEach(function(t){var e=t[0],n=t[1];u.push([e,n,n])}),c[a]={key:a,keys:o,isItem:!0,isParent:!0,parentItem:n[r-2],item:i,names:[],properties:[],frames:u}}i.forEach(function(t){e.apply(void 0,n.concat([t]))})}else!function(l,t,p,h){h.update();var e=h.times.slice(),n=h.getDuration();h.getFrame(0)||e.unshift(0),h.getFrame(n)||e.push(n);var f=Ir(e,t.slice(1).map(function(t){return t.state}).reverse()),d=t[t.length-2];!function t(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var o=[],r=K(e),a=0===i.length;f.forEach(function(t){var e=t[0],n=t[1],r=h.get.apply(h,[n].concat(i));T(r)&&i.length||o.push([e,n,r])});var s=p.concat(i),u=s.join("///");if(u&&(l[u]={key:u,keys:s,parentItem:d,isParent:r,isItem:a,item:h,names:p,properties:i,frames:o}),r)for(var c in e)t.apply(void 0,[e[c]].concat(i,[c]))}(h.names)}(c,n,o,i)}(t),c}var zr=!1,Mr=function(e){function t(t){var u=e.call(this,t)||this;return u.state={alt:!1,zoom:1,maxDuration:0,maxTime:0,timelineInfo:{},selectedProperty:"",selectedTime:-1,init:!1},u.isExportCSS=!1,u.update=function(t){void 0===t&&(t=!1);var e=u.props.scene;if(e){var n=Math.ceil(e.getDuration()),r=Math.max(u.state.maxTime,n),i=u.state.maxTime,o=u.axes.get(["zoom"]).zoom,a=1<i?r/i:1,s=Math.max(1,o*a);u.setState({timelineInfo:Dr(e),maxTime:r,maxDuration:n,init:t}),u.axes.axm.set({zoom:s})}},u.prev=function(){var t=u.props.scene;t&&u.setTime(t.getTime()-.05)},u.next=function(){var t=u.props.scene;t&&u.setTime(t.getTime()+.05)},u.finish=function(){var t=u.props.scene;t&&t.finish()},u.togglePlay=function(){var t=u.props.scene;t&&("running"===t.getPlayState()?t.pause():t.play())},u.add=function(t,e){void 0===t&&(t=u.props.scene),void 0===e&&(e=[]),tr(t)?u.newItem(t):u.newProperty(t,e)},u.getDistTime=function(t,e){void 0===e&&(e=u.scrollArea.keyframesArea.scrollAreaElement.getBoundingClientRect());var n=e.width-30,r=Math.min(n,t)/n,i=u.state.maxTime*r;return Math.round(20*i)/20},u.setTime=function(t){var e=u.props.scene;if(e){var n=e.getDirection();e.pause(),T(t)&&(t=e.getTime()),"normal"===n||"alternate"===n?e.setTime(t):e.setTime(e.getDuration()-t)}},u.getTime=function(t){var e=u.scrollArea.keyframesArea.scrollAreaElement.getBoundingClientRect(),n=e.left+15,r=Math.max(t-n,0);return u.getDistTime(r,e)},u.move=function(t){u.setTime(u.getTime(t))},u.select=function(t,e,n){void 0===e&&(e=-1);var r=u.props.scene;r&&(r.pause(),n?(u.state.selectedProperty=t,u.state.selectedTime=-1):u.setState({selectedProperty:t,selectedTime:e}))},u.editKeyframe=function(t,e){var n=u.scrollArea.propertiesArea.properties[t].props.propertiesInfo;if(!n.isParent){var r=n.item,i=n.properties;r.set.apply(r,[r.getIterationTime()].concat(i,[e])),u.update()}},u.animate=function(t){var e=t.time,n=Zn(Math.floor(e/60),2),r=Zn(Math.floor(e%60),2),i=Zn(Math.floor(e%1*100),3,!0);u.moveCursor(e),u.setInputs(function t(e,n){for(var r in void 0===n&&(n={}),e){var i=e[r];if(K(i)){var o=t(i.constructor.prototype.toCSS?i.get():i);for(var a in o)n[r+"///"+a]=o[a]}else n[r]=i}return n}(t.frames||t.frame.get())),u.controlArea.timeArea.getElement().value=n+":"+r+":"+i},zr&&(zr=!0,u.isExportCSS=!0),u.state=Rn({},u.state,u.initScene(u.props.scene)),u.keycon=(new Z).keydown("alt",function(){u.setState({alt:!0})}).keyup("alt",function(){u.setState({alt:!1})}),u.axes=new Ge({zoom:{range:[1,1/0]}},{},{zoom:1}),u}Ln(t,e);var n=t.prototype;return n.render=function(){var t=this.props,e=t.scene,n=t.className,r=(t.keyboard,t.onSelect,function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]])}return n}(t,["scene","className","keyboard","onSelect"])),i=this.state,o=i.zoom,a=i.alt,s=i.maxDuration,u=i.maxTime,c=i.timelineInfo,l=i.selectedProperty,p=i.selectedTime;return wn("div",Rn({className:nr("timeline"+(a?" alt":""))+(n?" "+n:"")},r),this.renderStyle(),wn(lr,{ref:rr(this,"controlArea"),scene:e,select:this.select,prev:this.prev,next:this.next,setTime:this.setTime,togglePlay:this.togglePlay}),wn(fr,{ref:rr(this,"headerArea"),scene:e,add:this.add,axes:this.axes,move:this.move,maxDuration:s,zoom:o,maxTime:u,timelineInfo:c}),wn(Tr,{ref:rr(this,"scrollArea"),add:this.add,setTime:this.setTime,editKeyframe:this.editKeyframe,keycon:this.keycon,axes:this.axes,maxDuration:s,zoom:o,maxTime:u,update:this.update,select:this.select,selectedProperty:l,selectedTime:p,timelineInfo:c}))},n.componentDidMount=function(){this.initWheelZoom(),this.initScroll(),this.initDragKeyframes(),this.initKeyController()},n.componentDidUpdate=function(t,e){if(this.props.onSelect&&e.selectedProperty!==this.state.selectedProperty){var n=e.selectedProperty,r=e.selectedTime,i=this.state,o=i.selectedProperty,a=i.selectedTime,s=this.state.timelineInfo[o];this.props.onSelect({selectedItem:o?s.item:this.props.scene,selectedProperty:o,selectedTime:a,prevSelectedProperty:n,prevSelectedTime:r})}this.state.init&&(this.state.init=!1,this.scrollArea.foldAll()),t.scene!==this.props.scene?(this.releaseScene(t.scene),this.setState(this.initScene(this.props.scene))):this.setTime()},n.renderStyle=function(){if(!this.isExportCSS)return wn("style",null,Fn)},n.newItem=function(t){var e=prompt("Add Item");e&&(t.newItem(e),this.update())},n.newProperty=function(t,e){var n=prompt("Add Property");n&&(t.set.apply(t,[t.getIterationTime()].concat(e,[n,""])),this.update())},n.moveCursor=function(t){var e=this.state.maxTime,n="calc("+100*t/e+"% + "+(15-30*t/e)+"px)";this.scrollArea.keyframesArea.cursor.getElement().style.left=n,this.headerArea.keytimesArea.cursor.getElement().style.left=n},n.setInputs=function(t){var e=this.scrollArea.valuesArea.getElement();for(var n in t)e.querySelector('[data-id="'+n+'"] input').value=t[n]},n.removeKeyframe=function(t){var e=this.state.timelineInfo[t];if(t&&e&&!tr(e.item)){var n=e.properties,r=e.item;r.remove.apply(r,[r.getIterationTime()].concat(n)),this.update()}},n.addKeyframe=function(t,e){var n=this.scrollArea.keyframesArea.keyframesList[t].props.id;this.select(n,e);var r=this.scrollArea.valuesArea.values[t].inputElement;r&&this.editKeyframe(t,r.value)},n.initScene=function(t){if(!t)return{timelineInfo:{},maxTime:0,maxDuration:0,zoom:1,init:!1};t.finish(),t.on("animate",this.animate);var e=Math.ceil(t.getDuration());return{timelineInfo:Dr(t),maxTime:e,maxDuration:e,zoom:1,init:!0}},n.releaseScene=function(t){t&&t.off("animate",this.animate)},n.initWheelZoom=function(){var e=this,t=this.scrollArea.getElement(),n=this.axes;(Un||Wn)&&n.connect("zoom",new nn(t,{scale:.1,hammerManagerOptions:{touchAction:"auto"}})),n.on("hold",function(t){t.inputEvent&&t.inputEvent.preventDefault()}),n.on("change",function(t){t.pos.zoom!==e.state.zoom&&(e.setState({zoom:t.pos.zoom}),t.inputEvent&&t.inputEvent.preventDefault())}),this.axes=n},n.initScroll=function(){var t=!1,e=this.headerArea.keytimesArea.getElement(),n=this.scrollArea.keyframesArea.getElement();e.addEventListener("scroll",function(){t?t=!1:(t=!0,n.scrollLeft=e.scrollLeft)}),n.addEventListener("scroll",function(){t?t=!1:(t=!0,e.scrollLeft=n.scrollLeft)})},n.initDragKeyframes=function(){function o(t,e,n){var r=er(u.scrollArea.keyframesArea.keyframesList.map(function(t){return t.getElement()}),n);-1!==r&&u.addKeyframe(r,u.getTime(e))}var a,s,u=this,t=this.headerArea.keytimesArea.scrollAreaElement,e=this.scrollArea.keyframesArea.scrollAreaElement,c=0;[t,e].forEach(function(t){G(t,{container:window,dragstart:function(t){var e=t.inputEvent;if(s=Qn(e.target,function(t){return Jn(t,"keyframe-group")})){var n=u.scrollArea.propertiesArea.properties,r=Qn(s,function(t){return Jn(t,"keyframes")}).getAttribute("data-id"),i=function(t,e,n){var r=W(t,e);return-1<r?t[r]:n}(n,function(t){return t.props.id===r}).props.propertiesInfo;a=i.item,c=a.getDelay()}},drag:function(t){var e=t.distX,n=t.deltaX,r=t.deltaY,i=t.inputEvent;s?(a.setDelay(Math.max(c+u.getDistTime(e),0)),u.update()):(u.scrollArea.keyframesArea.getElement().scrollLeft-=n,u.scrollArea.getElement().scrollTop-=r,i.preventDefault())},dragend:function(t){var e=t.isDrag,n=t.clientX,r=t.clientY,i=t.inputEvent;a=s=null,c=0,e||function(t,e,n){var r=Qn(t.target,function(t){return Jn(t,"keyframe")}),i=r?parseFloat(r.getAttribute("data-time")||""):u.getTime(e);u.setTime(i);var o=u.scrollArea.keyframesArea.keyframesList,a=er(o.map(function(t){return t.getElement()}),n);-1<a&&u.select(o[a].props.id,i),t.preventDefault()}(i,n,r),Ar(e,i,n,r,o)}})})},n.initKeyController=function(){var e=this;window.addEventListener("blur",function(){e.setState({alt:!1})}),this.props.keyboard&&this.keycon.keydown("space",function(t){t.inputEvent.preventDefault()}).keydown("left",function(t){e.prev()}).keydown("right",function(t){e.next()}).keyup("backspace",function(){e.removeKeyframe(e.state.selectedProperty)}).keyup("esc",function(){e.finish()}).keyup("space",function(){e.togglePlay()})},t.defaultProps={keyboard:!0},t}(zn),jr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}!function(t,e){function n(){this.constructor=t}rn(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t);var n=e.prototype;return n.render=function(){var e=this;return s(Mr,on({},this.props,{ref:function(t){e.timeline=t}}))},n.update=function(t){this.timeline.update(t)},n.prev=function(){this.timeline.prev()},n.next=function(){this.timeline.next()},n.finish=function(){this.timeline.finish()},n.togglePlay=function(){this.timeline.togglePlay()},e}(k);return function(o){function t(t,e,n){void 0===n&&(n={});var r=o.call(this)||this;r.onSelect=function(t){r.trigger("select",t)};var i=document.createElement("div");return function(t,e,n){I(n,t,{},!1,e,!1)}(s(jr,a({ref:function(t){t&&(r.timelineArea=t)},keyboard:!0},n,{scene:t,onSelect:r.onSelect})),i),e.appendChild(i.children[0]),r}return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,o),t.prototype.update=function(t){this.timelineArea.update(t)},t}(t)});
//# sourceMappingURL=timeline.pkgd.min.js.map
