{"version":3,"file":"timeline.js","sources":["../src/consts.ts","../src/utils.ts","../src/dblcheck.ts","../src/KeytimesStructure.ts","../src/HeaderAreaStructure.ts","../src/KeyframesStructure.ts","../src/PropertiesStructure.ts","../src/ValuesStructure.ts","../src/ScrollAreaStructure.ts","../src/ControlAreaStructure.ts","../src/Timeline.ts"],"sourcesContent":["export const PREFIX = `scenejs_timeline_`;\n\nexport const CSS = `\n.timeline {\n  position: relative;\n  font-size: 0;\n  background: #000;\n  display: flex;\n  flex-direction: column;\n}\n.header_area, .scroll_area {\n   width: 100%;\n   position: relative;\n  display: flex;\n  -webkit-align-items: flex-start;\n  align-items: flex-start;\n}\n.header_area {\n  position: relative;\n  z-index: 10;\n  top: 0;\n  height: 30px;\n  min-height: 30px;\n}\n.header_area .keyframes {\n  padding: 0px;\n}\n.header_area .properties_area,\n.header_area .keyframes_area,\n.header_area .values_area,\n.header_area .keyframes_scroll_area {\n    height: 100%;\n}\n.header_area .property, .header_area .value, .header_area .keyframes {\n  height: 100%;\n}\n.header_area .property {\n    line-height: 30px;\n}\n.header_area .value {\n    text-align: center;\n    color: #fff;\n    line-height: 30px;\n    font-weight: bold;\n    font-size: 20px;\n}\n.header_area .keyframes_area::-webkit-scrollbar {\n    display: none; // Safari and Chrome\n}\n.header_area .keyframe_cursor {\n    position: absolute;\n    border-top: 10px solid #4af;\n    border-left: 6px solid transparent;\n    border-right: 6px solid transparent;\n    width: 0;\n    height: 0;\n    bottom: 0;\n    top: auto;\n    background: none;\n    cursor: pointer;\n}\n.control_area .keyframes {\n    padding-left: 10px;\n}\n.play_control_area {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n.play_control_area .control {\n    position: relative;\n    display: inline-block;\n    vertical-align: middle;\n    color: white;\n    margin: 0px 15px;\n}\n.play {\n    border-left: 14px solid white;\n    border-top: 8px solid transparent;\n    border-bottom: 8px solid transparent;\n}\n.pause {\n    border-left: 4px solid #fff;\n    border-right: 4px solid #fff;\n    width: 6px;\n    height: 16px;\n}\n.prev {\n    border-right: 10px solid white;\n    border-top: 6px solid transparent;\n    border-bottom: 6px solid transparent;\n}\n.prev:before {\n    position: absolute;\n    content: \"\";\n    width: 3px;\n    height: 10px;\n    top: 0;\n    right: 100%;\n    transform: translate(0, -50%);\n    background: white;\n}\n.next {\n    border-left: 10px solid white;\n    border-top: 6px solid transparent;\n    border-bottom: 6px solid transparent;\n}\n.next:before {\n    position: absolute;\n    content: \"\";\n    width: 3px;\n    height: 10px;\n    top: 0;\n    transform: translate(0, -50%);\n    background: white;\n}\n.keytime {\n  position: relative;\n  display: inline-block;\n  height: 100%;\n  font-size: 13px;\n  font-weight: bold;\n  color: #777;\n}\n.keytime:last-child {\n  max-width: 0px;\n}\n.keytime span {\n  position: absolute;\n  top: 2px;\n  left: 0;\n  display: inline-block;\n  transform: translate(-50%);\n  color: #eee;\n}\n.keytime .graduation {\n  position: absolute;\n  bottom: 0;\n  width: 1px;\n  height: 10px;\n  background: #777;\n  transform: translate(-50%);\n}\n.keytime .graduation.half {\n  left: 50%;\n  height: 7px;\n}\n.keytime .graduation.quarter {\n  left: 25%;\n  height: 5px;\n}\n.keytime .graduation.quarter3 {\n  left: 75%;\n  height: 5px;\n}\n.scroll_area {\n  position: relative;\n  width: 100%;\n  height: calc(100% - 60px);\n  overflow: auto;\n}\n.properties_area, .keyframes_area, .values_area {\n  display: inline-block;\n  position: relative;\n  font-size: 16px;\n  overflow: auto;\n}\n\n.properties_area::-webkit-scrollbar, .keyframes_area::-webkit-scrollbar {\n    display: none; // Safari and Chrome\n}\n.properties_area {\n  width: 30%;\n  max-width: 200px;\n  box-sizing: border-box;\n}\n.values_area {\n    width: 50px;\n    min-width: 50px;\n    display: inline-block;\n    border-right: 1px solid #999;\n    box-sizing: border-box;\n}\n.value input {\n    appearance: none;\n    -webkit-appearance: none;\n    outline: none;\n    position: relative;\n    display: block;\n    width: 100%;\n    height: 100%;\n    background: transparent;\n    color: #4af;\n    font-weight: bold;\n    background: none;\n    border: 0;\n    box-sizing: border-box;\n    text-align: center;\n}\n.alt .value input {\n    cursor: ew-resize;\n}\n.value[data-object=\"1\"] input {\n    display: none;\n}\n.properties_scroll_area {\n  display: inline-block;\n  min-width: 100%;\n}\n.keyframes_area {\n  flex: 1;\n}\n.keyframes_scroll_area {\n  position: relative;\n  min-width: 300px;\n}\n.keyframes, .property, .value {\n  position: relative;\n  height: 25px;\n  border-bottom: 1px solid #777;\n  box-sizing: border-box;\n  white-space: nowrap;\n  background: rgba(90, 90, 90, 0.7);\n  z-index: 1;\n}\n\n.property {\n  line-height: 25px;\n  padding-left: 10px;\n  box-sizing: border-box;\n  font-size: 13px;\n  font-weight: bold;\n  color: #eee;\n}\n.time_area {\n    font-size: 13px;\n    color: #4af;\n    line-height: 30px;\n    font-weight: bold;\n    height: 100%;\n    line-height: 30px;\n    border: 0;\n    background: transparent;\n    outline: 0;\n}\n.time_area:after {\n    content: \"s\";\n}\n.property .arrow {\n    position: relative;\n    display: inline-block;\n    margin-right: 5px;\n    width: 0;\n    vertical-align: middle;\n    cursor: pointer;\n    border-top: 6px solid #eee;\n    border-left: 4px solid transparent;\n    border-right: 4px solid transparent;\n}\n.property[data-fold=\"1\"] .arrow {\n    border-top: 4px solid transparent;\n    border-bottom: 4px solid transparent;\n    border-right: 0;\n    border-left: 6px solid #eee;\n    margin-left: 2px;\n}\n.property[data-object=\"0\"] .arrow {\n    display: none;\n}\n.property.fold, .keyframes.fold, .value.fold {\n    display: none;\n}\n.property.select, .value.select, .keyframes.select {\n    background: rgba(120, 120, 120, 0.7);\n}\n.keyframes {\n\n}\n.keyframe_line {\n  position: absolute;\n  height: 8px;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  background: #666;\n  z-index: 0;\n}\n.keyframe {\n  position: absolute;\n  font-size: 0px;\n  width: 12px;\n  height: 12px;\n  top: 0px;\n  bottom: 0px;\n  margin: auto;\n  background: #fff;\n  border: 2px solid #383838;\n  border-radius: 2px;\n  box-sizing: border-box;\n  transform: translate(-50%) rotate(45deg);\n  z-index: 1;\n  cursor: pointer;\n}\n.select .keyframe {\n    border-color: #555;\n}\n.keyframe.select {\n    background: #4af;\n}\n.keyframes_container, .line_area {\n  position: relative;\n  width: calc(100% - 30px);\n  left: 15px;\n  height: 100%;\n}\n.line_area {\n  position: absolute;\n  top: 0;\n  z-index: 0;\n}\n.keyframe_cursor {\n  position: absolute;\n  top: 0;\n  z-index: 1;\n  background: #4af;\n  width: 1px;\n  height: 100%;\n  left: 15px;\n  transform: translate(-50%);\n}\n.division_line {\n  position: absolute;\n  background: #333;\n  width: 1px;\n  height: 100%;\n  transform: translate(-50%);\n}\n`.replace(/\\.([^{,\\s\\d.]+)/g, `.${PREFIX}$1`);\n","import { PREFIX } from \"./consts\";\nimport Scene, { SceneItem, Frame } from \"scenejs\";\nimport {\n    hasClass as hasClass2,\n    addClass as addClass2,\n    removeClass as removeClass2,\n    isString,\n    IObject,\n    isObject,\n    isArray,\n    isUndefined,\n} from \"@daybrush/utils\";\nimport { ElementStructure } from \"./types\";\n\nexport function numberFormat(num: number, count: number, isRight?: boolean) {\n    const length = `${num}`.length;\n    const arr = [];\n\n    if (isRight) {\n        arr.push(num);\n    }\n    for (let i = length; i < count; ++i) {\n        arr.push(0);\n    }\n    if (!isRight) {\n        arr.push(num);\n    }\n    return arr.join(\"\");\n}\nexport function applyStyle(el: HTMLElement, style: IObject<any>) {\n    for (const name in style) {\n        el.style[name] = style[name];\n    }\n}\nexport function findIndexByProperty(selectedProperty: string, structures: ElementStructure[]) {\n    return structures.findIndex(\n        ({dataset: {property}}) => property === selectedProperty,\n    );\n}\n\nexport function createElement(structure: ElementStructure) {\n    const {selector, dataset, attr, style, html} = structure;\n\n    const classNames = selector.match(/\\.([^.#\\s])+/g) || [];\n    const tag = (selector.match(/^[^.#\\s]+/g) || [])[0] || \"div\";\n    const id = (selector.match(/#[^.#\\s]+/g) || [])[0] || \"\";\n    const el = document.createElement(tag);\n\n    id && (el.id = id.replace(/^#/g, \"\"));\n    el.className = classNames.map(name => `${PREFIX}${name.replace(/^\\./g, \"\")}`).join(\" \");\n\n    if (dataset) {\n        for (const name in dataset) {\n            el.setAttribute(`data-${name}`, dataset[name]);\n        }\n    }\n    if (attr) {\n        for (const name in attr) {\n            el.setAttribute(name, attr[name]);\n        }\n    }\n    if (style) {\n        applyStyle(el, style);\n    }\n    if (html) {\n        el.innerHTML = html;\n    }\n    return el;\n}\nexport function updateElement(prevStructure: ElementStructure, nextStructure: ElementStructure) {\n    const {dataset, attr, style, html, element} = nextStructure;\n    if (dataset) {\n        for (const name in dataset) {\n            element.setAttribute(`data-${name}`, dataset[name]);\n        }\n    }\n    if (attr) {\n        for (const name in attr) {\n            element.setAttribute(name, attr[name]);\n        }\n    }\n    style && applyStyle(element, style);\n    if (prevStructure.html !== nextStructure.html) {\n        element.innerHTML = html;\n    }\n}\nexport function keys(value: object) {\n    const arr = [];\n    for (const name in value) {\n        arr.push(name);\n    }\n    return arr;\n}\nexport function toValue(value: any) {\n    const type = typeof value;\n    if (type === \"object\") {\n        if (Array.isArray(value)) {\n            return `[${value.join(\", \")}]`;\n        }\n        return `{${keys(value).map(k => `${k}: ${toValue(value[k])}`).join(\", \")}}`;\n    }\n    return value;\n}\nexport function flatObject(obj: IObject<any>, newObj: IObject<any> = {}) {\n\n    for (const name in obj) {\n        const value = obj[name];\n\n        if (isObject(value)) {\n            const nextObj = flatObject(isFrame(value) ? value.get() : value);\n\n            for (const nextName in nextObj) {\n                newObj[`${name}///${nextName}`] = nextObj[nextName];\n            }\n        } else {\n            newObj[name] = value;\n        }\n    }\n    return newObj;\n}\nexport function getTimelineInfo(scene: Scene) {\n  const timelineInfo = {};\n  scene.forEach((item: SceneItem) => {\n    const delay = item.getDelay();\n    const times = item.times;\n\n    times.forEach(time => {\n      const frame = item.getFrame(time);\n      (function forEach(...objs: any[]) {\n        const length = objs.length;\n        const lastObj = objs[length - 1];\n        const properties = objs.slice(0, -1);\n\n        const name = properties.join(\"///\");\n\n        if (name) {\n            if (!timelineInfo[name]) {\n                timelineInfo[name] = [];\n            }\n            const info = timelineInfo[name];\n\n            info.push([delay + time, lastObj]);\n        }\n\n        if (typeof lastObj === \"object\") {\n            Object.keys(lastObj).forEach(name2 => {\n                forEach(...properties, name2, lastObj[name2]);\n            });\n        }\n      })(item.getId(), frame.get());\n    });\n  });\n  return timelineInfo;\n}\n\nexport function getTarget(target: HTMLElement, conditionCallback: (el: Element) => boolean): HTMLElement {\n    let parentTarget = target;\n\n    while (parentTarget && parentTarget !== document.body) {\n        if (conditionCallback(parentTarget)) {\n            return parentTarget;\n        }\n        parentTarget = parentTarget.parentNode as HTMLElement;\n    }\n    return null;\n}\n\nexport function hasClass(target: Element, className: string) {\n    return hasClass2(target, `${PREFIX}${className}`);\n}\nexport function addClass(target: Element, className: string) {\n    return addClass2(target, `${PREFIX}${className}`);\n}\nexport function removeClass(target: Element, className: string) {\n    return removeClass2(target, `${PREFIX}${className}`);\n}\nexport function findStructure(\n    selector: string,\n    structure: ElementStructure | ElementStructure[],\n    multi: true,\n    arr?: ElementStructure[],\n): ElementStructure[];\nexport function findStructure(\n    selector: string,\n    structure: ElementStructure | ElementStructure[],\n    multi?: false,\n    arr?: ElementStructure[],\n): ElementStructure;\nexport function findStructure(\n    selector: string,\n    structure: ElementStructure | ElementStructure[],\n    multi: true | false,\n    arr?: ElementStructure[],\n): ElementStructure | ElementStructure[];\nexport function findStructure(\n    selector: string,\n    structure: ElementStructure | ElementStructure[],\n    multi: boolean = false,\n    arr: ElementStructure[] = [],\n): ElementStructure | ElementStructure[] {\n    if (isArray(structure)) {\n        const length = structure.length;\n\n        for (let i = 0; i < length; ++i) {\n            findStructure(selector, structure[i], multi, arr);\n        }\n    } else {\n        if (structure.selector === selector) {\n            arr.push(structure);\n        }\n        if (!multi && arr.length) {\n            return arr[0];\n        }\n        if (structure.children) {\n            findStructure(selector, structure.children, multi, arr);\n        }\n    }\n    return multi ? arr : arr[0];\n}\nexport function isScene(value: any): value is Scene {\n    return !!(value.constructor as typeof Scene).prototype.getItem;\n}\nexport function isSceneItem(value: any): value is SceneItem {\n    return !!(value.constructor as typeof SceneItem).prototype.getFrame;\n}\nexport function isFrame(value: any): value is Frame {\n    return !!(value.constructor as typeof Frame).prototype.toCSS;\n}\nexport function splitProperty(scene: Scene, property: string) {\n    const names = property.split(\"///\");\n    const length = names.length;\n    let item: Scene | SceneItem = scene;\n    let i;\n\n    for (i = 0; i < length; ++i) {\n        if (isSceneItem(item)) {\n            break;\n        }\n        item = scene.getItem(names[i]);\n    }\n    return {\n        item: item as SceneItem,\n        names: names.slice(0, i),\n        properties: names.slice(i),\n    };\n}\nexport function getSceneItem(scene: Scene, names: string[]): SceneItem {\n    return names.reduce<any>(\n        (nextScene, name) => nextScene.getItem(name),\n        scene,\n    );\n}\n\nexport function findElementIndexByPosition(elements: HTMLElement[], pos: number): number {\n    const length = elements.length;\n\n    for (let index = 0; index < length; ++index) {\n        const el = elements[index];\n        const box = el.getBoundingClientRect();\n        const top = box.top;\n        const bottom = top + box.height;\n\n        if (top <= pos && pos < bottom) {\n            return index;\n        }\n    }\n    return -1;\n}\n","import { now } from \"@daybrush/utils\";\n\nlet prevTime = 0;\nlet prevX = -1;\nlet prevY = -1;\n\nexport function dblCheck(isDrag, e, clientX, clientY, callback) {\n    const currentTime = now();\n\n    if (!isDrag) {\n        if (\n            prevX === clientX &&\n            prevY === clientY &&\n            currentTime - prevTime <= 500\n        ) {\n            callback(e, clientX, clientY);\n        }\n        prevX = clientX;\n        prevY = clientY;\n        prevTime = currentTime;\n    }\n}\n","export function getKeytimesStructure(maxTime) {\n    const keytimes = [];\n\n    for (let time = 0; time <= maxTime; ++time) {\n        keytimes.push({\n            key: time,\n            dataset: {\n                time,\n            },\n            selector: \".keytime\",\n            style: {\n                width: `${100 / maxTime}%`,\n            },\n            children: [\n                {\n                    selector: \"span\",\n                    html: `${time}`,\n                },\n                {selector: \".graduation.start\"},\n                {selector: \".graduation.quarter\"},\n                {selector: \".graduation.half\"},\n                {selector: \".graduation.quarter3\"},\n            ],\n        });\n    }\n    return keytimes;\n}\nexport function getLinesStructure(maxTime: number) {\n    const lines = [];\n\n    for (let time = 0; time <= maxTime; ++time) {\n        lines.push({\n            key: time,\n            selector: \".division_line\",\n            style: {\n                left: `${100 / maxTime * time}%`,\n            },\n        });\n    }\n    return lines;\n}\n","import { getKeytimesStructure } from \"./KeytimesStructure\";\nimport { Ids, ElementStructure } from \"./types\";\n\nexport function getHeaderAreaStructure(ids: Ids, zoom: number, maxDuration: number, maxTime: number): ElementStructure {\n    return {\n        selector: \".header_area\",\n        ref: e => {\n            ids.keyframesScrollAreas = [];\n            ids.keyframesAreas = [];\n            ids.propertiesAreas = [];\n        },\n        children: [\n            {\n                ref: (e: ElementStructure) => {\n                    ids.propertiesAreas[0] = e;\n                },\n                selector: \".properties_area\",\n                children: [\n                    {\n                        selector: \".property\",\n                        html: \"Name\",\n                    },\n                ],\n            },\n            {\n                selector: \".values_area\",\n                children: {\n                    selector: \".value\",\n                    html: \"+\",\n                },\n            },\n            getKeytimesAreaStructure(ids, zoom, maxDuration, maxTime),\n        ],\n    };\n}\n\nexport function getKeytimesAreaStructure(\n    ids: Ids,\n    zoom: number,\n    maxDuration: number,\n    maxTime: number,\n): ElementStructure {\n    return {\n        ref: e => {\n            ids.keyframesAreas[0] = e;\n        },\n        selector: \".keyframes_area\",\n        children: {\n            style: {\n                minWidth: `${50 * maxTime}px`,\n                width: `${Math.min(maxDuration ? maxTime / maxDuration : 1, 2) * zoom * 100}%`,\n            },\n            dataset: {\n                width: Math.min(maxDuration ? maxTime / maxDuration : 1, 2),\n            },\n            ref: (e: ElementStructure) => {\n                ids.keyframesScrollAreas[0] = e;\n            },\n            selector: \".keyframes_scroll_area\",\n            children: {\n                ref: e => {\n                    ids.cursors = [];\n                },\n                selector: \".keyframes\",\n                children: [\n                    {\n                        ref: e => {\n                            ids.keytimesContainer = e;\n                        },\n                        selector: \".keyframes_container\",\n                        children: getKeytimesStructure(maxTime),\n                    },\n                    {\n                        selector: \".keyframe_cursor\",\n                        ref: e => {\n                            ids.cursors[0] = e;\n                        },\n                    },\n                ],\n            },\n        },\n    };\n}\n","import { toValue, applyStyle } from \"./utils\";\nimport { ElementStructure, Ids } from \"./types\";\nimport { getLinesStructure } from \"./KeytimesStructure\";\n\nexport function updateKeyframesStructure(keyframes: ElementStructure[], maxTime) {\n    keyframes.forEach(keyframe => {\n        const {selector, dataset, style, element} = keyframe;\n        if (selector === \".keyframe\") {\n            style.left = `${dataset.time / maxTime * 100}%`;\n        } else {\n            style.left = `${dataset.from / maxTime * 100}%`,\n            style.width = `${(dataset.to - dataset.from) / maxTime * 100}%`;\n        }\n        applyStyle(element, style);\n    });\n}\n\nexport function getKeyframesAreaStructure(\n    ids: Ids,\n    keyframesList,\n    zoom: number,\n    maxDuration: number,\n    maxTime: number,\n): ElementStructure {\n    const width = Math.min(maxDuration ? maxTime / maxDuration : 1, 2);\n    return {\n        ref: e => {\n            ids.keyframesAreas[1] = e;\n        },\n        selector: \".keyframes_area\",\n        children: {\n            style: {\n                minWidth: `${50 * maxTime}px`,\n                width: `${width * zoom * 100}%`,\n            },\n            dataset: {\n                width,\n            },\n            ref: e => {\n                ids.keyframesScrollAreas[1] = e;\n            },\n            selector: \".keyframes_scroll_area\",\n            children: getKeyframesScrollAreaChildrenStructure(ids, keyframesList, maxTime),\n        },\n    };\n}\nexport function getKeyframesScrollAreaChildrenStructure(ids: Ids, keyframesList, maxTime): ElementStructure[] {\n    return [\n        ...keyframesList,\n        {\n            key: \"cursor\",\n            selector: \".keyframe_cursor\",\n            ref: e => {\n                ids.cursors[1] = e;\n            },\n        },\n        {\n            key: \"lineArea\",\n            ref: e => {\n                ids.lineArea = e;\n            },\n            selector: \".line_area\",\n            children: getLinesStructure(maxTime),\n        },\n    ];\n}\nexport function getKeyframesListStructure(ids: Ids, timelineInfo, maxTime: number): ElementStructure[] {\n    const keyframesList: ElementStructure[] = [];\n\n    for (const property in timelineInfo) {\n        const times = timelineInfo[property];\n        const keyframes = getKeyframesStructure(times, maxTime);\n\n        keyframesList.push({\n            ref: (e, i) => {\n                ids.keyframesList[i] = e;\n                ids.keyframesContainers[i] = e.children as ElementStructure;\n            },\n            selector: \".keyframes\",\n            key: property,\n            dataset: {\n                property,\n            },\n            children: {\n                selector: \".keyframes_container\",\n                children: keyframes,\n            },\n        });\n    }\n    return keyframesList;\n}\nexport function getKeyframesStructure(times: any[][], maxTime): ElementStructure[] {\n    const keyframeLines: ElementStructure[] = [];\n\n    const keyframes: ElementStructure[] = times.map(([time, value], i): ElementStructure => {\n        const valueText = toValue(value);\n\n        if (times[i + 1]) {\n            const [nextTime, nextValue] = times[i + 1];\n            const nextValueText = toValue(nextValue);\n\n            if (valueText !== nextValueText) {\n                keyframeLines.push({\n                    selector: \".keyframe_line\",\n                    key: `${time},${nextTime}`,\n                    dataset: {\n                        time: `${time},${nextTime}`,\n                        from: time,\n                        to: nextTime,\n                    },\n                    style: {\n                        left: `${time / maxTime * 100}%`,\n                        width: `${(nextTime - time) / maxTime * 100}%`,\n                    },\n                });\n            }\n        }\n\n        return {\n            key: time,\n            selector: \".keyframe\",\n            dataset: {\n                time,\n                value: valueText,\n            },\n            style: {\n                left: `${time / maxTime * 100}%`,\n            },\n            html: `${time} ${valueText}`,\n        };\n    });\n\n    return [...keyframes, ...keyframeLines];\n}\n","import { ElementStructure, Ids } from \"./types\";\n\nexport function getPropertiesStructure(ids: Ids, timelineInfo) {\n    const properties: ElementStructure[] = [];\n\n    for (const property in timelineInfo) {\n        const propertyNames = property.split(\"///\");\n        const length = propertyNames.length;\n        const id = propertyNames[length - 1];\n\n        properties.push({\n            ref: (e, i) => {\n                ids.properties[i] = e;\n            },\n            key: property,\n            selector: \".property\",\n            dataset: {\n                id,\n                property,\n                parent: propertyNames[length - 2] || \"\",\n                object: \"0\",\n                item: propertyNames[0],\n            },\n            style: {\n                paddingLeft: `${10 + (length - 1) * 20}px`,\n            },\n            children: [\n                { selector: \".arrow\"},\n                {\n                    selector: \"span\",\n                    html: id,\n                },\n            ],\n        });\n        const parentProperty = propertyNames.slice(0, -1).join(\"///\");\n        properties.forEach(({dataset}) => {\n            if (dataset.property === parentProperty) {\n                dataset.object = \"1\";\n            }\n        });\n    }\n    return properties;\n}\n","import { isObject } from \"@daybrush/utils\";\nimport { Ids, ElementStructure } from \"./types\";\n\nexport function getValuesStructure(ids: Ids, timelineInfo): ElementStructure[] {\n    const values: ElementStructure[] = [];\n\n    for (const property in timelineInfo) {\n        const times = timelineInfo[property];\n        const isHasObject = times[0] && isObject(times[0][1]);\n        values.push({\n            ref: (e, i) => {\n                ids.values[i] = e;\n            },\n            key: property,\n            selector: \".value\",\n            dataset: {\n                property,\n                object: isHasObject ? \"1\" : \"0\",\n            },\n            children: {\n                selector: \"input\",\n                attr: {\n                    value: times[0] ? times[0][1] : \"\",\n                },\n            },\n        });\n    }\n    return values;\n}\n","import { getKeyframesAreaStructure, getKeyframesListStructure } from \"./KeyframesStructure\";\nimport { ElementStructure, Ids } from \"./types\";\nimport { getPropertiesStructure } from \"./PropertiesStructure\";\nimport { getValuesStructure } from \"./ValuesStructure\";\n\nexport function getScrollAreaStructure(\n    ids: Ids,\n    timelineInfo,\n    zoom: number,\n    maxDuration: number,\n    maxTime: number,\n): ElementStructure {\n    const keyframesList: ElementStructure[] = getKeyframesListStructure(ids, timelineInfo, maxTime);\n\n    return {\n        ref: e => {\n            ids.scrollArea = e;\n            ids.keyframesList = [];\n            ids.keyframesContainers = [];\n        },\n        selector: \".scroll_area\",\n        children: [\n            {\n                ref: e => {\n                    ids.propertiesAreas[1] = e;\n                    ids.properties = [];\n                },\n                selector: \".properties_area\",\n                children: [\n                    {\n                        selector: \".properties_scroll_area\",\n                        children: getPropertiesStructure(ids, timelineInfo),\n                    },\n                ],\n            },\n            {\n                ref: e => {\n                    ids.valuesArea = e;\n                    ids.values = [];\n                },\n                selector: \".values_area\",\n                children: getValuesStructure(ids, timelineInfo),\n            },\n            getKeyframesAreaStructure(ids, keyframesList, zoom, maxDuration, maxTime),\n        ],\n    };\n}\n","import { Ids, ElementStructure } from \"./types\";\n\nexport function getControlAreaStructure(ids: Ids): ElementStructure {\n    return {\n        selector: \".header_area.control_area\",\n        children: [\n            {\n                selector: \".properties_area\",\n                children: {\n                    selector: \".property\",\n                },\n            },\n            {\n                selector: \".values_area\",\n                children: {\n                    selector: \".value\",\n                },\n            },\n            {\n                selector: \".keyframes_area\",\n                children: {\n                    selector: \".keyframes\",\n                    children: [\n                        {\n                            selector: \"input.time_area\",\n                            ref: (e: ElementStructure) => {\n                                ids.timeArea = e;\n                            },\n                            html: \"???\",\n                            // html: \"0\",\n                        },\n                        {\n                            selector: \".play_control_area\",\n                            children: [\n                                {\n                                    ref: (e: ElementStructure) => {\n                                        ids.prevBtn = e;\n                                    },\n                                    selector: \".control.prev\",\n                                },\n                                {\n                                    ref: (e: ElementStructure) => {\n                                        ids.playBtn = e;\n                                    },\n                                    selector: \".control.play\",\n                                },\n                                {\n                                    ref: (e: ElementStructure) => {\n                                        ids.nextBtn = e;\n                                    },\n                                    selector: \".control.next\",\n                                },\n                            ],\n                        },\n                    ],\n                },\n            },\n        ],\n    };\n}\n","import Scene, { SceneItem } from \"scenejs\";\nimport {\n    getTimelineInfo, getTarget,\n    hasClass, removeClass, addClass,\n    flatObject, splitProperty, findElementIndexByPosition,\n    createElement, updateElement, findIndexByProperty, findStructure, numberFormat,\n} from \"./utils\";\nimport { drag } from \"@daybrush/drag\";\nimport { CSS } from \"./consts\";\nimport { IObject, addEvent } from \"@daybrush/utils\";\nimport Axes, { PinchInput } from \"@egjs/axes\";\nimport { ElementStructure, Ids } from \"./types\";\nimport { dblCheck } from \"./dblcheck\";\nimport KeyController from \"keycon\";\nimport DataDOM from \"data-dom\";\nimport { getHeaderAreaStructure, getKeytimesAreaStructure } from \"./HeaderAreaStructure\";\nimport { getScrollAreaStructure } from \"./ScrollAreaStructure\";\nimport { getControlAreaStructure } from \"./ControlAreaStructure\";\n\nlet isExportCSS = false;\n\nexport default class Timeline {\n    private scene: Scene;\n    private maxTime: number = 0;\n    private axes: Axes;\n    private selectedProperty: string = \"\";\n    private selectedTime: number = -1;\n    private keycon: KeyController;\n    private datadom: DataDOM<ElementStructure>;\n    private structure: ElementStructure;\n    private ids: Ids = {};\n    constructor(scene: Scene, parentEl: HTMLElement) {\n        scene.finish();\n\n        this.scene = scene;\n        this.initStructure(scene, parentEl);\n        this.initEditor();\n        this.initScroll();\n        this.initWheelZoom();\n        this.initDragKeyframes();\n        this.initClickProperty();\n        this.initController();\n        this.initDragValues();\n        this.initKeyController();\n\n        scene.setTime(0);\n    }\n    public getElement() {\n        return this.structure.element;\n    }\n    // scene control\n    public prev() {\n        this.scene.setTime(this.scene.getTime() - 0.05);\n    }\n    public next() {\n        this.scene.setTime(this.scene.getTime() + 0.05);\n    }\n    public finish() {\n        this.scene.finish();\n    }\n    public togglePlay() {\n        const scene = this.scene;\n        if (scene.getPlayState() === \"running\") {\n            scene.pause();\n        } else {\n            scene.play();\n        }\n    }\n\n    // init\n    private initController() {\n        const ids = this.ids;\n        const playBtn = this.ids.playBtn.element;\n        const scene = this.scene;\n\n        playBtn.addEventListener(\"click\", e => {\n            this.togglePlay();\n            e.preventDefault();\n        });\n        ids.prevBtn.element.addEventListener(\"click\", e => {\n            this.prev();\n            e.preventDefault();\n        });\n        ids.nextBtn.element.addEventListener(\"click\", e => {\n            this.next();\n            e.preventDefault();\n        });\n        scene.on(\"play\", () => {\n            addClass(playBtn, \"pause\");\n            removeClass(playBtn, \"play\");\n            // playBtn.innerHTML = \"pause\";\n        });\n        scene.on(\"paused\", () => {\n            addClass(playBtn, \"play\");\n            removeClass(playBtn, \"pause\");\n            // playBtn.innerHTML = \"play\";\n        });\n        new KeyController(ids.timeArea.element)\n        .keydown(e => {\n            !e.isToggle && e.inputEvent.stopPropagation();\n        })\n        .keyup(e => {\n            !e.isToggle && e.inputEvent.stopPropagation();\n        })\n        .keyup(\"enter\", e => {\n            // go to time\n            const element = ids.timeArea.element;\n            const value = (element as HTMLInputElement).value;\n            const result = /(\\d+):(\\d+):(\\d+)/g.exec(value);\n\n            if (!result) {\n                return;\n            }\n            const minute = parseFloat(result[1]);\n            const second = parseFloat(result[2]);\n            const milisecond = parseFloat(`0.${result[3]}`);\n            const time = minute * 60 + second + milisecond;\n\n            scene.setTime(time);\n        });\n    }\n    private initKeyController() {\n        const ids = this.ids;\n\n        window.addEventListener(\"blur\", () => {\n            removeClass(ids.timeline.element, \"alt\");\n        });\n        this.keycon = new KeyController()\n        .keydown(\"space\", ({inputEvent}) => {\n            inputEvent.preventDefault();\n        })\n        .keydown(\"left\", e => {\n            this.prev();\n        })\n        .keydown(\"right\", e => {\n            this.next();\n        })\n        .keyup(\"backspace\", () => {\n            this.removeKeyframe(this.selectedProperty, this.scene.getTime());\n        })\n        .keydown(\"alt\", () => {\n            addClass(ids.timeline.element, \"alt\");\n        })\n        .keyup(\"alt\", () => {\n            removeClass(ids.timeline.element, \"alt\");\n        })\n        .keyup(\"esc\", () => {\n            this.finish();\n        })\n        .keyup(\"space\", () => {\n            this.togglePlay();\n        });\n    }\n    private initStructure(scene: Scene, parentEl: HTMLElement) {\n        const duration = Math.ceil(scene.getDuration());\n        const timelineInfo = getTimelineInfo(scene);\n        const maxDuration = Math.ceil(duration);\n        const maxTime = maxDuration + 5;\n        const ids = this.ids;\n        let timelineCSS: ElementStructure;\n\n        this.maxTime = maxTime;\n        if (!isExportCSS) {\n            timelineCSS = {\n                selector: \"style.style\",\n                html: CSS,\n            };\n            isExportCSS = true;\n        }\n\n        const structure: ElementStructure = {\n            selector: \".timeline\",\n            ref: e => {\n                ids.timeline = e;\n            },\n            children: [\n                timelineCSS,\n                getControlAreaStructure(ids),\n                getHeaderAreaStructure(ids, 1, maxDuration, maxTime),\n                getScrollAreaStructure(ids, timelineInfo, 1, maxDuration, maxTime),\n            ],\n        };\n        this.datadom = new DataDOM(\n            createElement,\n            updateElement,\n        );\n        this.structure = this.datadom.render(structure, parentEl);\n    }\n    private initScroll() {\n        const {\n            keyframesAreas,\n        } = this.ids;\n        let isScrollKeyframe = false;\n\n        const headerKeyframesArea = keyframesAreas[0].element;\n        const scrollKeyframesArea = keyframesAreas[1].element;\n        headerKeyframesArea.addEventListener(\"scroll\", () => {\n            if (isScrollKeyframe) {\n                isScrollKeyframe = false;\n            } else {\n                isScrollKeyframe = true;\n                scrollKeyframesArea.scrollLeft = headerKeyframesArea.scrollLeft;\n            }\n        });\n        scrollKeyframesArea.addEventListener(\"scroll\", () => {\n            if (isScrollKeyframe) {\n                isScrollKeyframe = false;\n            } else {\n                isScrollKeyframe = true;\n                headerKeyframesArea.scrollLeft = scrollKeyframesArea.scrollLeft;\n            }\n        });\n    }\n    private initWheelZoom() {\n        const ids = this.ids;\n        const keyframesScrollAreas = ids.keyframesScrollAreas;\n        const headerArea = keyframesScrollAreas[0].element;\n        const scrollArea = keyframesScrollAreas[1].element;\n\n        const axes = new Axes(\n            {\n                zoom: {\n                    range: [1, Infinity],\n                },\n            },\n            {},\n            { zoom: 1 },\n        );\n        axes.connect(\"zoom\", new PinchInput(scrollArea, {\n            scale: 0.1,\n            hammerManagerOptions: {\n                touchAction: \"auto\",\n            },\n        }));\n        axes.on(\"hold\", e => {\n            if (e.inputEvent) {\n                e.inputEvent.preventDefault();\n            }\n        });\n        axes.on(\"change\", e => {\n            const scale = ids.keyframesScrollAreas[0].dataset.width;\n            const width = e.pos.zoom * scale * 100;\n\n            ids.keyframesScrollAreas.forEach(({ element }) => {\n                element.style.width = `${width}%`;\n            });\n\n            if (e.inputEvent) {\n                e.inputEvent.preventDefault();\n            }\n        });\n\n        this.axes = axes;\n        headerArea.addEventListener(\"wheel\", e => {\n            const delta = e.deltaY;\n\n            axes.setBy({ zoom: delta / 5000 });\n            !e.deltaX && e.preventDefault();\n        });\n\n        addEvent(scrollArea, \"wheel\", e => {\n            if (!this.keycon.altKey) {\n                return;\n            }\n            e.preventDefault();\n            const delta = e.deltaY;\n\n            axes.setBy({ zoom: delta / 5000 });\n        });\n    }\n    private select(selectedProperty: string, keyframeTime?: number) {\n        const prevSelectedProperty = this.selectedProperty;\n        const prevSelectedTime = this.selectedTime;\n        const ids = this.ids;\n        const values = ids.values;\n        const properties = ids.properties;\n        const keyframesList = ids.keyframesList;\n\n        this.selectedProperty = selectedProperty;\n\n        if (prevSelectedProperty) {\n            const prevSelectedIndex = findIndexByProperty(prevSelectedProperty, properties);\n\n            removeClass(properties[prevSelectedIndex].element, \"select\");\n            removeClass(values[prevSelectedIndex].element, \"select\");\n            removeClass(keyframesList[prevSelectedIndex].element, \"select\");\n\n            if (prevSelectedTime >= 0) {\n                const keyframes = ids.keyframesContainers[prevSelectedIndex].children as ElementStructure[];\n\n                keyframes.forEach(keyframe => {\n                    if (keyframe.dataset.time === prevSelectedTime) {\n                        removeClass(keyframe.element, \"select\");\n                    }\n                });\n                this.selectedTime = -1;\n            }\n        }\n\n        if (selectedProperty) {\n            if (document.activeElement) {\n                (document.activeElement as HTMLElement).blur();\n            }\n            const selectedIndex = findIndexByProperty(selectedProperty, properties);\n            addClass(properties[selectedIndex].element, \"select\");\n            addClass(values[selectedIndex].element, \"select\");\n            addClass(keyframesList[selectedIndex].element, \"select\");\n\n            if (keyframeTime >= 0) {\n                const keyframes = ids.keyframesContainers[selectedIndex].children as ElementStructure[];\n\n                console.log(ids.keyframesContainers, selectedIndex);\n                keyframes.forEach(keyframe => {\n                    console.log(keyframe.dataset.time, keyframeTime);\n                    if (keyframe.dataset.time === keyframeTime) {\n                        addClass(keyframe.element, \"select\");\n                    }\n                });\n                this.selectedTime = keyframeTime;\n            }\n        }\n    }\n    private initClickProperty() {\n        const ids = this.ids;\n        const {\n            propertiesAreas,\n        } = ids;\n\n        propertiesAreas[1].element.addEventListener(\"click\", e => {\n            const properties = ids.properties.map(property => property.element);\n            const length = properties.length;\n            const arrow = getTarget(e.target as HTMLElement, el => hasClass(el, \"arrow\"));\n            const target = getTarget(e.target as HTMLElement, el => hasClass(el, \"property\"));\n\n            if (!target) {\n                return;\n            }\n            const index = properties.indexOf(target);\n\n            if (index === -1) {\n                return;\n            }\n            // select\n            if (!arrow) {\n                this.select(properties[index].dataset.property);\n                return;\n            }\n        });\n    }\n    private setInputs(obj: IObject<any>) {\n        const valuesArea = this.ids.valuesArea.element;\n        for (const name in obj) {\n            valuesArea.querySelector<HTMLInputElement>(`[data-property=\"${name}\"] input`).value = obj[name];\n        }\n    }\n    private moveCursor(time: number) {\n        const {cursors} = this.ids;\n        const maxTime = this.maxTime;\n        const px = 15 - 30 * time / maxTime;\n        const percent = 100 * time / maxTime;\n        const left = `calc(${percent}% + ${px}px)`;\n\n        cursors.forEach(cursor => {\n            cursor.element.style.left = left;\n        });\n    }\n    private initDragKeyframes() {\n        const ids = this.ids;\n        const {\n            scrollArea,\n            timeArea,\n            cursors,\n            keyframesAreas,\n            keyframesScrollAreas,\n        } = ids;\n        const scene = this.scene;\n\n        scene.on(\"animate\", e => {\n            const time = e.time;\n            this.moveCursor(time);\n\n            this.setInputs(flatObject(e.frames));\n            const minute = numberFormat(Math.floor(time / 60), 2);\n            const second = numberFormat(Math.floor(time % 60), 2);\n            const milisecond = numberFormat(Math.floor((time % 1) * 100), 3, true);\n            (timeArea.element as HTMLInputElement).value = `${minute}:${second}:${milisecond}`;\n        });\n        const getTime = (clientX: number) => {\n            const rect = keyframesScrollAreas[1].element.getBoundingClientRect();\n            const scrollAreaWidth = rect.width - 30;\n            const scrollAreaX = rect.left + 15;\n            const x = Math.min(scrollAreaWidth, Math.max(clientX - scrollAreaX, 0));\n            const percentage = x / scrollAreaWidth;\n            let time = this.maxTime * percentage;\n\n            time = Math.round(time * 20) / 20;\n\n            return time;\n        };\n        const move = (clientX: number) => {\n            scene.setTime(getTime(clientX));\n        };\n        const click = (e, clientX, clientY) => {\n            const target = getTarget(e.target as HTMLElement, el => hasClass(el, \"keyframe\"));\n            const time = target ? parseFloat(target.getAttribute(\"data-time\")) : getTime(clientX);\n\n            scene.setTime(time);\n            const list = ids.keyframesList;\n            const index = findElementIndexByPosition(\n                list.map(({element}) => element),\n                clientY,\n            );\n\n            if (index > -1) {\n                this.select(list[index].dataset.property, time);\n            }\n            e.preventDefault();\n        };\n        const dblclick = (e, clientX, clientY) => {\n            const list = ids.keyframesList;\n            const index = findElementIndexByPosition(\n                list.map(({element}) => element),\n                clientY,\n            );\n\n            if (index === -1) {\n                return;\n            }\n            this.addKeyframe(index, getTime(clientX));\n        };\n        drag(cursors[0].element, {\n            dragstart: ({inputEvent}) => {\n                inputEvent.stopPropagation();\n            },\n            drag: ({ clientX }) => {\n                move(clientX);\n            },\n            container: window,\n        });\n        keyframesScrollAreas.forEach(({ element }) => {\n            drag(element, {\n                container: window,\n                drag: ({ deltaX, deltaY, inputEvent }) => {\n                    keyframesAreas[1].element.scrollLeft -= deltaX;\n                    scrollArea.element.scrollTop -= deltaY;\n                    inputEvent.preventDefault();\n                },\n                dragend: ({ isDrag, clientX, clientY, inputEvent }) => {\n                    !isDrag && click(inputEvent, clientX, clientY);\n                    dblCheck(isDrag, inputEvent, clientX, clientY, dblclick);\n                },\n            });\n        });\n    }\n    private initDragValues() {\n        let dragTarget: HTMLInputElement = null;\n        let dragTargetValue: any;\n        drag(this.ids.valuesArea.element, {\n            container: window,\n            dragstart: e => {\n                dragTarget = e.inputEvent.target;\n                dragTargetValue = dragTarget.value;\n\n                console.log(this.keycon.altKey, getTarget(dragTarget, el => el.nodeName === \"INPUT\"));\n                if (!this.keycon.altKey || !getTarget(dragTarget, el => el.nodeName === \"INPUT\")) {\n                    return false;\n                }\n            },\n            drag: e => {\n                const nextValue = dragTargetValue.replace(/-?\\d+/g, num => {\n                    return `${parseFloat(num) + Math.round(e.distX / 2)}`;\n                });\n\n                dragTarget.value = nextValue;\n            },\n            dragend: e => {\n                this.edit(dragTarget, dragTarget.value);\n            },\n        });\n    }\n    private addKeyframe(index: number, time: number) {\n        const list = this.ids.keyframesList;\n        const scene = this.scene;\n        const property = list[index].dataset.property;\n        const {item, properties} = splitProperty(scene, property);\n\n        this.editKeyframe(time, item.getNowValue(time, properties), index);\n        this.select(property, time);\n    }\n    private removeKeyframe(property: string, time: number) {\n        if (!property) {\n            return;\n        }\n        const scene = this.scene;\n        const {item, properties} = splitProperty(scene, property);\n\n        if (properties.length) {\n            item.remove(time, ...properties);\n        } else {\n            item.removeFrame(time);\n        }\n        this.update();\n    }\n\n    private update() {\n        const scene = this.scene;\n        const timelineInfo = getTimelineInfo(scene);\n        const maxDuration = Math.ceil(scene.getDuration());\n        const maxTime = maxDuration + 5;\n        let zoom = this.axes.get([\"zoom\"]).zoom;\n        const currentMaxTime = this.maxTime;\n        this.maxTime = maxTime;\n        const ids = this.ids;\n        const prevKeytimesArea = ids.keyframesAreas[0];\n        const nextZoom = currentMaxTime > 5 ? maxDuration / (currentMaxTime - 5) : 1;\n\n        zoom = zoom * nextZoom;\n        this.axes.axm.set({ zoom });\n        // update keytimes\n        this.datadom.update(\n            prevKeytimesArea,\n            getKeytimesAreaStructure(ids, zoom, maxDuration, maxTime),\n        );\n\n        const nextScrollAreaStructure = getScrollAreaStructure(\n            ids, timelineInfo,\n            this.axes.get([\"zoom\"]).zoom,\n            maxDuration, this.maxTime,\n        );\n\n        this.datadom.update(\n            ids.scrollArea,\n            nextScrollAreaStructure,\n        );\n        scene.setTime(scene.getTime());\n    }\n    private editKeyframe(time: number, value: any, index: number) {\n        const ids = this.ids;\n        const valuesStructure = ids.values;\n        const isObjectData = ids.properties[index].dataset.object === \"1\";\n\n        if (isObjectData) {\n            return;\n        }\n        const property = valuesStructure[index].dataset.property as string;\n        const properties = property.split(\"///\");\n        const scene = this.scene;\n\n        scene.set(time, ...properties, value);\n        scene.setTime(time);\n        this.update();\n    }\n    private restoreKeyframes() {\n        this.scene.setTime(this.scene.getTime());\n    }\n    private edit(target: HTMLInputElement, value: any) {\n        const parentEl = getTarget(target, el => hasClass(el, \"value\"));\n\n        if (!parentEl) {\n            return;\n        }\n        const values = this.ids.values.map(({element}) => element);\n        const index = values.indexOf(parentEl);\n\n        if (index === -1) {\n            return;\n        }\n        this.editKeyframe(this.scene.getTime(), value, index);\n    }\n    private initEditor() {\n        const valuesArea = this.ids.valuesArea.element;\n\n        new KeyController(valuesArea)\n        .keydown(e => {\n            !e.isToggle && e.inputEvent.stopPropagation();\n        })\n        .keyup(e => {\n            !e.isToggle && e.inputEvent.stopPropagation();\n        })\n        .keyup(\"enter\", e => {\n            const target = e.inputEvent.target as HTMLInputElement;\n\n            this.edit(target, target.value);\n        })\n        .keyup(\"esc\", e => {\n            const target = e.inputEvent.target as HTMLInputElement;\n\n            target.blur();\n        });\n        valuesArea.addEventListener(\"focusout\", e => {\n            this.restoreKeyframes();\n        });\n    }\n}\n"],"names":["PREFIX","CSS","replace","numberFormat","num","count","isRight","length","arr","push","i","join","applyStyle","el","style","name","findIndexByProperty","selectedProperty","structures","findIndex","_a","property","createElement","structure","selector","dataset","attr","html","classNames","match","tag","id","document","className","map","setAttribute","innerHTML","updateElement","prevStructure","nextStructure","element","keys","value","toValue","type","Array","isArray","k","flatObject","obj","newObj","isObject","nextObj","isFrame","get","nextName","getTimelineInfo","scene","timelineInfo","forEach","item","delay","getDelay","times","time","frame","getFrame","_i","objs","lastObj","properties","slice","info","Object","name2","getId","getTarget","target","conditionCallback","parentTarget","body","parentNode","hasClass","hasClass2","addClass","addClass2","removeClass","removeClass2","isSceneItem","constructor","prototype","toCSS","splitProperty","names","split","getItem","findElementIndexByPosition","elements","pos","index","box","getBoundingClientRect","top","bottom","height","prevTime","prevX","prevY","dblCheck","isDrag","e","clientX","clientY","callback","currentTime","now","getKeytimesStructure","maxTime","keytimes","key","width","children","getLinesStructure","lines","left","getHeaderAreaStructure","ids","zoom","maxDuration","ref","keyframesScrollAreas","keyframesAreas","propertiesAreas","getKeytimesAreaStructure","minWidth","Math","min","cursors","keytimesContainer","getKeyframesAreaStructure","keyframesList","getKeyframesScrollAreaChildrenStructure","lineArea","getKeyframesListStructure","keyframes","getKeyframesStructure","keyframesContainers","keyframeLines","valueText","_b","nextTime","nextValue","nextValueText","from","to","getPropertiesStructure","propertyNames","parent","object","paddingLeft","parentProperty","getValuesStructure","values","isHasObject","getScrollAreaStructure","scrollArea","valuesArea","getControlAreaStructure","timeArea","prevBtn","playBtn","nextBtn","isExportCSS","parentEl","finish","initStructure","initEditor","initScroll","initWheelZoom","initDragKeyframes","initClickProperty","initController","initDragValues","initKeyController","setTime","getTime","getPlayState","pause","play","addEventListener","_this","togglePlay","preventDefault","prev","next","on","KeyController","keydown","isToggle","inputEvent","stopPropagation","keyup","result","exec","minute","parseFloat","second","milisecond","window","timeline","keycon","removeKeyframe","duration","ceil","getDuration","timelineCSS","datadom","DataDOM","render","isScrollKeyframe","headerKeyframesArea","scrollKeyframesArea","scrollLeft","headerArea","axes","Axes","range","Infinity","connect","PinchInput","scale","hammerManagerOptions","touchAction","delta","deltaY","setBy","deltaX","addEvent","altKey","keyframeTime","prevSelectedProperty","prevSelectedTime","selectedTime","prevSelectedIndex","keyframe","activeElement","blur","selectedIndex","console","log","arrow","indexOf","select","querySelector","px","percent","cursor","moveCursor","setInputs","frames","floor","rect","scrollAreaWidth","scrollAreaX","x","max","percentage","round","move","click","getAttribute","list","dblclick","addKeyframe","drag","dragstart","container","scrollTop","dragend","dragTarget","dragTargetValue","nodeName","distX","edit","editKeyframe","getNowValue","remove","removeFrame","update","currentMaxTime","prevKeytimesArea","nextZoom","axm","set","nextScrollAreaStructure","valuesStructure","isObjectData","restoreKeyframes"],"mappings":"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"}