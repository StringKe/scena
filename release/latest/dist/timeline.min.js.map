{"version":3,"file":"timeline.min.js","sources":["../src/consts.ts","../src/utils.ts","../src/Timeline.ts"],"sourcesContent":["export const PREFIX = `scenejs_timeline_`;\n\nexport const FOLD_CLASS = `${PREFIX}fold`;\nexport const CSS = `\n.timeline {\n  position: relative;\n  font-size: 0;\n  background: #000;\n  display: flex;\n  flex-direction: column;\n}\n.sticky_area, .scroll_area {\n   width: 100%;\n   position: relative;\n  display: flex;\n  -webkit-align-items: flex-start;\n  align-items: flex-start;\n}\n.sticky_area {\n  position: relative;\n  z-index: 10;\n  top: 0;\n  min-height: 30px;\n  height: 30px;\n}\n.sticky_area .keyframes {\n  padding: 0px;\n}\n.sticky_area .properties_area,\n.sticky_area .properties,\n.sticky_area .keyframes_area,\n.sticky_area .keyframes_scroll_area,\n.sticky_area .keyframes {\n  height: 100%;\n}\n.sticky_area .keyframes_area::-webkit-scrollbar {\n    display: none; // Safari and Chrome\n}\n.sticky_area .keyframe_cursor {\n    position: absolute;\n    border-top: 10px solid #f55;\n    border-left: 5px solid transparent;\n    border-right: 5px solid transparent;\n    width: 0;\n    height: 0;\n    bottom: 0;\n    top: auto;\n    background: none;\n    cursor: pointer;\n}\n.keytime {\n  position: relative;\n  display: inline-block;\n  height: 100%;\n  font-size: 13px;\n  font-weight: bold;\n  color: #777;\n}\n.keytime:last-child {\n  max-width: 0px;\n}\n.keytime span {\n  display: inline-block;\n  transform: translate(-50%);\n  color: #eee;\n}\n.keytime .graduation {\n  position: absolute;\n  bottom: 0;\n  width: 1px;\n  height: 10px;\n  background: #999;\n  transform: translate(-50%);\n}\n.keytime .graduation.half {\n  left: 50%;\n  height: 7px;\n}\n.keytime .graduation.quarter {\n  left: 25%;\n  height: 5px;\n}\n.keytime .graduation.quarter3 {\n  left: 75%;\n  height: 5px;\n}\n.scroll_area {\n  position: relative;\n  width: 100%;\n  height: calc(100% - 30px);\n  overflow: auto;\n}\n.properties_area, .keyframes_area {\n  display: inline-block;\n  position: relative;\n  font-size: 16px;\n  overflow: auto;\n}\n\n.properties_area::-webkit-scrollbar, .keyframes_area::-webkit-scrollbar {\n    display: none; // Safari and Chrome\n}\n.properties_area {\n  width: 30%;\n  max-width: 200px;\n  border-right: 1px solid #999;\n  box-sizing: border-box;\n}\n.properties_scroll_area {\n  display: inline-block;\n  min-width: 100%;\n}\n.keyframes_area {\n  flex: 1;\n}\n.keyframes_scroll_area {\n  position: relative;\n  min-width: 300px;\n}\n.keyframes, .properties {\n  position: relative;\n  height: 25px;\n  border-bottom: 1px solid #777;\n  box-sizing: border-box;\n  white-space: nowrap;\n  background: rgba(73, 73, 73, 0.7);\n  z-index: 1;\n}\n.properties:nth-child(2n), .keyframes:nth-child(2n) {\n  background: rgba(90, 90, 90, 0.7);\n}\n.properties {\n  line-height: 25px;\n  padding-left: 10px;\n  box-sizing: border-box;\n  font-size: 13px;\n  font-weight: bold;\n  color: #eee;\n}\n\n.properties .arrow {\n    position: relative;\n    display: inline-block;\n    margin-right: 5px;\n    width: 0;\n    vertical-align: middle;\n}\n.properties .arrow {\n    border-top: 6px solid #eee;\n    border-left: 4px solid transparent;\n    border-right: 4px solid transparent;\n}\n.properties[data-fold=\"1\"] .arrow {\n    border-top: 4px solid transparent;\n    border-bottom: 4px solid transparent;\n    border-right: 0;\n    border-left: 6px solid #eee;\n    margin-left: 2px;\n}\n.properties[data-object=\"0\"] .arrow {\n    display: none;\n}\n.properties.fold, .keyframes.fold {\n    display: none;\n}\n.keyframes {\n\n}\n.keyframe_line {\n  position: absolute;\n  height: 8px;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  background: #aaa;\n  z-index: 0;\n}\n.keyframe {\n  position: absolute;\n  font-size: 0px;\n  width: 12px;\n  height: 12px;\n  top: 0px;\n  bottom: 0px;\n  margin: auto;\n  background: #fff;\n  border: 2px solid #333;\n  border-radius: 2px;\n  box-sizing: border-box;\n  transform: translate(-50%) rotate(45deg);\n  z-index: 1;\n  cursor: pointer;\n}\n.keyframes_container, .line_area {\n  position: relative;\n  width: calc(100% - 30px);\n  left: 15px;\n  height: 100%;\n}\n.line_area {\n  position: absolute;\n  top: 0;\n  z-index: 0;\n}\n.keyframe_cursor {\n  position: absolute;\n  top: 0;\n  z-index: 1;\n  background: #f55;\n  width: 1px;\n  height: 100%;\n  left: 15px;\n  transform: translate(-50%);\n}\n.division_line {\n  position: absolute;\n  background: #333;\n  width: 1px;\n  height: 100%;\n  transform: translate(-50%);\n}\n`.replace(/\\.([^{,\\s\\d.]+)/g, `.${PREFIX}$1`);\n","import { PREFIX } from \"./consts\";\nimport Scene, { SceneItem } from \"scenejs\";\n\nexport function createElement(selector: string, parentEl?: Element) {\n    const classNames = selector.match(/\\.([^.#\\s])+/g) || [];\n    const tag = (selector.match(/^[^.#\\s]+/g) || [])[0] || \"div\";\n    const id = (selector.match(/#[^.#\\s]+/g) || [])[0] || \"\";\n    const el = document.createElement(tag);\n\n    id && (el.id = id.replace(/^#/g, \"\"));\n    el.className = classNames.map(name => `${PREFIX}${name.replace(/^\\./g, \"\")}`).join(\" \");\n\n    parentEl && parentEl.appendChild(el);\n    return el;\n}\nexport function keys(value: object) {\n    const arr = [];\n    for (const name in value) {\n        arr.push(name);\n    }\n    return arr;\n}\nexport function toValue(value: any) {\n    const type = typeof value;\n    if (type === \"object\") {\n        if (Array.isArray(value)) {\n            return `[${value.join(\", \")}]`;\n        }\n        return `{${keys(value).map(k => `${k}: ${toValue(value[k])}`).join(\", \")}}`;\n    }\n    return value;\n}\nexport function getTimelineInfo(scene: Scene) {\n  const timelineInfo = {};\n  scene.forEach((item: SceneItem) => {\n    const delay = item.getDelay();\n    const times = item.times;\n\n    times.forEach(time => {\n      const frame = item.getFrame(time);\n      (function forEach(...objs: any[]) {\n        const length = objs.length;\n        const lastObj = objs[length - 1];\n        const properties = objs.slice(0, -1);\n\n        const name = properties.join(\"///\");\n\n        if (name) {\n            if (!timelineInfo[name]) {\n                timelineInfo[name] = [];\n            }\n            const info = timelineInfo[name];\n\n            info.push([delay + time, lastObj]);\n        }\n\n        if (typeof lastObj === \"object\") {\n            Object.keys(lastObj).forEach(name2 => {\n                forEach(...properties, name2, lastObj[name2]);\n            });\n        }\n      })(item.getId(), frame.get());\n    });\n  });\n  return timelineInfo;\n}\n\nexport function getTarget(target: Element, conditionCallback: (el: Element) => boolean): Element {\n    let parentTarget = target;\n\n    while (parentTarget && parentTarget !== document.body) {\n        if (conditionCallback(parentTarget)) {\n            return parentTarget;\n        }\n        parentTarget = parentTarget.parentNode as Element;\n    }\n    return null;\n}\n","import Scene from \"scenejs\";\nimport { getTimelineInfo, createElement, toValue, getTarget } from \"./utils\";\nimport { drag } from \"@daybrush/drag\";\nimport { CSS, PREFIX, FOLD_CLASS } from \"./consts\";\nimport { hasClass, toArray, isArray, addClass, removeClass } from \"@daybrush/utils\";\nimport Axes, { PinchInput } from \"@egjs/axes\";\n\nlet isExportCSS = false;\n\n/*\n.timeline\n    .stick_area\n        .properties_area\n            .properties\n        .keyframes_area\n            .keyframes_scroll_area\n                .keyframes\n                    .keyframes_container\n                        .keytime * N\n                .keyframe_cursor\n    .scroll_area\n        .properties_area\n            .properties_scroll_area\n                .properties * N\n        .keyframes_area\n            .keyframes_scroll_area\n                .keyframes * N\n                    .keyframes_container\n                        .keyframe * N\n\n*/\nexport default class Timeline {\n    private scene: Scene;\n    private timelineEl: HTMLElement;\n    private cursorHeaderEl: HTMLElement;\n    private cursorEl: HTMLElement;\n    private keyframesScrollAreaEl: HTMLElement;\n    private keyframesHeaderScrollAreaEl: HTMLElement;\n    private keyframesAreaEl: HTMLElement;\n    private keyframesHeaderAreaEl: HTMLElement;\n    private propertiesAreaEl: HTMLElement;\n    private scrollAreaEl: HTMLElement;\n    constructor(scene: Scene, parentEl: HTMLElement) {\n        scene.finish();\n\n        this.scene = scene;\n        this.initElement(scene, parentEl);\n    }\n    public getElement() {\n        return this.timelineEl;\n    }\n    private initElement(scene: Scene, parentEl: HTMLElement) {\n        const duration = scene.getDuration();\n        const timelineInfo = getTimelineInfo(scene);\n        const timelineEl = createElement(\".timeline\");\n        if (!isExportCSS) {\n            const timelineStyleEl = createElement(\"style.timeline_style\", timelineEl);\n\n            timelineStyleEl.innerHTML = CSS;\n            isExportCSS = true;\n        }\n        const stickyAreaEl = createElement(\".sticky_area\", timelineEl);\n        const propertiesHeaderAreaEl = createElement(\".properties_area\", stickyAreaEl);\n        const keyframesHeaderAreaEl = createElement(\".keyframes_area\", stickyAreaEl);\n        const propertyHeaderEl = createElement(\".properties\", propertiesHeaderAreaEl);\n        const keyframesHeaderScrollAreaEl = createElement(\".keyframes_scroll_area\", keyframesHeaderAreaEl);\n        const keyframesHeaderEl = createElement(\".keyframes\", keyframesHeaderScrollAreaEl);\n        const keyframesHeadeerContainerEl = createElement(\".keyframes_container\", keyframesHeaderEl);\n        const cursorHeaderEl = createElement(\".keyframe_cursor\", keyframesHeaderScrollAreaEl);\n        const cursorEl = createElement(\".keyframe_cursor\");\n\n        propertyHeaderEl.innerHTML = \"Item Name\";\n\n        const scrollAreaEl = createElement(\".scroll_area\", timelineEl);\n        const propertiesAreaEl = createElement(\".properties_area\", scrollAreaEl);\n        const propertiesScrollAreaEl = createElement(\".properties_scroll_area\", propertiesAreaEl);\n        const keyframesAreaEl = createElement(\".keyframes_area\", scrollAreaEl);\n        const keyframesScrollAreaEl = createElement(\".keyframes_scroll_area\", keyframesAreaEl);\n        const lineAreaEl = createElement(\".line_area\");\n        const maxDuration = Math.ceil(duration);\n        const maxTime = maxDuration;\n\n        keyframesHeaderScrollAreaEl.style.minWidth = `${50 * maxTime}px`;\n        keyframesScrollAreaEl.style.minWidth = `${50 * maxTime}px`;\n        keyframesHeaderScrollAreaEl.style.width = `${(maxDuration ? maxTime / maxDuration : 1) * 100}%`;\n        keyframesScrollAreaEl.style.width = `${(maxDuration ? maxTime / maxDuration : 1) * 100}%`;\n\n        for (let i = 0; i <= maxTime; ++i) {\n            const time = i;\n            const keytimeEl = createElement(\".keytime\", keyframesHeadeerContainerEl);\n\n            keytimeEl.style.width = `${100 / maxTime}%`;\n            createElement(\"span\", keytimeEl).innerHTML = `${time}s`;\n            createElement(\".graduation.start\", keytimeEl);\n            createElement(\".graduation.quarter\", keytimeEl);\n            createElement(\".graduation.half\", keytimeEl);\n            createElement(\".graduation.quarter3\", keytimeEl);\n            createElement(\".division_line\", lineAreaEl).style.left = `${100 / maxTime * i}%`;\n        }\n        for (const property in timelineInfo) {\n            const properties = property.split(\"///\");\n            const length = properties.length;\n            const times = timelineInfo[property];\n            const propertyEl = createElement(\".properties\", propertiesScrollAreaEl);\n            const keyframesEl = createElement(\".keyframes\", keyframesScrollAreaEl);\n\n            createElement(\".arrow.unfold\", propertyEl);\n            const spanEl = createElement(\"span\", propertyEl);\n            const keyframesContainerEl = createElement(\".keyframes_container\", keyframesEl);\n            const id = properties[length - 1];\n\n            spanEl.innerHTML = id;\n            propertyEl.style.paddingLeft = `${10 + (length - 1) * 20}px`;\n            propertyEl.setAttribute(\"data-id\", id);\n            propertyEl.setAttribute(\"data-parent\", properties[length - 2] || \"\");\n            propertyEl.setAttribute(\"data-property\", property);\n            propertyEl.setAttribute(\"data-object\", \"0\");\n\n            keyframesEl.setAttribute(\"data-property\", property);\n\n            toArray(propertiesScrollAreaEl.querySelectorAll(`[data-property=\"${properties.slice(0, -1).join(\"///\").replace(/\"/g, \"\\\\\\\"\")}\"]`))\n                .forEach(el => {\n                    el.setAttribute(\"data-object\", \"1\");\n                });\n            propertyEl.setAttribute(\"data-item\", properties[0]);\n            times.forEach(([time, value], i) => {\n                const keyframeEl = createElement(\".keyframe\", keyframesContainerEl);\n                const valueText = toValue(value);\n\n                keyframeEl.setAttribute(\"data-time\", time);\n                keyframeEl.setAttribute(\"data-value\", valueText);\n                keyframeEl.style.left = `${time / maxTime * 100}%`;\n                keyframeEl.innerHTML = `${time} ${valueText}`;\n\n                if (times[i + 1]) {\n                    const [nextTime, nextValue] = times[i + 1];\n                    const nextValueText = toValue(nextValue);\n\n                    if (valueText === nextValueText) {\n                        const keyframeLineEl = createElement(\".keyframe_line\", keyframesContainerEl);\n\n                        keyframeLineEl.style.left = `${time / maxTime * 100}%`;\n                        keyframeLineEl.style.width = `${(nextTime - time) / maxTime * 100}%`;\n                    }\n                }\n            });\n        }\n\n        keyframesScrollAreaEl.appendChild(lineAreaEl);\n        keyframesScrollAreaEl.appendChild(cursorEl);\n\n        this.timelineEl = timelineEl;\n        this.cursorEl = cursorEl;\n        this.cursorHeaderEl = cursorHeaderEl;\n        this.keyframesScrollAreaEl = keyframesScrollAreaEl;\n        this.scrollAreaEl = scrollAreaEl;\n        this.propertiesAreaEl = propertiesAreaEl;\n        this.keyframesHeaderScrollAreaEl = keyframesHeaderScrollAreaEl;\n        this.keyframesAreaEl = keyframesAreaEl;\n        this.keyframesHeaderAreaEl = keyframesHeaderAreaEl;\n\n        this.syncScroll();\n        this.wheelZoom();\n        this.drag();\n        this.fold();\n\n        parentEl && parentEl.appendChild(timelineEl);\n    }\n    private syncScroll() {\n        const { keyframesHeaderAreaEl, keyframesAreaEl } = this;\n        let isScrollKeyframe = false;\n\n        keyframesHeaderAreaEl.addEventListener(\"scroll\", () => {\n            if (isScrollKeyframe) {\n                isScrollKeyframe = false;\n            } else {\n                isScrollKeyframe = true;\n                keyframesAreaEl.scrollLeft = keyframesHeaderAreaEl.scrollLeft;\n            }\n        });\n        keyframesAreaEl.addEventListener(\"scroll\", () => {\n            if (isScrollKeyframe) {\n                isScrollKeyframe = false;\n            } else {\n                isScrollKeyframe = true;\n                keyframesHeaderAreaEl.scrollLeft = keyframesAreaEl.scrollLeft;\n            }\n        });\n    }\n    private wheelZoom() {\n        const { keyframesHeaderScrollAreaEl, keyframesScrollAreaEl } = this;\n        const originalWidth = parseFloat(keyframesHeaderScrollAreaEl.style.width);\n        const axes = new Axes({\n            zoom: {\n                range: [100, Infinity],\n            },\n        }, {}, {\n                zoom: originalWidth,\n            });\n        axes.connect(\"zoom\", new PinchInput(keyframesScrollAreaEl, {\n            scale: 0.7,\n            hammerManagerOptions: {\n                touchAction: \"auto\",\n            },\n        }));\n        axes.on(\"hold\", e => {\n            console.log(\"hold\");\n            if (e.inputEvent) {\n                e.inputEvent.preventDefault();\n            }\n        });\n        axes.on(\"change\", e => {\n            const width = e.pos.zoom;\n\n            keyframesHeaderScrollAreaEl.style.width = `${width}%`;\n            keyframesScrollAreaEl.style.width = `${width}%`;\n\n            if (e.inputEvent) {\n                e.inputEvent.preventDefault();\n            }\n        });\n        keyframesHeaderScrollAreaEl.addEventListener(\"wheel\", e => {\n            const delta = e.deltaY;\n\n            axes.setBy({ zoom: delta / originalWidth * 5 });\n        });\n    }\n    private fold() {\n        const { propertiesAreaEl, keyframesScrollAreaEl } = this;\n\n        function getFoldInfos(target, property) {\n            const infos = [];\n            let nextElementSibling = target.nextElementSibling;\n            while (nextElementSibling) {\n                const nextProperty = nextElementSibling.getAttribute(\"data-property\");\n\n                if (nextProperty.indexOf(property) !== 0) {\n                    break;\n                }\n                infos.push(nextElementSibling);\n                if (nextElementSibling.getAttribute(\"data-object\") === \"1\") {\n                    const nextInfos = getFoldInfos(nextElementSibling, nextProperty);\n\n                    infos.push(nextInfos);\n\n                    let nextInfo = nextInfos;\n                    while (isArray(nextInfo)) {\n                        nextInfo = nextInfos[nextInfos.length - 1];\n                    }\n                    nextElementSibling = nextInfo;\n                }\n                nextElementSibling = nextElementSibling.nextElementSibling;\n            }\n            return infos;\n        }\n        propertiesAreaEl.addEventListener(\"click\", e => {\n            const target = getTarget(e.target as Element, el => hasClass(el, `${PREFIX}properties`));\n\n            if (!target || target.getAttribute(\"data-object\") === \"0\") {\n                return;\n            }\n            const isFold = target.getAttribute(\"data-fold\") === \"1\";\n            const property = target.getAttribute(\"data-property\");\n            const infos = getFoldInfos(target, property);\n\n            target.setAttribute(\"data-fold\", isFold ? \"\" : \"1\");\n            infos.forEach(function forEach(info, i, arr) {\n                if (isArray(info)) {\n                    const prevInfo = arr[i - 1];\n                    const isPrevFold = prevInfo.getAttribute(\"data-fold\") === \"1\";\n\n                    if (!isFold || (isFold && !isPrevFold)) {\n                        info.forEach(forEach);\n                    }\n                } else {\n                    const infoProerpty = info.getAttribute(\"data-property\").replace(/\"/g, \"\\\\\\\"\");\n                    const keyframeEl =\n                        keyframesScrollAreaEl.querySelector(`.${PREFIX}keyframes[data-property=\"${infoProerpty}\"]`);\n                    if (isFold) {\n                        removeClass(keyframeEl, FOLD_CLASS);\n                        removeClass(info, FOLD_CLASS);\n                    } else {\n                        addClass(keyframeEl, FOLD_CLASS);\n                        addClass(info, FOLD_CLASS);\n                    }\n                }\n            });\n        });\n    }\n    private drag() {\n        const {\n            cursorEl,\n            cursorHeaderEl,\n            scrollAreaEl,\n            keyframesAreaEl,\n            keyframesScrollAreaEl,\n            keyframesHeaderScrollAreaEl,\n            scene,\n        } = this;\n\n        scene.on(\"animate\", e => {\n            const time = e.time;\n            const maxDuration = Math.ceil(scene.getDuration());\n            const px = 15 - 30 * time / maxDuration;\n            const percent = 100 * time / maxDuration;\n\n            cursorEl.style.left = `calc(${percent}% + ${px}px)`;\n            cursorHeaderEl.style.left = `calc(${percent}% + ${px}px)`;\n        });\n        function move(clientX: number) {\n            const rect = keyframesScrollAreaEl.getBoundingClientRect();\n            const scrollAreaWidth = rect.width - 30;\n            const scrollAreaX = rect.left + 15;\n            const x = Math.min(scrollAreaWidth, Math.max(clientX - scrollAreaX, 0));\n            const percentage = x / scrollAreaWidth;\n\n            scene.setTime(`${percentage * 100}%`);\n        }\n        function click(e, clientX) {\n            const target = getTarget(e.target as Element, el => hasClass(el, `${PREFIX}keyframe`));\n\n            if (target) {\n                scene.setTime(target.getAttribute(\"data-time\"));\n            } else {\n                move(clientX);\n            }\n            e.preventDefault();\n        }\n        drag(cursorHeaderEl, {\n            dragstart: ({inputEvent}) => {\n                inputEvent.stopPropagation();\n            },\n            drag: ({ clientX }) => {\n                move(clientX);\n            },\n            container: window,\n        });\n        [keyframesScrollAreaEl, keyframesHeaderScrollAreaEl].forEach(el => {\n            drag(el, {\n                container: window,\n                drag: ({ deltaX, deltaY, inputEvent }) => {\n                    keyframesAreaEl.scrollLeft -= deltaX;\n                    scrollAreaEl.scrollTop -= deltaY;\n                    inputEvent.preventDefault();\n                },\n                dragend: ({ isDrag, clientX, inputEvent }) => {\n                    !isDrag && click(inputEvent, clientX);\n                },\n            });\n        });\n\n    }\n}\n"],"names":["PREFIX","FOLD_CLASS","CSS","replace","createElement","selector","parentEl","classNames","match","tag","id","el","document","className","map","name","join","appendChild","toValue","value","Array","isArray","arr","push","keys","k","getTarget","target","conditionCallback","parentTarget","body","parentNode","isExportCSS","scene","finish","initElement","this","timelineEl","duration","getDuration","timelineInfo","forEach","item","delay","getDelay","times","time","frame","getFrame","_i","objs","lastObj","length","properties","slice","Object","name2","getId","get","getTimelineInfo","innerHTML","stickyAreaEl","propertiesHeaderAreaEl","keyframesHeaderAreaEl","propertyHeaderEl","keyframesHeaderScrollAreaEl","keyframesHeadeerContainerEl","cursorHeaderEl","cursorEl","scrollAreaEl","propertiesAreaEl","propertiesScrollAreaEl","keyframesAreaEl","keyframesScrollAreaEl","lineAreaEl","maxDuration","Math","ceil","maxTime","style","minWidth","width","i","keytimeEl","left","property","split","propertyEl","keyframesEl","spanEl","keyframesContainerEl","paddingLeft","setAttribute","toArray","querySelectorAll","_a","keyframeEl","valueText","_b","nextTime","keyframeLineEl","syncScroll","wheelZoom","drag","fold","isScrollKeyframe","addEventListener","scrollLeft","originalWidth","parseFloat","axes","Axes","zoom","range","Infinity","connect","PinchInput","scale","hammerManagerOptions","touchAction","on","e","console","log","inputEvent","preventDefault","pos","delta","deltaY","setBy","hasClass","getAttribute","isFold","infos","getFoldInfos","nextElementSibling","nextProperty","indexOf","nextInfos","nextInfo","info","isPrevFold","infoProerpty","querySelector","removeClass","addClass","move","clientX","rect","getBoundingClientRect","scrollAreaWidth","scrollAreaX","percentage","min","max","setTime","px","percent","dragstart","stopPropagation","container","window","deltaX","scrollTop","dragend","isDrag","click"],"mappings":"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"}