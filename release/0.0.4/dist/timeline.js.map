{"version":3,"file":"timeline.js","sources":["../src/consts.ts","../src/utils.ts","../src/Timeline.ts"],"sourcesContent":["export const PREFIX = `scenejs_timeline_`;\nexport const CSS = `\n.timeline {\n  position: relative;\n  font-size: 0;\n  background: #000;\n  display: flex;\n  flex-direction: column;\n}\n.header_area, .scroll_area {\n   width: 100%;\n   position: relative;\n  display: flex;\n  -webkit-align-items: flex-start;\n  align-items: flex-start;\n}\n.header_area {\n  position: relative;\n  z-index: 10;\n  top: 0;\n  height: 30px;\n  min-height: 30px;\n}\n.header_area .keyframes {\n  padding: 0px;\n}\n.header_area .properties_area,\n.header_area .keyframes_area,\n.header_area .values_area,\n.header_area .keyframes_scroll_area {\n    height: 100%;\n}\n.header_area .property, .header_area .value, .header_area .keyframes {\n  height: 100%;\n}\n.header_area .keyframes_area::-webkit-scrollbar {\n    display: none; // Safari and Chrome\n}\n.header_area .keyframe_cursor {\n    position: absolute;\n    border-top: 10px solid #f55;\n    border-left: 5px solid transparent;\n    border-right: 5px solid transparent;\n    width: 0;\n    height: 0;\n    bottom: 0;\n    top: auto;\n    background: none;\n    cursor: pointer;\n}\n.keytime {\n  position: relative;\n  display: inline-block;\n  height: 100%;\n  font-size: 13px;\n  font-weight: bold;\n  color: #777;\n}\n.keytime:last-child {\n  max-width: 0px;\n}\n.keytime span {\n  display: inline-block;\n  transform: translate(-50%);\n  color: #eee;\n}\n.keytime .graduation {\n  position: absolute;\n  bottom: 0;\n  width: 1px;\n  height: 10px;\n  background: #777;\n  transform: translate(-50%);\n}\n.keytime .graduation.half {\n  left: 50%;\n  height: 7px;\n}\n.keytime .graduation.quarter {\n  left: 25%;\n  height: 5px;\n}\n.keytime .graduation.quarter3 {\n  left: 75%;\n  height: 5px;\n}\n.scroll_area {\n  position: relative;\n  width: 100%;\n  height: calc(100% - 30px);\n  overflow: auto;\n}\n.properties_area, .keyframes_area, .values_area {\n  display: inline-block;\n  position: relative;\n  font-size: 16px;\n  overflow: auto;\n}\n\n.properties_area::-webkit-scrollbar, .keyframes_area::-webkit-scrollbar {\n    display: none; // Safari and Chrome\n}\n.properties_area {\n  width: 30%;\n  max-width: 200px;\n  box-sizing: border-box;\n}\n.values_area {\n    width: 50px;\n    min-width: 50px;\n    display: inline-block;\n    border-right: 1px solid #999;\n    box-sizing: border-box;\n}\n.value input {\n    appearance: none;\n    -webkit-appearance: none;\n    outline: none;\n    position: relative;\n    display: block;\n    width: 100%;\n    height: 100%;\n    background: none;\n    color: #ff5;\n    font-weight: bold;\n    background: none;\n    border: 0;\n    box-sizing: border-box;\n    text-align: center;\n}\n.value[data-object=\"1\"] input {\n    display: none;\n}\n.properties_scroll_area {\n  display: inline-block;\n  min-width: 100%;\n}\n.keyframes_area {\n  flex: 1;\n}\n.keyframes_scroll_area {\n  position: relative;\n  min-width: 300px;\n}\n.keyframes, .property, .value {\n  position: relative;\n  height: 25px;\n  border-bottom: 1px solid #777;\n  box-sizing: border-box;\n  white-space: nowrap;\n  background: rgba(73, 73, 73, 0.7);\n  z-index: 1;\n}\n.property:nth-child(2n), .keyframes:nth-child(2n), .value:nth-child(2n) {\n  background: rgba(90, 90, 90, 0.7);\n}\n.property {\n  line-height: 25px;\n  padding-left: 10px;\n  box-sizing: border-box;\n  font-size: 13px;\n  font-weight: bold;\n  color: #eee;\n}\n.property.time_area {\n    color: #ff5;\n    line-height: 30px;\n}\n.property .arrow {\n    position: relative;\n    display: inline-block;\n    margin-right: 5px;\n    width: 0;\n    vertical-align: middle;\n}\n.property .arrow {\n    border-top: 6px solid #eee;\n    border-left: 4px solid transparent;\n    border-right: 4px solid transparent;\n}\n.property[data-fold=\"1\"] .arrow {\n    border-top: 4px solid transparent;\n    border-bottom: 4px solid transparent;\n    border-right: 0;\n    border-left: 6px solid #eee;\n    margin-left: 2px;\n}\n.property[data-object=\"0\"] .arrow {\n    display: none;\n}\n.property.fold, .keyframes.fold, .value.fold {\n    display: none;\n}\n.keyframes {\n\n}\n.keyframe_line {\n  position: absolute;\n  height: 8px;\n  top: 0;\n  bottom: 0;\n  margin: auto;\n  background: #aaa;\n  z-index: 0;\n}\n.keyframe {\n  position: absolute;\n  font-size: 0px;\n  width: 12px;\n  height: 12px;\n  top: 0px;\n  bottom: 0px;\n  margin: auto;\n  background: #fff;\n  border: 2px solid #333;\n  border-radius: 2px;\n  box-sizing: border-box;\n  transform: translate(-50%) rotate(45deg);\n  z-index: 1;\n  cursor: pointer;\n}\n.keyframes_container, .line_area {\n  position: relative;\n  width: calc(100% - 30px);\n  left: 15px;\n  height: 100%;\n}\n.line_area {\n  position: absolute;\n  top: 0;\n  z-index: 0;\n}\n.keyframe_cursor {\n  position: absolute;\n  top: 0;\n  z-index: 1;\n  background: #f55;\n  width: 1px;\n  height: 100%;\n  left: 15px;\n  transform: translate(-50%);\n}\n.division_line {\n  position: absolute;\n  background: #333;\n  width: 1px;\n  height: 100%;\n  transform: translate(-50%);\n}\n`.replace(/\\.([^{,\\s\\d.]+)/g, `.${PREFIX}$1`);\n","import { PREFIX } from \"./consts\";\nimport Scene, { SceneItem, Frame } from \"scenejs\";\nimport {\n    hasClass as hasClass2,\n    addClass as addClass2,\n    removeClass as removeClass2,\n    isString,\n    IObject,\n    isObject,\n} from \"@daybrush/utils\";\nimport { ElementStructure } from \"./types\";\n\nexport function createElement(selector: string, parentEl?: Element) {\n    const classNames = selector.match(/\\.([^.#\\s])+/g) || [];\n    const tag = (selector.match(/^[^.#\\s]+/g) || [])[0] || \"div\";\n    const id = (selector.match(/#[^.#\\s]+/g) || [])[0] || \"\";\n    const el = document.createElement(tag);\n\n    id && (el.id = id.replace(/^#/g, \"\"));\n    el.className = classNames.map(name => `${PREFIX}${name.replace(/^\\./g, \"\")}`).join(\" \");\n\n    parentEl && parentEl.appendChild(el);\n    return el;\n}\nexport function keys(value: object) {\n    const arr = [];\n    for (const name in value) {\n        arr.push(name);\n    }\n    return arr;\n}\nexport function toValue(value: any) {\n    const type = typeof value;\n    if (type === \"object\") {\n        if (Array.isArray(value)) {\n            return `[${value.join(\", \")}]`;\n        }\n        return `{${keys(value).map(k => `${k}: ${toValue(value[k])}`).join(\", \")}}`;\n    }\n    return value;\n}\nexport function flatObject(obj: IObject<any>, newObj: IObject<any> = {}) {\n\n    for (const name in obj) {\n        const value = obj[name];\n\n        if (isObject(value)) {\n            const nextObj = flatObject(value.constructor.name === \"Frame\" ? (value as Frame).get() : value);\n\n            for (const nextName in nextObj) {\n                newObj[`${name}///${nextName}`] = nextObj[nextName];\n            }\n        } else {\n            newObj[name] = value;\n        }\n    }\n    return newObj;\n}\nexport function getTimelineInfo(scene: Scene) {\n  const timelineInfo = {};\n  scene.forEach((item: SceneItem) => {\n    const delay = item.getDelay();\n    const times = item.times;\n\n    times.forEach(time => {\n      const frame = item.getFrame(time);\n      (function forEach(...objs: any[]) {\n        const length = objs.length;\n        const lastObj = objs[length - 1];\n        const properties = objs.slice(0, -1);\n\n        const name = properties.join(\"///\");\n\n        if (name) {\n            if (!timelineInfo[name]) {\n                timelineInfo[name] = [];\n            }\n            const info = timelineInfo[name];\n\n            info.push([delay + time, lastObj]);\n        }\n\n        if (typeof lastObj === \"object\") {\n            Object.keys(lastObj).forEach(name2 => {\n                forEach(...properties, name2, lastObj[name2]);\n            });\n        }\n      })(item.getId(), frame.get());\n    });\n  });\n  return timelineInfo;\n}\n\nexport function getTarget(target: HTMLElement, conditionCallback: (el: Element) => boolean): HTMLElement {\n    let parentTarget = target;\n\n    while (parentTarget && parentTarget !== document.body) {\n        if (conditionCallback(parentTarget)) {\n            return parentTarget;\n        }\n        parentTarget = parentTarget.parentNode as HTMLElement;\n    }\n    return null;\n}\n\nexport function hasClass(target: Element, className: string) {\n    return hasClass2(target, `${PREFIX}${className}`);\n}\nexport function addClass(target: Element, className: string) {\n    return addClass2(target, `${PREFIX}${className}`);\n}\nexport function removeClass(target: Element, className: string) {\n    return removeClass2(target, `${PREFIX}${className}`);\n}\n\nexport function makeStructure<T>(\n    structure: ElementStructure,\n    parentEl?: Element,\n    obj: IObject<HTMLElement | HTMLElement[]> = {},\n): T {\n    const {selector, id, attr, dataset, children, style, html} = structure;\n    const el = createElement(selector);\n\n    if (id) {\n        if (id.indexOf(\"[]\") > -1) {\n            const objId = id.replace(\"[]\", \"\");\n\n            if (!obj[objId]) {\n                obj[objId] = [];\n            }\n            (obj[objId] as HTMLElement[]).push(el);\n        } else {\n            obj[id] = el;\n        }\n    }\n    if (dataset) {\n        for (const name in dataset) {\n            el.setAttribute(`data-${name}`, dataset[name]);\n        }\n    }\n    if (attr) {\n        for (const name in attr) {\n            el.setAttribute(name, attr[name]);\n        }\n    }\n    if (style) {\n        for (const name in style) {\n            el.style[name] = style[name];\n        }\n    }\n    if (html) {\n        el.innerHTML = html;\n    }\n    if (children) {\n        ([] as Array<string | ElementStructure>).concat(children).filter(child => child).forEach(child => {\n            if (isString(child)) {\n                makeStructure({ selector: child }, el, obj);\n            } else {\n                makeStructure(child, el, obj);\n            }\n        });\n    }\n    parentEl && parentEl.appendChild(el);\n\n    return (obj as any);\n}\n","import Scene from \"scenejs\";\nimport { getTimelineInfo, toValue, getTarget , hasClass, removeClass, addClass, makeStructure, flatObject} from \"./utils\";\nimport { drag } from \"@daybrush/drag\";\nimport { CSS, PREFIX } from \"./consts\";\nimport { isObject, isArray, IObject } from \"@daybrush/utils\";\nimport Axes, { PinchInput } from \"@egjs/axes\";\nimport { ElementStructure, Ids } from \"./types\";\n\nlet isExportCSS = false;\n\nexport default class Timeline {\n    private scene: Scene;\n    private ids: Ids;\n    constructor(scene: Scene, parentEl: HTMLElement) {\n        scene.finish();\n\n        this.scene = scene;\n        this.initElement(scene, parentEl);\n    }\n    public getElement() {\n        return this.ids.timeline;\n    }\n    private initElement(scene: Scene, parentEl: HTMLElement) {\n        const duration = scene.getDuration();\n        const timelineInfo = getTimelineInfo(scene);\n        const maxDuration = Math.ceil(duration);\n        const maxTime = maxDuration;\n        const keytimes: ElementStructure[] = [];\n        const properties: ElementStructure[] = [];\n        const values: ElementStructure[] = [];\n        const lines: ElementStructure[] = [];\n        const keyframesList: ElementStructure[] = [];\n        let timelineCSS: ElementStructure;\n        if (!isExportCSS) {\n            timelineCSS = {\n                selector: \"style.style\",\n                html: CSS,\n            };\n            isExportCSS = true;\n        }\n        for (let i = 0; i <= maxTime; ++i) {\n            const time = i;\n            keytimes.push({\n                selector: \".keytime\",\n                style: {\n                    width: `${100 / maxTime}%`,\n                },\n                children: [\n                    {\n                        selector: \"span\",\n                        html: `${time}s`,\n                    },\n                    \".graduation.start\",\n                    \".graduation.quarter\",\n                    \".graduation.half\",\n                    \".graduation.quarter3\",\n                ],\n            });\n\n            lines.push({\n                selector: \".division_line\",\n                style: {\n                    left: `${100 / maxTime * i}%`,\n                },\n            });\n        }\n        for (const property in timelineInfo) {\n            const propertyNames = property.split(\"///\");\n            const length = propertyNames.length;\n            const times = timelineInfo[property];\n            const id = propertyNames[length - 1];\n\n            properties.push({\n                id: \"properties[]\",\n                selector: \".property\",\n                dataset: {\n                    id,\n                    property,\n                    parent: propertyNames[length - 2] || \"\",\n                    object: \"0\",\n                    item: propertyNames[0],\n                },\n                style: {\n                    paddingLeft: `${10 + (length - 1) * 20}px`,\n                },\n                children: [\n                    \".arrow\",\n                    {\n                        selector: \"span\",\n                        html: id,\n                    },\n                ],\n            });\n            const isHasObject = times[0] && isObject(times[0][1]);\n            values.push({\n                id: \"values[]\",\n                selector: \".value\",\n                dataset: {\n                    property,\n                    object: isHasObject ? \"1\" : \"0\",\n                },\n                children: {\n                    id: \"inputs[]\",\n                    selector: \"input\",\n                    attr: {\n                        value: times[0] ? times[0][1] : \"\",\n                    },\n                },\n            });\n            const parentProperty = propertyNames.slice(0, -1).join(\"///\");\n            properties.forEach(({dataset}) => {\n                if (dataset.property === parentProperty) {\n                    dataset.object = \"1\";\n                }\n            });\n            const keyframeLines: ElementStructure[] = [];\n            const keyframes = times.map(([time, value], i) => {\n                const valueText = toValue(value);\n\n                if (times[i + 1]) {\n                    const [nextTime, nextValue] = times[i + 1];\n                    const nextValueText = toValue(nextValue);\n\n                    if (valueText === nextValueText) {\n                        keyframeLines.push({\n                            selector: \".keyframe_line\",\n                            style: {\n                                left: `${time / maxTime * 100}%`,\n                                width: `${(nextTime - time) / maxTime * 100}%`,\n                            },\n                        });\n                    }\n                }\n\n                return {\n                    selector: \".keyframe\",\n                    dataset: {\n                        time,\n                        value: valueText,\n                    },\n                    style: {\n                        left: `${time / maxTime * 100}%`,\n                    },\n                    html: `${time} ${valueText}`,\n                };\n            });\n            keyframesList.push({\n                id: \"keyframesList[]\",\n                selector: \".keyframes\",\n                dataset: {\n                    property,\n                },\n                children: {\n                    selector: \".keyframes_container\",\n                    children: [\n                        ...keyframes,\n                        ...keyframeLines,\n                    ],\n                },\n            });\n        }\n        const structure: ElementStructure = {\n            selector: \".timeline\",\n            id: \"timeline\",\n            children: [\n                timelineCSS,\n                {\n                    selector: \".header_area\",\n                    children: [\n                        {\n                            id: \"propertiesAreas[]\",\n                            selector: \".properties_area\",\n                            children: [\n                                {\n                                    id: \"timeArea\",\n                                    selector: \".property.time_area\",\n                                    html: \"0s\",\n                                },\n                            ],\n                        },\n                        {\n                            selector: \".values_area\",\n                            children: \".value\",\n                        },\n                        {\n                            id: \"keyframesAreas[]\",\n                            selector: \".keyframes_area\",\n                            children: {\n                                style: {\n                                    minWidth: `${50 * maxTime}px`,\n                                    width: `${(maxDuration ? maxTime / maxDuration : 1) * 100}%`,\n                                },\n                                id: \"keyframesScrollAreas[]\",\n                                selector: \".keyframes_scroll_area\",\n                                children: {\n                                    selector: \".keyframes\",\n                                    children: [\n                                        {\n                                            selector: \".keyframes_container\",\n                                            children: keytimes,\n                                        },\n                                        {\n                                            selector: \".keyframe_cursor\",\n                                            id: \"cursors[]\",\n                                        },\n                                    ],\n                                },\n                            },\n                        },\n                    ],\n                },\n                {\n                    id: \"scrollArea\",\n                    selector: \".scroll_area\",\n                    children: [\n                        {\n                            id: \"propertiesAreas[]\",\n                            selector: \".properties_area\",\n                            children: [\n                                {\n                                    selector: \".properties_scroll_area\",\n                                    children: properties,\n                                },\n                            ],\n                        },\n                        {\n                            id: \"valuesArea\",\n                            selector: \".values_area\",\n                            children: values,\n                        },\n                        {\n                            id: \"keyframesAreas[]\",\n                            selector: \".keyframes_area\",\n                            children: {\n                                style: {\n                                    minWidth: `${50 * maxTime}px`,\n                                    width: `${(maxDuration ? maxTime / maxDuration : 1) * 100}%`,\n                                },\n                                id: \"keyframesScrollAreas[]\",\n                                selector: \".keyframes_scroll_area\",\n                                children: [\n                                    ...keyframesList,\n                                    {\n                                        selector: \".keyframe_cursor\",\n                                        id: \"cursors[]\",\n                                    },\n                                    {\n                                        selector: \".line_area\",\n                                        children: lines,\n                                    },\n                                ],\n                            },\n                        },\n                    ],\n                },\n            ],\n        };\n\n        this.ids = makeStructure(structure, parentEl);\n        this.syncScroll();\n        this.wheelZoom();\n        this.drag();\n        this.fold();\n    }\n    private syncScroll() {\n        const {\n            keyframesAreas,\n        } = this.ids;\n        let isScrollKeyframe = false;\n\n        keyframesAreas[0].addEventListener(\"scroll\", () => {\n            if (isScrollKeyframe) {\n                isScrollKeyframe = false;\n            } else {\n                isScrollKeyframe = true;\n                keyframesAreas[1].scrollLeft = keyframesAreas[0].scrollLeft;\n            }\n        });\n        keyframesAreas[1].addEventListener(\"scroll\", () => {\n            if (isScrollKeyframe) {\n                isScrollKeyframe = false;\n            } else {\n                isScrollKeyframe = true;\n                keyframesAreas[0].scrollLeft = keyframesAreas[1].scrollLeft;\n            }\n        });\n    }\n    private wheelZoom() {\n        const { keyframesScrollAreas } = this.ids;\n        const originalWidth = parseFloat(keyframesScrollAreas[0].style.width);\n\n        const axes = new Axes({\n            zoom: {\n                range: [100, Infinity],\n            },\n        }, {}, {\n                zoom: originalWidth,\n            });\n        axes.connect(\"zoom\", new PinchInput(keyframesScrollAreas[1], {\n            scale: 0.7,\n            hammerManagerOptions: {\n                touchAction: \"auto\",\n            },\n        }));\n        axes.on(\"hold\", e => {\n            console.log(\"hold\");\n            if (e.inputEvent) {\n                e.inputEvent.preventDefault();\n            }\n        });\n        axes.on(\"change\", e => {\n            const width = e.pos.zoom;\n\n            keyframesScrollAreas.forEach(el => {\n                el.style.width = `${width}%`;\n            });\n\n            if (e.inputEvent) {\n                e.inputEvent.preventDefault();\n            }\n        });\n        keyframesScrollAreas[0].addEventListener(\"wheel\", e => {\n            const delta = e.deltaY;\n\n            axes.setBy({ zoom: delta / originalWidth * 5 });\n            !e.deltaX && e.preventDefault();\n        });\n    }\n    private fold() {\n        const {\n            keyframesList,\n            properties,\n            values,\n            propertiesAreas,\n        } = this.ids;\n\n        propertiesAreas[1].addEventListener(\"click\", e => {\n            const target = getTarget(e.target as HTMLElement, el => hasClass(el, \"property\"));\n\n            if (!target || target.getAttribute(\"data-object\") === \"0\") {\n                return;\n            }\n\n\n            const length = properties.length;\n            let index = properties.indexOf(target);\n\n            if (index === -1) {\n                return;\n            }\n\n            const isFold = target.getAttribute(\"data-fold\") === \"1\";\n\n            function fold(isPrevFold) {\n                const nextTarget = properties[index];\n                const nextProperty = nextTarget.getAttribute(\"data-property\");\n                const isNextFold = nextTarget.getAttribute(\"data-fold\") === \"1\";\n                const isNextObject = nextTarget.getAttribute(\"data-object\") === \"1\";\n\n                if (target !== nextTarget) {\n                    if (isFold) {\n                        if (!isPrevFold)  {\n                            removeClass(keyframesList[index], \"fold\");\n                            removeClass(values[index], \"fold\");\n                            removeClass(nextTarget, \"fold\");\n                        }\n                    } else {\n                        addClass(keyframesList[index], \"fold\");\n                        addClass(values[index], \"fold\");\n                        addClass(nextTarget, \"fold\");\n                    }\n                }\n                if (!isNextObject) {\n                    return;\n                }\n\n                for (++index; index < length; ++index) {\n                    const el = properties[index];\n\n                    if (\n                        // itemProperties\n                        el.getAttribute(\"data-property\").indexOf(nextProperty) > -1\n                    ) {\n                        // isChild\n                        fold(!isPrevFold && isNextFold);\n                    } else {\n                        --index;\n                        // not child\n                        break;\n                    }\n                }\n            }\n\n            fold(isFold);\n            target.setAttribute(\"data-fold\", isFold ? \"0\" : \"1\");\n        });\n    }\n    private setInputs(obj: IObject<any>) {\n        const valuesArea = this.ids.valuesArea;\n        for (const name in obj) {\n            valuesArea.querySelector<HTMLInputElement>(`[data-property=\"${name}\"] input`).value = obj[name];\n        }\n    }\n    private drag() {\n        const {\n            scrollArea,\n            timeArea,\n            cursors,\n            keyframesAreas,\n            keyframesScrollAreas,\n        } = this.ids;\n        const scene = this.scene;\n\n        scene.on(\"animate\", e => {\n            const time = e.time;\n            const maxDuration = Math.ceil(scene.getDuration());\n            const px = 15 - 30 * time / maxDuration;\n            const percent = 100 * time / maxDuration;\n            const left = `calc(${percent}% + ${px}px)`;\n\n            this.setInputs(flatObject(e.frames));\n            timeArea.innerHTML = `${time}s`;\n            cursors.forEach(cursor => {\n                cursor.style.left = left;\n            });\n        });\n        function move(clientX: number) {\n            const rect = keyframesScrollAreas[1].getBoundingClientRect();\n            const scrollAreaWidth = rect.width - 30;\n            const scrollAreaX = rect.left + 15;\n            const x = Math.min(scrollAreaWidth, Math.max(clientX - scrollAreaX, 0));\n            const percentage = x / scrollAreaWidth;\n            let time = scene.getDuration() * percentage;\n\n            time = Math.ceil(time * 20) / 20;\n            scene.setTime(time);\n        }\n        function click(e, clientX) {\n            const target = getTarget(e.target as HTMLElement, el => hasClass(el, \"keyframe\"));\n\n            if (target) {\n                scene.setTime(target.getAttribute(\"data-time\"));\n            } else if (!hasClass(e.target as Element, \"keyframe_cursor\")) {\n                move(clientX);\n            }\n            e.preventDefault();\n        }\n        drag(cursors[0], {\n            dragstart: ({inputEvent}) => {\n                inputEvent.stopPropagation();\n            },\n            drag: ({ clientX }) => {\n                move(clientX);\n            },\n            container: window,\n        });\n        keyframesScrollAreas.forEach(el => {\n            drag(el, {\n                container: window,\n                drag: ({ deltaX, deltaY, inputEvent }) => {\n                    keyframesAreas[1].scrollLeft -= deltaX;\n                    scrollArea.scrollTop -= deltaY;\n                    inputEvent.preventDefault();\n                },\n                dragend: ({ isDrag, clientX, inputEvent }) => {\n                    !isDrag && click(inputEvent, clientX);\n                },\n            });\n        });\n\n    }\n}\n"],"names":["PREFIX","CSS","replace","createElement","selector","parentEl","classNames","match","tag","id","el","document","className","map","name","join","appendChild","keys","value","arr","push","toValue","type","Array","isArray","k","flatObject","obj","newObj","isObject","nextObj","constructor","get","nextName","getTimelineInfo","scene","timelineInfo","forEach","item","delay","getDelay","times","time","frame","getFrame","_i","objs","length","lastObj","properties","slice","info","Object","name2","getId","getTarget","target","conditionCallback","parentTarget","body","parentNode","hasClass","hasClass2","addClass","addClass2","removeClass","removeClass2","makeStructure","structure","attr","dataset","children","style","html","indexOf","objId","setAttribute","innerHTML","concat","filter","child","isString","isExportCSS","finish","initElement","ids","timeline","duration","getDuration","maxDuration","Math","ceil","maxTime","keytimes","values","lines","keyframesList","timelineCSS","i","width","left","property","propertyNames","split","parent","object","paddingLeft","isHasObject","parentProperty","_a","keyframeLines","keyframes","valueText","_b","nextTime","nextValue","nextValueText","minWidth","syncScroll","wheelZoom","drag","fold","keyframesAreas","isScrollKeyframe","addEventListener","scrollLeft","keyframesScrollAreas","originalWidth","parseFloat","axes","Axes","zoom","range","Infinity","connect","PinchInput","scale","hammerManagerOptions","touchAction","on","e","console","log","inputEvent","preventDefault","pos","delta","deltaY","setBy","deltaX","propertiesAreas","getAttribute","index","isFold","isPrevFold","nextTarget","nextProperty","isNextFold","isNextObject","valuesArea","querySelector","scrollArea","timeArea","cursors","px","percent","_this","setInputs","frames","cursor","move","clientX","rect","getBoundingClientRect","scrollAreaWidth","scrollAreaX","x","min","max","percentage","setTime","click","dragstart","stopPropagation","container","window","scrollTop","dragend","isDrag"],"mappings":"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"}